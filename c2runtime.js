// Generated by Construct 3, the game and app creator :: https://www.construct.net
'use strict';var cr$$module$str$c3runtime=window.cr={};cr$$module$str$c3runtime.plugins_={};cr$$module$str$c3runtime.behaviors={};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(b){return b.__proto__}:function(b){return b.constructor.prototype});
(function(){function b(e,u){this.x=e;this.y=u;cr$$module$str$c3runtime.seal(this)}function l(e,u,G,I){this.set(e,u,G,I);cr$$module$str$c3runtime.seal(this)}function v(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr$$module$str$c3runtime.seal(this)}function A(e,u,G,I){e<u?G<I?(H=e<G?e:G,B=u>I?u:I):(H=e<I?e:I,B=u>G?u:G):G<I?(H=u<G?u:G,B=e>I?e:I):(H=u<I?u:I,B=e>G?e:G)}function L(){this.items=this.s=null;this.item_count=0;x&&(this.s=new Set);this.values_cache=[];this.cache_valid=
!0;cr$$module$str$c3runtime.seal(this)}function K(e){N[Q++]=e}function n(){this.sum=this.t=this.y=this.c=0;cr$$module$str$c3runtime.seal(this)}function a(e,u){e||(e=[0,0,1,0,1,1,0,1]);this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.enabled="undefined"===typeof u?!0:u;this.set_pts(e);cr$$module$str$c3runtime.seal(this)}function c(e,u){this.cellwidth=e;this.cellheight=u;this.cells={}}function h(e,u){this.cellwidth=e;this.cellheight=u;this.cells=
{}}function p(e,u,G){c.prototype.totalCellCount++;if(d.length){var I=d.pop();I.grid=e;I.x=u;I.y=G;return I}return new cr$$module$str$c3runtime.GridCell(e,u,G)}function m(e,u,G){this.grid=e;this.x=u;this.y=G;this.objects=new cr$$module$str$c3runtime.ObjectSet}function t(e,u,G){h.prototype.totalCellCount++;if(k.length){var I=k.pop();I.grid=e;I.x=u;I.y=G;return I}return new cr$$module$str$c3runtime.RenderCell(e,u,G)}function E(e,u,G){this.grid=e;this.x=u;this.y=G;this.objects=[];this.is_sorted=!0;this.pending_removal=
new cr$$module$str$c3runtime.ObjectSet;this.any_pending_removal=!1}function z(e,u){return e.zindex-u.zindex}cr$$module$str$c3runtime.logexport=function(e){window.console&&window.console.log&&window.console.log(e)};cr$$module$str$c3runtime.logerror=function(e){window.console&&window.console.error&&window.console.error(e)};cr$$module$str$c3runtime.seal=function(e){return e};cr$$module$str$c3runtime.freeze=function(e){return e};cr$$module$str$c3runtime.is_undefined=function(e){return"undefined"===typeof e};
cr$$module$str$c3runtime.is_number=function(e){return"number"===typeof e};cr$$module$str$c3runtime.is_string=function(e){return"string"===typeof e};cr$$module$str$c3runtime.isPOT=function(e){return 0<e&&0===(e-1&e)};cr$$module$str$c3runtime.nextHighestPowerOfTwo=function(e){--e;for(var u=1;32>u;u<<=1)e|=e>>u;return e+1};cr$$module$str$c3runtime.abs=function(e){return 0>e?-e:e};cr$$module$str$c3runtime.max=function(e,u){return e>u?e:u};cr$$module$str$c3runtime.min=function(e,u){return e<u?e:u};cr$$module$str$c3runtime.PI=
Math.PI;cr$$module$str$c3runtime.round=function(e){return e+.5|0};cr$$module$str$c3runtime.floor=function(e){return 0<=e?e|0:(e|0)-1};cr$$module$str$c3runtime.ceil=function(e){var u=e|0;return u===e?u:u+1};b.prototype.offset=function(e,u){this.x+=e;this.y+=u;return this};b.prototype.mul=function(e,u){this.x*=e;this.y*=u;return this};cr$$module$str$c3runtime.vector2=b;cr$$module$str$c3runtime.segments_intersect=function(e,u,G,I,R,S,V,T){if(e<G){var Z=e;var aa=G}else Z=G,aa=e;if(R<V){var f=R;var q=
V}else f=V,q=R;if(aa<f||Z>q)return!1;u<I?(Z=u,aa=I):(Z=I,aa=u);S<T?(f=S,q=T):(f=T,q=S);if(aa<f||Z>q)return!1;aa=R-e+V-G;Z=S-u+T-I;e=G-e;u=I-u;R=V-R;S=T-S;T=cr$$module$str$c3runtime.abs(u*R-S*e);return cr$$module$str$c3runtime.abs(R*Z-S*aa)>T?!1:cr$$module$str$c3runtime.abs(e*Z-u*aa)<=T};l.prototype.set=function(e,u,G,I){this.left=e;this.top=u;this.right=G;this.bottom=I};l.prototype.copy=function(e){this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=e.bottom};l.prototype.width=function(){return this.right-
this.left};l.prototype.height=function(){return this.bottom-this.top};l.prototype.offset=function(e,u){this.left+=e;this.top+=u;this.right+=e;this.bottom+=u;return this};l.prototype.normalize=function(){if(this.left>this.right){var e=this.left;this.left=this.right;this.right=e}this.top>this.bottom&&(e=this.top,this.top=this.bottom,this.bottom=e)};l.prototype.intersects_rect=function(e){return!(e.right<this.left||e.bottom<this.top||e.left>this.right||e.top>this.bottom)};l.prototype.intersects_rect_off=
function(e,u,G){return!(e.right+u<this.left||e.bottom+G<this.top||e.left+u>this.right||e.top+G>this.bottom)};l.prototype.contains_pt=function(e,u){return e>=this.left&&e<=this.right&&u>=this.top&&u<=this.bottom};l.prototype.equals=function(e){return this.left===e.left&&this.top===e.top&&this.right===e.right&&this.bottom===e.bottom};cr$$module$str$c3runtime.rect=l;v.prototype.set_from_rect=function(e){this.tlx=e.left;this.tly=e.top;this.trx=e.right;this.try_=e.top;this.brx=e.right;this.bry=e.bottom;
this.blx=e.left;this.bly=e.bottom};v.prototype.set_from_rotated_rect=function(e,u){if(0===u)this.set_from_rect(e);else{var G=Math.sin(u),I=Math.cos(u);u=e.left*G;var R=e.top*G,S=e.right*G;G*=e.bottom;var V=e.left*I,T=e.top*I,Z=e.right*I;e=e.bottom*I;this.tlx=V-R;this.tly=T+u;this.trx=Z-R;this.try_=T+S;this.brx=Z-G;this.bry=e+S;this.blx=V-G;this.bly=e+u}};v.prototype.offset=function(e,u){this.tlx+=e;this.tly+=u;this.trx+=e;this.try_+=u;this.brx+=e;this.bry+=u;this.blx+=e;this.bly+=u;return this};var H=
0,B=0;v.prototype.bounding_box=function(e){A(this.tlx,this.trx,this.brx,this.blx);e.left=H;e.right=B;A(this.tly,this.try_,this.bry,this.bly);e.top=H;e.bottom=B};v.prototype.contains_pt=function(e,u){var G=this.tlx,I=this.tly,R=this.trx-G,S=this.try_-I,V=this.brx-G,T=this.bry-I;e-=G;u-=I;var Z=R*R+S*S,aa=R*V+S*T;S=R*e+S*u;var f=V*V+T*T,q=V*e+T*u,y=1/(Z*f-aa*aa);R=(f*S-aa*q)*y;Z=(Z*q-aa*S)*y;if(0<=R&&0<Z&&1>R+Z)return!0;R=this.blx-G;S=this.bly-I;Z=R*R+S*S;aa=R*V+S*T;S=R*e+S*u;y=1/(Z*f-aa*aa);R=(f*S-
aa*q)*y;Z=(Z*q-aa*S)*y;return 0<=R&&0<Z&&1>R+Z};v.prototype.at=function(e,u){if(u)switch(e){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(e){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};v.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};v.prototype.midY=function(){return(this.tly+
this.try_+this.bry+this.bly)/4};v.prototype.intersects_segment=function(e,u,G,I){if(this.contains_pt(e,u)||this.contains_pt(G,I))return!0;var R;for(R=0;4>R;R++){var S=this.at(R,!0);var V=this.at(R,!1);var T=this.at(R+1,!0);var Z=this.at(R+1,!1);if(cr$$module$str$c3runtime.segments_intersect(e,u,G,I,S,V,T,Z))return!0}return!1};v.prototype.intersects_quad=function(e){var u=e.midX(),G=e.midY();if(this.contains_pt(u,G))return!0;u=this.midX();G=this.midY();if(e.contains_pt(u,G))return!0;var I,R;for(I=
0;4>I;I++)for(R=0;4>R;R++){u=this.at(I,!0);G=this.at(I,!1);var S=this.at(I+1,!0);var V=this.at(I+1,!1);var T=e.at(R,!0);var Z=e.at(R,!1);var aa=e.at(R+1,!0);var f=e.at(R+1,!1);if(cr$$module$str$c3runtime.segments_intersect(u,G,S,V,T,Z,aa,f))return!0}return!1};cr$$module$str$c3runtime.quad=v;cr$$module$str$c3runtime.RGB=function(e,u,G){return Math.max(Math.min(e,255),0)|Math.max(Math.min(u,255),0)<<8|Math.max(Math.min(G,255),0)<<16};cr$$module$str$c3runtime.RGBAEx=function(e,u,G,I){e=cr$$module$str$c3runtime.clamp(Math.floor(1024*
e),-8192,8191);u=cr$$module$str$c3runtime.clamp(Math.floor(1024*u),-8192,8191);G=cr$$module$str$c3runtime.clamp(Math.floor(1024*G),-8192,8191);I=cr$$module$str$c3runtime.clamp(Math.floor(1024*I),0,1024);0>e&&(e+=16384);0>u&&(u+=16384);0>G&&(G+=16384);return-(274877906944*e+16777216*u+1024*G+I)};cr$$module$str$c3runtime.RGBEx=function(e,u,G){return cr$$module$str$c3runtime.RGBAEx(e,u,G,1)};cr$$module$str$c3runtime.GetRValue=function(e){if(0<=e)return(e&255)/255;e=Math.floor(-e/274877906944);8191<e&&
(e-=16384);return e/1024};cr$$module$str$c3runtime.GetGValue=function(e){if(0<=e)return((e&65280)>>8)/255;e=Math.floor(-e%274877906944/16777216);8191<e&&(e-=16384);return e/1024};cr$$module$str$c3runtime.GetBValue=function(e){if(0<=e)return((e&16711680)>>16)/255;e=Math.floor(-e%16777216/1024);8191<e&&(e-=16384);return e/1024};cr$$module$str$c3runtime.GetAValue=function(e){return 0===e&&0>1/e?0:0<=e?1:Math.floor(-e%1024)/1024};cr$$module$str$c3runtime.shallowCopy=function(e,u,G){for(var I in u)u.hasOwnProperty(I)&&
(e[I]=u[I]);return e};cr$$module$str$c3runtime.arrayRemove=function(e,u){var G;u=cr$$module$str$c3runtime.floor(u);if(!(0>u||u>=e.length)){for(G=e.length-1;u<G;u++)e[u]=e[u+1];cr$$module$str$c3runtime.truncateArray(e,G)}};cr$$module$str$c3runtime.truncateArray=function(e,u){e.length=u};cr$$module$str$c3runtime.clearArray=function(e){cr$$module$str$c3runtime.truncateArray(e,0)};cr$$module$str$c3runtime.shallowAssignArray=function(e,u){cr$$module$str$c3runtime.clearArray(e);var G;var I=0;for(G=u.length;I<
G;++I)e[I]=u[I]};cr$$module$str$c3runtime.appendArray=function(e,u){e.push.apply(e,u)};cr$$module$str$c3runtime.fastIndexOf=function(e,u){var G;var I=0;for(G=e.length;I<G;++I)if(e[I]===u)return I;return-1};cr$$module$str$c3runtime.arrayFindRemove=function(e,u){u=cr$$module$str$c3runtime.fastIndexOf(e,u);-1!==u&&cr$$module$str$c3runtime.arrayRemove(e,u)};cr$$module$str$c3runtime.clamp=function(e,u,G){return e<u?u:e>G?G:e};cr$$module$str$c3runtime.to_radians=function(e){return e/(180/cr$$module$str$c3runtime.PI)};
cr$$module$str$c3runtime.to_degrees=function(e){return 180/cr$$module$str$c3runtime.PI*e};cr$$module$str$c3runtime.clamp_angle_degrees=function(e){e%=360;0>e&&(e+=360);return e};cr$$module$str$c3runtime.clamp_angle=function(e){e%=2*cr$$module$str$c3runtime.PI;0>e&&(e+=2*cr$$module$str$c3runtime.PI);return e};cr$$module$str$c3runtime.to_clamped_degrees=function(e){return cr$$module$str$c3runtime.clamp_angle_degrees(cr$$module$str$c3runtime.to_degrees(e))};cr$$module$str$c3runtime.to_clamped_radians=
function(e){return cr$$module$str$c3runtime.clamp_angle(cr$$module$str$c3runtime.to_radians(e))};cr$$module$str$c3runtime.angleTo=function(e,u,G,I){return Math.atan2(I-u,G-e)};cr$$module$str$c3runtime.angleDiff=function(e,u){if(e===u)return 0;e=Math.sin(e)*Math.sin(u)+Math.cos(e)*Math.cos(u);return 1<=e?0:-1>=e?cr$$module$str$c3runtime.PI:Math.acos(e)};cr$$module$str$c3runtime.angleRotate=function(e,u,G){var I=Math.sin(e),R=Math.cos(e),S=Math.sin(u),V=Math.cos(u);return Math.acos(I*S+R*V)>G?0<R*S-
I*V?cr$$module$str$c3runtime.clamp_angle(e+G):cr$$module$str$c3runtime.clamp_angle(e-G):cr$$module$str$c3runtime.clamp_angle(u)};cr$$module$str$c3runtime.angleClockwise=function(e,u){return 0>=Math.cos(e)*Math.sin(u)-Math.sin(e)*Math.cos(u)};cr$$module$str$c3runtime.rotatePtAround=function(e,u,G,I,R,S){if(0===G)return S?e:u;var V=Math.sin(G);G=Math.cos(G);e-=I;u-=R;var T=e*V;e=e*G-u*V;return S?e+I:u*G+T+R};cr$$module$str$c3runtime.distanceTo=function(e,u,G,I){e=G-e;u=I-u;return Math.sqrt(e*e+u*u)};
cr$$module$str$c3runtime.xor=function(e,u){return!e!==!u};cr$$module$str$c3runtime.lerp=function(e,u,G){return e+(u-e)*G};cr$$module$str$c3runtime.unlerp=function(e,u,G){return e===u?0:(G-e)/(u-e)};cr$$module$str$c3runtime.anglelerp=function(e,u,G){var I=cr$$module$str$c3runtime.angleDiff(e,u);return cr$$module$str$c3runtime.angleClockwise(u,e)?e+I*G:e-I*G};cr$$module$str$c3runtime.qarp=function(e,u,G,I){return cr$$module$str$c3runtime.lerp(cr$$module$str$c3runtime.lerp(e,u,I),cr$$module$str$c3runtime.lerp(u,
G,I),I)};cr$$module$str$c3runtime.cubic=function(e,u,G,I,R){return cr$$module$str$c3runtime.lerp(cr$$module$str$c3runtime.qarp(e,u,G,R),cr$$module$str$c3runtime.qarp(u,G,I,R),R)};cr$$module$str$c3runtime.cosp=function(e,u,G){return(e+u+(e-u)*Math.cos(G*Math.PI))/2};cr$$module$str$c3runtime.hasAnyOwnProperty=function(e){for(var u in e)if(e.hasOwnProperty(u))return!0;return!1};cr$$module$str$c3runtime.wipe=function(e){for(var u in e)e.hasOwnProperty(u)&&delete e[u]};var g=+new Date;cr$$module$str$c3runtime.performance_now=
function(){if("undefined"!==typeof window.performance){var e=window.performance;if("undefined"!==typeof e.now)return e.now();if("undefined"!==typeof e.webkitNow)return e.webkitNow();if("undefined"!==typeof e.mozNow)return e.mozNow();if("undefined"!==typeof e.msNow)return e.msNow()}return Date.now()-g};var r=!1;"undefined"!==typeof window&&(r=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),!r&&/safari/i.test(navigator.userAgent),/(iphone|ipod|ipad)/i.test(navigator.userAgent));
var x="undefined"!==typeof Set&&"undefined"!==typeof Set.prototype.forEach;L.prototype.contains=function(e){return this.isEmpty()?!1:x?this.s.has(e):this.items&&this.items.hasOwnProperty(e)};L.prototype.add=function(e){if(x)this.s.has(e)||(this.s.add(e),this.cache_valid=!1);else{var u=e.toString(),G=this.items;G?G.hasOwnProperty(u)||(G[u]=e,this.item_count++,this.cache_valid=!1):(this.items={},this.items[u]=e,this.item_count=1,this.cache_valid=!1)}};L.prototype.remove=function(e){if(!this.isEmpty())if(x)this.s.has(e)&&
(this.s["delete"](e),this.cache_valid=!1);else if(this.items){e=e.toString();var u=this.items;u.hasOwnProperty(e)&&(delete u[e],this.item_count--,this.cache_valid=!1)}};L.prototype.clear=function(){this.isEmpty()||(x?this.s.clear():(this.items=null,this.item_count=0),cr$$module$str$c3runtime.clearArray(this.values_cache),this.cache_valid=!0)};L.prototype.isEmpty=function(){return 0===this.count()};L.prototype.count=function(){return x?this.s.size:this.item_count};var N=null,Q=0;L.prototype.update_cache=
function(){if(!this.cache_valid){if(x)cr$$module$str$c3runtime.clearArray(this.values_cache),N=this.values_cache,Q=0,this.s.forEach(K),N=null,Q=0;else{var e=this.values_cache;cr$$module$str$c3runtime.clearArray(e);var u,G=0,I=this.items;if(I)for(u in I)I.hasOwnProperty(u)&&(e[G++]=I[u])}this.cache_valid=!0}};L.prototype.valuesRef=function(){this.update_cache();return this.values_cache};cr$$module$str$c3runtime.ObjectSet=L;var F=new cr$$module$str$c3runtime.ObjectSet;cr$$module$str$c3runtime.removeArrayDuplicates=
function(e){var u;var G=0;for(u=e.length;G<u;++G)F.add(e[G]);cr$$module$str$c3runtime.shallowAssignArray(e,F.valuesRef());F.clear()};cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet=function(e,u){x?cr$$module$str$c3runtime.arrayRemoveAll_set(e,u.s):cr$$module$str$c3runtime.arrayRemoveAll_arr(e,u.valuesRef())};cr$$module$str$c3runtime.arrayRemoveAll_set=function(e,u){var G,I;var R=G=0;for(I=e.length;G<I;++G){var S=e[G];u.has(S)||(e[R++]=S)}cr$$module$str$c3runtime.truncateArray(e,R)};cr$$module$str$c3runtime.arrayRemoveAll_arr=
function(e,u){var G,I;var R=G=0;for(I=e.length;G<I;++G){var S=e[G];-1===cr$$module$str$c3runtime.fastIndexOf(u,S)&&(e[R++]=S)}cr$$module$str$c3runtime.truncateArray(e,R)};n.prototype.add=function(e){this.y=e-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};n.prototype.reset=function(){this.sum=this.t=this.y=this.c=0};cr$$module$str$c3runtime.KahanAdder=n;cr$$module$str$c3runtime.regexp_escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};a.prototype.set_pts=
function(e){this.pts_array=e;this.pts_count=e.length/2;this.pts_cache.length=e.length;this.cache_height=this.cache_width=-1;this.cache_angle=0};a.prototype.is_empty=function(){return!this.pts_array.length};a.prototype.update_bbox=function(){for(var e=this.pts_cache,u=e[0],G=u,I=e[1],R=I,S,V,T=1,Z=this.pts_count;T<Z;++T)V=2*T,S=e[V],V=e[V+1],S<u&&(u=S),S>G&&(G=S),V<I&&(I=V),V>R&&(R=V);this.bboxLeft=u;this.bboxRight=G;this.bboxTop=I;this.bboxBottom=R};a.prototype.set_from_rect=function(e,u,G){this.pts_cache.length=
8;this.pts_count=4;var I=this.pts_cache;I[0]=e.left-u;I[1]=e.top-G;I[2]=e.right-u;I[3]=e.top-G;I[4]=e.right-u;I[5]=e.bottom-G;I[6]=e.left-u;I[7]=e.bottom-G;this.cache_width=e.right-e.left;this.cache_height=e.bottom-e.top;this.update_bbox()};a.prototype.set_from_quad=function(e,u,G,I,R){this.pts_cache.length=8;this.pts_count=4;var S=this.pts_cache;S[0]=e.tlx-u;S[1]=e.tly-G;S[2]=e.trx-u;S[3]=e.try_-G;S[4]=e.brx-u;S[5]=e.bry-G;S[6]=e.blx-u;S[7]=e.bly-G;this.cache_width=I;this.cache_height=R;this.update_bbox()};
a.prototype.set_from_poly=function(e){this.pts_count=e.pts_count;cr$$module$str$c3runtime.shallowAssignArray(this.pts_cache,e.pts_cache);this.bboxLeft=e.bboxLeft;this.bboxTop-e.bboxTop;this.bboxRight=e.bboxRight;this.bboxBottom=e.bboxBottom};a.prototype.cache_poly=function(e,u,G){if(this.cache_width!==e||this.cache_height!==u||this.cache_angle!==G){this.cache_width=e;this.cache_height=u;this.cache_angle=G;var I,R=0,S=1,V=this.pts_array,T=this.pts_cache;0!==G&&(R=Math.sin(G),S=Math.cos(G));G=0;for(I=
this.pts_count;G<I;G++){var Z=2*G;var aa=Z+1;var f=V[Z]*e;var q=V[aa]*u;T[Z]=f*S-q*R;T[aa]=q*S+f*R}this.update_bbox()}};a.prototype.contains_pt=function(e,u){var G=this.pts_cache;if(e===G[0]&&u===G[1])return!0;var I,R=this.pts_count,S=this.bboxLeft-110,V=this.bboxTop-101,T=this.bboxRight+131,Z=this.bboxBottom+120,aa=0,f=0;for(I=0;I<R;I++){var q=2*I;var y=(I+1)%R*2;var D=G[q];q=G[q+1];var w=G[y];y=G[y+1];cr$$module$str$c3runtime.segments_intersect(S,V,e,u,D,q,w,y)&&aa++;cr$$module$str$c3runtime.segments_intersect(T,
Z,e,u,D,q,w,y)&&f++}return 1===aa%2||1===f%2};a.prototype.intersects_poly=function(e,u,G){var I=e.pts_cache,R=this.pts_cache;if(this.contains_pt(I[0]+u,I[1]+G)||e.contains_pt(R[0]-u,R[1]-G))return!0;var S,V;var T=0;for(S=this.pts_count;T<S;T++){var Z=2*T;var aa=(T+1)%S*2;var f=R[Z];Z=R[Z+1];var q=R[aa];var y=R[aa+1];aa=0;for(V=e.pts_count;aa<V;aa++){var D=2*aa;var w=(aa+1)%V*2;var J=I[D]+u;D=I[D+1]+G;var M=I[w]+u;w=I[w+1]+G;if(cr$$module$str$c3runtime.segments_intersect(f,Z,q,y,J,D,M,w))return!0}}return!1};
a.prototype.intersects_segment=function(e,u,G,I,R,S){var V=this.pts_cache;if(this.contains_pt(G-e,I-u))return!0;var T;var Z=0;for(T=this.pts_count;Z<T;Z++){var aa=2*Z;var f=(Z+1)%T*2;var q=V[aa]+e;aa=V[aa+1]+u;var y=V[f]+e;f=V[f+1]+u;if(cr$$module$str$c3runtime.segments_intersect(G,I,R,S,q,aa,y,f))return!0}return!1};a.prototype.mirror=function(e){var u;var G=0;for(u=this.pts_count;G<u;++G){var I=2*G;this.pts_cache[I]=2*e-this.pts_cache[I]}};a.prototype.flip=function(e){var u;var G=0;for(u=this.pts_count;G<
u;++G){var I=2*G+1;this.pts_cache[I]=2*e-this.pts_cache[I]}};a.prototype.diag=function(){var e;var u=0;for(e=this.pts_count;u<e;++u){var G=2*u;var I=G+1;var R=this.pts_cache[G];this.pts_cache[G]=this.pts_cache[I];this.pts_cache[I]=R}};a.prototype.is_enabled=function(){return this.enabled};cr$$module$str$c3runtime.CollisionPoly=a;c.prototype.totalCellCount=0;c.prototype.getCell=function(e,u,G){var I=this.cells[e];return I?(I=I[u])?I:G?(I=p(this,e,u),this.cells[e][u]=I):null:G?(I=p(this,e,u),this.cells[e]=
{},this.cells[e][u]=I):null};c.prototype.XToCell=function(e){return cr$$module$str$c3runtime.floor(e/this.cellwidth)};c.prototype.YToCell=function(e){return cr$$module$str$c3runtime.floor(e/this.cellheight)};c.prototype.update=function(e,u,G){var I,R,S;if(u){var V=u.left;for(I=u.right;V<=I;++V){var T=u.top;for(R=u.bottom;T<=R;++T)if(!G||!G.contains_pt(V,T))if(S=this.getCell(V,T,!1))S.remove(e),S.isEmpty()&&(c.prototype.totalCellCount--,S.objects.clear(),1E3>d.length&&d.push(S),this.cells[V][T]=null)}}if(G)for(V=
G.left,I=G.right;V<=I;++V)for(T=G.top,R=G.bottom;T<=R;++T)u&&u.contains_pt(V,T)||this.getCell(V,T,!0).insert(e)};c.prototype.queryRange=function(e,u){var G,I;var R=this.XToCell(e.left);var S=this.YToCell(e.top);var V=this.XToCell(e.right);for(G=this.YToCell(e.bottom);R<=V;++R)for(e=S;e<=G;++e)(I=this.getCell(R,e,!1))&&I.dump(u)};cr$$module$str$c3runtime.SparseGrid=c;h.prototype.totalCellCount=0;h.prototype.getCell=function(e,u,G){var I=this.cells[e];return I?(I=I[u])?I:G?(I=t(this,e,u),this.cells[e][u]=
I):null:G?(I=t(this,e,u),this.cells[e]={},this.cells[e][u]=I):null};h.prototype.XToCell=function(e){return cr$$module$str$c3runtime.floor(e/this.cellwidth)};h.prototype.YToCell=function(e){return cr$$module$str$c3runtime.floor(e/this.cellheight)};h.prototype.update=function(e,u,G){var I,R,S;if(u){var V=u.left;for(I=u.right;V<=I;++V){var T=u.top;for(R=u.bottom;T<=R;++T)if(!G||!G.contains_pt(V,T))if(S=this.getCell(V,T,!1))S.remove(e),S.isEmpty()&&(h.prototype.totalCellCount--,S.reset(),1E3>k.length&&
k.push(S),this.cells[V][T]=null)}}if(G)for(V=G.left,I=G.right;V<=I;++V)for(T=G.top,R=G.bottom;T<=R;++T)u&&u.contains_pt(V,T)||this.getCell(V,T,!0).insert(e)};h.prototype.queryRange=function(e,u,G,I,R){var S,V;e=this.XToCell(e);u=this.YToCell(u);G=this.XToCell(G);for(S=this.YToCell(I);e<=G;++e)for(I=u;I<=S;++I)(V=this.getCell(e,I,!1))&&V.dump(R)};h.prototype.markRangeChanged=function(e){var u,G;var I=e.left;var R=e.top;var S=e.right;for(u=e.bottom;I<=S;++I)for(e=R;e<=u;++e)if(G=this.getCell(I,e,!1))G.is_sorted=
!1};cr$$module$str$c3runtime.RenderGrid=h;var d=[];m.prototype.isEmpty=function(){return this.objects.isEmpty()};m.prototype.insert=function(e){this.objects.add(e)};m.prototype.remove=function(e){this.objects.remove(e)};m.prototype.dump=function(e){cr$$module$str$c3runtime.appendArray(e,this.objects.valuesRef())};cr$$module$str$c3runtime.GridCell=m;var k=[];E.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;this.flush_pending();
return!0};E.prototype.insert=function(e){this.pending_removal.contains(e)?(this.pending_removal.remove(e),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>e.get_zindex()&&(this.is_sorted=!1),this.objects.push(e)):(this.objects.push(e),this.is_sorted=!0)};E.prototype.remove=function(e){this.pending_removal.add(e);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};E.prototype.flush_pending=
function(){this.any_pending_removal&&(this.pending_removal.count()===this.objects.length?this.reset():(cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};E.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(z),this.is_sorted=!0)};E.prototype.reset=function(){cr$$module$str$c3runtime.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};
E.prototype.dump=function(e){this.flush_pending();this.ensure_sorted();this.objects.length&&e.push(this.objects)};cr$$module$str$c3runtime.RenderCell=E;var C="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr$$module$str$c3runtime.effectToCompositeOp=function(e){return 0>=e||11<=e?"source-over":C[e-1]};cr$$module$str$c3runtime.setGLBlend=function(e,u,G){if(G)switch(e.srcBlend=G.ONE,e.destBlend=G.ONE_MINUS_SRC_ALPHA,u){case 1:e.srcBlend=
G.ONE;e.destBlend=G.ONE;break;case 3:e.srcBlend=G.ONE;e.destBlend=G.ZERO;break;case 4:e.srcBlend=G.ONE_MINUS_DST_ALPHA;e.destBlend=G.ONE;break;case 5:e.srcBlend=G.DST_ALPHA;e.destBlend=G.ZERO;break;case 6:e.srcBlend=G.ZERO;e.destBlend=G.SRC_ALPHA;break;case 7:e.srcBlend=G.ONE_MINUS_DST_ALPHA;e.destBlend=G.ZERO;break;case 8:e.srcBlend=G.ZERO;e.destBlend=G.ONE_MINUS_SRC_ALPHA;break;case 9:e.srcBlend=G.DST_ALPHA;e.destBlend=G.ONE_MINUS_SRC_ALPHA;break;case 10:e.srcBlend=G.ONE_MINUS_DST_ALPHA,e.destBlend=
G.SRC_ALPHA}};cr$$module$str$c3runtime.round6dp=function(e){return Math.round(1E6*e)/1E6};cr$$module$str$c3runtime.equals_nocase=function(e,u){return"string"!==typeof e||"string"!==typeof u||e.length!==u.length?!1:e===u?!0:e.toLowerCase()===u.toLowerCase()};cr$$module$str$c3runtime.cssToCamelCase=function(e){var u="",G,I=!1;var R=0;for(G=e.length;R<G;++R){var S=e.charAt(R);"-"===S?I=!0:I?(u+=S.toUpperCase(),I=!1):u+=S}return u};cr$$module$str$c3runtime.isCanvasInputEvent=function(e){e=e.target;return!e||
e===document||e===window||document&&document.body&&e===document.body||cr$$module$str$c3runtime.equals_nocase(e.tagName,"canvas")?!0:!1}})();var MatrixArray$$module$str$c3runtime="undefined"!==typeof Float32Array?Float32Array:Array,glMatrixArrayType$$module$str$c3runtime=MatrixArray$$module$str$c3runtime,vec3$$module$str$c3runtime={},mat3$$module$str$c3runtime={},mat4$$module$str$c3runtime={},quat4$$module$str$c3runtime={};
vec3$$module$str$c3runtime.create=function(b){var l=new MatrixArray$$module$str$c3runtime(3);b&&(l[0]=b[0],l[1]=b[1],l[2]=b[2]);return l};vec3$$module$str$c3runtime.set=function(b,l){l[0]=b[0];l[1]=b[1];l[2]=b[2];return l};vec3$$module$str$c3runtime.add=function(b,l,v){if(!v||b===v)return b[0]+=l[0],b[1]+=l[1],b[2]+=l[2],b;v[0]=b[0]+l[0];v[1]=b[1]+l[1];v[2]=b[2]+l[2];return v};
vec3$$module$str$c3runtime.subtract=function(b,l,v){if(!v||b===v)return b[0]-=l[0],b[1]-=l[1],b[2]-=l[2],b;v[0]=b[0]-l[0];v[1]=b[1]-l[1];v[2]=b[2]-l[2];return v};vec3$$module$str$c3runtime.negate=function(b,l){l||(l=b);l[0]=-b[0];l[1]=-b[1];l[2]=-b[2];return l};vec3$$module$str$c3runtime.scale=function(b,l,v){if(!v||b===v)return b[0]*=l,b[1]*=l,b[2]*=l,b;v[0]=b[0]*l;v[1]=b[1]*l;v[2]=b[2]*l;return v};
vec3$$module$str$c3runtime.normalize=function(b,l){l||(l=b);var v=b[0],A=b[1];b=b[2];var L=Math.sqrt(v*v+A*A+b*b);if(L){if(1===L)return l[0]=v,l[1]=A,l[2]=b,l}else return l[0]=0,l[1]=0,l[2]=0,l;L=1/L;l[0]=v*L;l[1]=A*L;l[2]=b*L;return l};vec3$$module$str$c3runtime.cross=function(b,l,v){v||(v=b);var A=b[0],L=b[1];b=b[2];var K=l[0],n=l[1];l=l[2];v[0]=L*l-b*n;v[1]=b*K-A*l;v[2]=A*n-L*K;return v};vec3$$module$str$c3runtime.length=function(b){var l=b[0],v=b[1];b=b[2];return Math.sqrt(l*l+v*v+b*b)};
vec3$$module$str$c3runtime.dot=function(b,l){return b[0]*l[0]+b[1]*l[1]+b[2]*l[2]};vec3$$module$str$c3runtime.direction=function(b,l,v){v||(v=b);var A=b[0]-l[0],L=b[1]-l[1];b=b[2]-l[2];l=Math.sqrt(A*A+L*L+b*b);if(!l)return v[0]=0,v[1]=0,v[2]=0,v;l=1/l;v[0]=A*l;v[1]=L*l;v[2]=b*l;return v};vec3$$module$str$c3runtime.lerp=function(b,l,v,A){A||(A=b);A[0]=b[0]+v*(l[0]-b[0]);A[1]=b[1]+v*(l[1]-b[1]);A[2]=b[2]+v*(l[2]-b[2]);return A};
vec3$$module$str$c3runtime.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+"]"};mat3$$module$str$c3runtime.create=function(b){var l=new MatrixArray$$module$str$c3runtime(9);b&&(l[0]=b[0],l[1]=b[1],l[2]=b[2],l[3]=b[3],l[4]=b[4],l[5]=b[5],l[6]=b[6],l[7]=b[7],l[8]=b[8]);return l};mat3$$module$str$c3runtime.set=function(b,l){l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=b[3];l[4]=b[4];l[5]=b[5];l[6]=b[6];l[7]=b[7];l[8]=b[8];return l};
mat3$$module$str$c3runtime.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};mat3$$module$str$c3runtime.transpose=function(b,l){if(!l||b===l){l=b[1];var v=b[2],A=b[5];b[1]=b[3];b[2]=b[6];b[3]=l;b[5]=b[7];b[6]=v;b[7]=A;return b}l[0]=b[0];l[1]=b[3];l[2]=b[6];l[3]=b[1];l[4]=b[4];l[5]=b[7];l[6]=b[2];l[7]=b[5];l[8]=b[8];return l};
mat3$$module$str$c3runtime.toMat4=function(b,l){l||(l=mat4$$module$str$c3runtime.create());l[15]=1;l[14]=0;l[13]=0;l[12]=0;l[11]=0;l[10]=b[8];l[9]=b[7];l[8]=b[6];l[7]=0;l[6]=b[5];l[5]=b[4];l[4]=b[3];l[3]=0;l[2]=b[2];l[1]=b[1];l[0]=b[0];return l};mat3$$module$str$c3runtime.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+"]"};
mat4$$module$str$c3runtime.create=function(b){var l=new MatrixArray$$module$str$c3runtime(16);b&&(l[0]=b[0],l[1]=b[1],l[2]=b[2],l[3]=b[3],l[4]=b[4],l[5]=b[5],l[6]=b[6],l[7]=b[7],l[8]=b[8],l[9]=b[9],l[10]=b[10],l[11]=b[11],l[12]=b[12],l[13]=b[13],l[14]=b[14],l[15]=b[15]);return l};mat4$$module$str$c3runtime.set=function(b,l){l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=b[3];l[4]=b[4];l[5]=b[5];l[6]=b[6];l[7]=b[7];l[8]=b[8];l[9]=b[9];l[10]=b[10];l[11]=b[11];l[12]=b[12];l[13]=b[13];l[14]=b[14];l[15]=b[15];return l};
mat4$$module$str$c3runtime.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4$$module$str$c3runtime.transpose=function(b,l){if(!l||b===l){l=b[1];var v=b[2],A=b[3],L=b[6],K=b[7],n=b[11];b[1]=b[4];b[2]=b[8];b[3]=b[12];b[4]=l;b[6]=b[9];b[7]=b[13];b[8]=v;b[9]=L;b[11]=b[14];b[12]=A;b[13]=K;b[14]=n;return b}l[0]=b[0];l[1]=b[4];l[2]=b[8];l[3]=b[12];l[4]=b[1];l[5]=b[5];l[6]=b[9];l[7]=b[13];l[8]=b[2];l[9]=b[6];l[10]=b[10];l[11]=b[14];l[12]=b[3];l[13]=b[7];l[14]=b[11];l[15]=b[15];return l};
mat4$$module$str$c3runtime.determinant=function(b){var l=b[0],v=b[1],A=b[2],L=b[3],K=b[4],n=b[5],a=b[6],c=b[7],h=b[8],p=b[9],m=b[10],t=b[11],E=b[12],z=b[13],H=b[14];b=b[15];return E*p*a*L-h*z*a*L-E*n*m*L+K*z*m*L+h*n*H*L-K*p*H*L-E*p*A*c+h*z*A*c+E*v*m*c-l*z*m*c-h*v*H*c+l*p*H*c+E*n*A*t-K*z*A*t-E*v*a*t+l*z*a*t+K*v*H*t-l*n*H*t-h*n*A*b+K*p*A*b+h*v*a*b-l*p*a*b-K*v*m*b+l*n*m*b};
mat4$$module$str$c3runtime.inverse=function(b,l){l||(l=b);var v=b[0],A=b[1],L=b[2],K=b[3],n=b[4],a=b[5],c=b[6],h=b[7],p=b[8],m=b[9],t=b[10],E=b[11],z=b[12],H=b[13],B=b[14];b=b[15];var g=v*a-A*n,r=v*c-L*n,x=v*h-K*n,N=A*c-L*a,Q=A*h-K*a,F=L*h-K*c,d=p*H-m*z,k=p*B-t*z,C=p*b-E*z,e=m*B-t*H,u=m*b-E*H,G=t*b-E*B,I=1/(g*G-r*u+x*e+N*C-Q*k+F*d);l[0]=(a*G-c*u+h*e)*I;l[1]=(-A*G+L*u-K*e)*I;l[2]=(H*F-B*Q+b*N)*I;l[3]=(-m*F+t*Q-E*N)*I;l[4]=(-n*G+c*C-h*k)*I;l[5]=(v*G-L*C+K*k)*I;l[6]=(-z*F+B*x-b*r)*I;l[7]=(p*F-t*x+E*
r)*I;l[8]=(n*u-a*C+h*d)*I;l[9]=(-v*u+A*C-K*d)*I;l[10]=(z*Q-H*x+b*g)*I;l[11]=(-p*Q+m*x-E*g)*I;l[12]=(-n*e+a*k-c*d)*I;l[13]=(v*e-A*k+L*d)*I;l[14]=(-z*N+H*r-B*g)*I;l[15]=(p*N-m*r+t*g)*I;return l};mat4$$module$str$c3runtime.toRotationMat=function(b,l){l||(l=mat4$$module$str$c3runtime.create());l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=b[3];l[4]=b[4];l[5]=b[5];l[6]=b[6];l[7]=b[7];l[8]=b[8];l[9]=b[9];l[10]=b[10];l[11]=b[11];l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l};
mat4$$module$str$c3runtime.toMat3=function(b,l){l||(l=mat3$$module$str$c3runtime.create());l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=b[4];l[4]=b[5];l[5]=b[6];l[6]=b[8];l[7]=b[9];l[8]=b[10];return l};
mat4$$module$str$c3runtime.toInverseMat3=function(b,l){var v=b[0],A=b[1],L=b[2],K=b[4],n=b[5],a=b[6],c=b[8],h=b[9];b=b[10];var p=b*n-a*h,m=-b*K+a*c,t=h*K-n*c,E=v*p+A*m+L*t;if(!E)return null;E=1/E;l||(l=mat3$$module$str$c3runtime.create());l[0]=p*E;l[1]=(-b*A+L*h)*E;l[2]=(a*A-L*n)*E;l[3]=m*E;l[4]=(b*v-L*c)*E;l[5]=(-a*v+L*K)*E;l[6]=t*E;l[7]=(-h*v+A*c)*E;l[8]=(n*v-A*K)*E;return l};
mat4$$module$str$c3runtime.multiply=function(b,l,v){v||(v=b);var A=b[0],L=b[1],K=b[2],n=b[3],a=b[4],c=b[5],h=b[6],p=b[7],m=b[8],t=b[9],E=b[10],z=b[11],H=b[12],B=b[13],g=b[14];b=b[15];var r=l[0],x=l[1],N=l[2],Q=l[3],F=l[4],d=l[5],k=l[6],C=l[7],e=l[8],u=l[9],G=l[10],I=l[11],R=l[12],S=l[13],V=l[14];l=l[15];v[0]=r*A+x*a+N*m+Q*H;v[1]=r*L+x*c+N*t+Q*B;v[2]=r*K+x*h+N*E+Q*g;v[3]=r*n+x*p+N*z+Q*b;v[4]=F*A+d*a+k*m+C*H;v[5]=F*L+d*c+k*t+C*B;v[6]=F*K+d*h+k*E+C*g;v[7]=F*n+d*p+k*z+C*b;v[8]=e*A+u*a+G*m+I*H;v[9]=e*
L+u*c+G*t+I*B;v[10]=e*K+u*h+G*E+I*g;v[11]=e*n+u*p+G*z+I*b;v[12]=R*A+S*a+V*m+l*H;v[13]=R*L+S*c+V*t+l*B;v[14]=R*K+S*h+V*E+l*g;v[15]=R*n+S*p+V*z+l*b;return v};mat4$$module$str$c3runtime.multiplyVec3=function(b,l,v){v||(v=l);var A=l[0],L=l[1];l=l[2];v[0]=b[0]*A+b[4]*L+b[8]*l+b[12];v[1]=b[1]*A+b[5]*L+b[9]*l+b[13];v[2]=b[2]*A+b[6]*L+b[10]*l+b[14];return v};
mat4$$module$str$c3runtime.multiplyVec4=function(b,l,v){v||(v=l);var A=l[0],L=l[1],K=l[2];l=l[3];v[0]=b[0]*A+b[4]*L+b[8]*K+b[12]*l;v[1]=b[1]*A+b[5]*L+b[9]*K+b[13]*l;v[2]=b[2]*A+b[6]*L+b[10]*K+b[14]*l;v[3]=b[3]*A+b[7]*L+b[11]*K+b[15]*l;return v};
mat4$$module$str$c3runtime.translate=function(b,l,v){var A=l[0],L=l[1];l=l[2];if(!v||b===v)return b[12]=b[0]*A+b[4]*L+b[8]*l+b[12],b[13]=b[1]*A+b[5]*L+b[9]*l+b[13],b[14]=b[2]*A+b[6]*L+b[10]*l+b[14],b[15]=b[3]*A+b[7]*L+b[11]*l+b[15],b;var K=b[0];var n=b[1];var a=b[2];var c=b[3];var h=b[4];var p=b[5];var m=b[6];var t=b[7];var E=b[8];var z=b[9];var H=b[10];var B=b[11];v[0]=K;v[1]=n;v[2]=a;v[3]=c;v[4]=h;v[5]=p;v[6]=m;v[7]=t;v[8]=E;v[9]=z;v[10]=H;v[11]=B;v[12]=K*A+h*L+E*l+b[12];v[13]=n*A+p*L+z*l+b[13];
v[14]=a*A+m*L+H*l+b[14];v[15]=c*A+t*L+B*l+b[15];return v};mat4$$module$str$c3runtime.scale=function(b,l,v){var A=l[0],L=l[1];l=l[2];if(!v||b===v)return b[0]*=A,b[1]*=A,b[2]*=A,b[3]*=A,b[4]*=L,b[5]*=L,b[6]*=L,b[7]*=L,b[8]*=l,b[9]*=l,b[10]*=l,b[11]*=l,b;v[0]=b[0]*A;v[1]=b[1]*A;v[2]=b[2]*A;v[3]=b[3]*A;v[4]=b[4]*L;v[5]=b[5]*L;v[6]=b[6]*L;v[7]=b[7]*L;v[8]=b[8]*l;v[9]=b[9]*l;v[10]=b[10]*l;v[11]=b[11]*l;v[12]=b[12];v[13]=b[13];v[14]=b[14];v[15]=b[15];return v};
mat4$$module$str$c3runtime.rotate=function(b,l,v,A){var L=v[0],K=v[1];v=v[2];var n=Math.sqrt(L*L+K*K+v*v);if(!n)return null;1!==n&&(n=1/n,L*=n,K*=n,v*=n);var a=Math.sin(l);var c=Math.cos(l);var h=1-c;l=b[0];n=b[1];var p=b[2];var m=b[3];var t=b[4];var E=b[5];var z=b[6];var H=b[7];var B=b[8];var g=b[9];var r=b[10];var x=b[11];var N=L*L*h+c;var Q=K*L*h+v*a;var F=v*L*h-K*a;var d=L*K*h-v*a;var k=K*K*h+c;var C=v*K*h+L*a;var e=L*v*h+K*a;L=K*v*h-L*a;K=v*v*h+c;A?b!==A&&(A[12]=b[12],A[13]=b[13],A[14]=b[14],
A[15]=b[15]):A=b;A[0]=l*N+t*Q+B*F;A[1]=n*N+E*Q+g*F;A[2]=p*N+z*Q+r*F;A[3]=m*N+H*Q+x*F;A[4]=l*d+t*k+B*C;A[5]=n*d+E*k+g*C;A[6]=p*d+z*k+r*C;A[7]=m*d+H*k+x*C;A[8]=l*e+t*L+B*K;A[9]=n*e+E*L+g*K;A[10]=p*e+z*L+r*K;A[11]=m*e+H*L+x*K;return A};
mat4$$module$str$c3runtime.rotateX=function(b,l,v){var A=Math.sin(l);l=Math.cos(l);var L=b[4],K=b[5],n=b[6],a=b[7],c=b[8],h=b[9],p=b[10],m=b[11];v?b!==v&&(v[0]=b[0],v[1]=b[1],v[2]=b[2],v[3]=b[3],v[12]=b[12],v[13]=b[13],v[14]=b[14],v[15]=b[15]):v=b;v[4]=L*l+c*A;v[5]=K*l+h*A;v[6]=n*l+p*A;v[7]=a*l+m*A;v[8]=L*-A+c*l;v[9]=K*-A+h*l;v[10]=n*-A+p*l;v[11]=a*-A+m*l;return v};
mat4$$module$str$c3runtime.rotateY=function(b,l,v){var A=Math.sin(l);l=Math.cos(l);var L=b[0],K=b[1],n=b[2],a=b[3],c=b[8],h=b[9],p=b[10],m=b[11];v?b!==v&&(v[4]=b[4],v[5]=b[5],v[6]=b[6],v[7]=b[7],v[12]=b[12],v[13]=b[13],v[14]=b[14],v[15]=b[15]):v=b;v[0]=L*l+c*-A;v[1]=K*l+h*-A;v[2]=n*l+p*-A;v[3]=a*l+m*-A;v[8]=L*A+c*l;v[9]=K*A+h*l;v[10]=n*A+p*l;v[11]=a*A+m*l;return v};
mat4$$module$str$c3runtime.rotateZ=function(b,l,v){var A=Math.sin(l);l=Math.cos(l);var L=b[0],K=b[1],n=b[2],a=b[3],c=b[4],h=b[5],p=b[6],m=b[7];v?b!==v&&(v[8]=b[8],v[9]=b[9],v[10]=b[10],v[11]=b[11],v[12]=b[12],v[13]=b[13],v[14]=b[14],v[15]=b[15]):v=b;v[0]=L*l+c*A;v[1]=K*l+h*A;v[2]=n*l+p*A;v[3]=a*l+m*A;v[4]=L*-A+c*l;v[5]=K*-A+h*l;v[6]=n*-A+p*l;v[7]=a*-A+m*l;return v};
mat4$$module$str$c3runtime.frustum=function(b,l,v,A,L,K,n){n||(n=mat4$$module$str$c3runtime.create());var a=l-b,c=A-v,h=K-L;n[0]=2*L/a;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=2*L/c;n[6]=0;n[7]=0;n[8]=(l+b)/a;n[9]=(A+v)/c;n[10]=-(K+L)/h;n[11]=-1;n[12]=0;n[13]=0;n[14]=-(K*L*2)/h;n[15]=0;return n};mat4$$module$str$c3runtime.perspective=function(b,l,v,A,L){b=v*Math.tan(b*Math.PI/360);l*=b;return mat4$$module$str$c3runtime.frustum(-l,l,-b,b,v,A,L)};
mat4$$module$str$c3runtime.ortho=function(b,l,v,A,L,K,n){n||(n=mat4$$module$str$c3runtime.create());var a=l-b,c=A-v,h=K-L;n[0]=2/a;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=2/c;n[6]=0;n[7]=0;n[8]=0;n[9]=0;n[10]=-2/h;n[11]=0;n[12]=-(b+l)/a;n[13]=-(A+v)/c;n[14]=-(K+L)/h;n[15]=1;return n};
mat4$$module$str$c3runtime.lookAt=function(b,l,v,A){A||(A=mat4$$module$str$c3runtime.create());var L=b[0],K=b[1];b=b[2];var n=v[0];var a=v[1];var c=v[2];v=l[1];var h=l[2];if(L===l[0]&&K===v&&b===h)return mat4$$module$str$c3runtime.identity(A);v=L-l[0];h=K-l[1];var p=b-l[2];var m=1/Math.sqrt(v*v+h*h+p*p);v*=m;h*=m;p*=m;l=a*p-c*h;c=c*v-n*p;n=n*h-a*v;(m=Math.sqrt(l*l+c*c+n*n))?(m=1/m,l*=m,c*=m,n*=m):n=c=l=0;a=h*n-p*c;var t=p*l-v*n;var E=v*c-h*l;(m=Math.sqrt(a*a+t*t+E*E))?(m=1/m,a*=m,t*=m,E*=m):E=t=a=
0;A[0]=l;A[1]=a;A[2]=v;A[3]=0;A[4]=c;A[5]=t;A[6]=h;A[7]=0;A[8]=n;A[9]=E;A[10]=p;A[11]=0;A[12]=-(l*L+c*K+n*b);A[13]=-(a*L+t*K+E*b);A[14]=-(v*L+h*K+p*b);A[15]=1;return A};
mat4$$module$str$c3runtime.fromRotationTranslation=function(b,l,v){v||(v=mat4$$module$str$c3runtime.create());var A=b[0],L=b[1],K=b[2],n=b[3],a=A+A,c=L+L,h=K+K;b=A*a;var p=A*c;A*=h;var m=L*c;L*=h;K*=h;a*=n;c*=n;n*=h;v[0]=1-(m+K);v[1]=p+n;v[2]=A-c;v[3]=0;v[4]=p-n;v[5]=1-(b+K);v[6]=L+a;v[7]=0;v[8]=A+c;v[9]=L-a;v[10]=1-(b+m);v[11]=0;v[12]=l[0];v[13]=l[1];v[14]=l[2];v[15]=1;return v};
mat4$$module$str$c3runtime.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+"]"};quat4$$module$str$c3runtime.create=function(b){var l=new MatrixArray$$module$str$c3runtime(4);b&&(l[0]=b[0],l[1]=b[1],l[2]=b[2],l[3]=b[3]);return l};quat4$$module$str$c3runtime.set=function(b,l){l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=b[3];return l};
quat4$$module$str$c3runtime.calculateW=function(b,l){var v=b[0],A=b[1],L=b[2];if(!l||b===l)return b[3]=-Math.sqrt(Math.abs(1-v*v-A*A-L*L)),b;l[0]=v;l[1]=A;l[2]=L;l[3]=-Math.sqrt(Math.abs(1-v*v-A*A-L*L));return l};quat4$$module$str$c3runtime.inverse=function(b,l){if(!l||b===l)return b[0]*=-1,b[1]*=-1,b[2]*=-1,b;l[0]=-b[0];l[1]=-b[1];l[2]=-b[2];l[3]=b[3];return l};quat4$$module$str$c3runtime.length=function(b){var l=b[0],v=b[1],A=b[2];b=b[3];return Math.sqrt(l*l+v*v+A*A+b*b)};
quat4$$module$str$c3runtime.normalize=function(b,l){l||(l=b);var v=b[0],A=b[1],L=b[2];b=b[3];var K=Math.sqrt(v*v+A*A+L*L+b*b);if(0===K)return l[0]=0,l[1]=0,l[2]=0,l[3]=0,l;K=1/K;l[0]=v*K;l[1]=A*K;l[2]=L*K;l[3]=b*K;return l};quat4$$module$str$c3runtime.multiply=function(b,l,v){v||(v=b);var A=b[0],L=b[1],K=b[2];b=b[3];var n=l[0],a=l[1],c=l[2];l=l[3];v[0]=A*l+b*n+L*c-K*a;v[1]=L*l+b*a+K*n-A*c;v[2]=K*l+b*c+A*a-L*n;v[3]=b*l-A*n-L*a-K*c;return v};
quat4$$module$str$c3runtime.multiplyVec3=function(b,l,v){v||(v=l);var A=l[0],L=l[1],K=l[2];l=b[0];var n=b[1],a=b[2];b=b[3];var c=b*A+n*K-a*L,h=b*L+a*A-l*K,p=b*K+l*L-n*A;A=-l*A-n*L-a*K;v[0]=c*b+A*-l+h*-a-p*-n;v[1]=h*b+A*-n+p*-l-c*-a;v[2]=p*b+A*-a+c*-n-h*-l;return v};
quat4$$module$str$c3runtime.toMat3=function(b,l){l||(l=mat3$$module$str$c3runtime.create());var v=b[0],A=b[1],L=b[2];b=b[3];var K=v+v,n=A+A,a=L+L,c=v*K,h=v*n;v*=a;var p=A*n;A*=a;L*=a;K*=b;n*=b;b*=a;l[0]=1-(p+L);l[1]=h+b;l[2]=v-n;l[3]=h-b;l[4]=1-(c+L);l[5]=A+K;l[6]=v+n;l[7]=A-K;l[8]=1-(c+p);return l};
quat4$$module$str$c3runtime.toMat4=function(b,l){l||(l=mat4$$module$str$c3runtime.create());var v=b[0],A=b[1],L=b[2];b=b[3];var K=v+v,n=A+A,a=L+L,c=v*K,h=v*n;v*=a;var p=A*n;A*=a;L*=a;K*=b;n*=b;b*=a;l[0]=1-(p+L);l[1]=h+b;l[2]=v-n;l[3]=0;l[4]=h-b;l[5]=1-(c+L);l[6]=A+K;l[7]=0;l[8]=v+n;l[9]=A-K;l[10]=1-(c+p);l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l};
quat4$$module$str$c3runtime.slerp=function(b,l,v,A){A||(A=b);var L=b[0]*l[0]+b[1]*l[1]+b[2]*l[2]+b[3]*l[3];if(1<=Math.abs(L))return A!==b&&(A[0]=b[0],A[1]=b[1],A[2]=b[2],A[3]=b[3]),A;var K=Math.acos(L);var n=Math.sqrt(1-L*L);if(.001>Math.abs(n))return A[0]=.5*b[0]+.5*l[0],A[1]=.5*b[1]+.5*l[1],A[2]=.5*b[2]+.5*l[2],A[3]=.5*b[3]+.5*l[3],A;L=Math.sin((1-v)*K)/n;v=Math.sin(v*K)/n;A[0]=b[0]*L+l[0]*v;A[1]=b[1]*L+l[1]*v;A[2]=b[2]*L+l[2]*v;A[3]=b[3]*L+l[3]*v;return A};
quat4$$module$str$c3runtime.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"};
(function(){function b(a,c,h){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent);this.height=this.width=0;this.enableFrontToBack=!!h;this.isBatchInEarlyZPass=this.isEarlyZPass=!1;this.currentZ=0;this.zNear=1;this.zFar=1E3;this.zIncrement=(this.zFar-this.zNear)/32768;this.zA=this.zFar/(this.zFar-this.zNear);this.zB=this.zFar*this.zNear/(this.zNear-this.zFar);this.kzA=65536*this.zA;this.kzB=65536*this.zB;this.cam=vec3$$module$str$c3runtime.create([0,0,100]);this.look=
vec3$$module$str$c3runtime.create([0,0,0]);this.up=vec3$$module$str$c3runtime.create([0,1,0]);this.worldScale=vec3$$module$str$c3runtime.create([1,1,1]);this.enable_mipmaps=!0;this.matP=mat4$$module$str$c3runtime.create();this.matMV=mat4$$module$str$c3runtime.create();this.lastMV=mat4$$module$str$c3runtime.create();this.currentMV=mat4$$module$str$c3runtime.create();this.gl=a;this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1;this.timerExt=null;this.isTiming=!1;this.timerExt=
2===this.version?this.gl.getExtension("EXT_disjoint_timer_query_webgl2")||this.gl.getExtension("EXT_disjoint_timer_query"):this.gl.getExtension("EXT_disjoint_timer_query");this.frameNumber=0;this.timerResults=[];this.initState()}function l(a,c,h){this.gl=a;this.shaderProgram=c;this.name=h;this.locAPos=a.getAttribLocation(c,"aPos");this.locATex=a.getAttribLocation(c,"aTex");this.locMatP=a.getUniformLocation(c,"matP");this.locMatMV=a.getUniformLocation(c,"matMV");this.locOpacity=a.getUniformLocation(c,
"opacity");this.locColorFill=a.getUniformLocation(c,"colorFill");this.locSamplerFront=a.getUniformLocation(c,"samplerFront");this.locSamplerBack=a.getUniformLocation(c,"samplerBack");this.locSrcStart=a.getUniformLocation(c,"srcStart");this.locSrcEnd=a.getUniformLocation(c,"srcEnd");this.locSrcOriginStart=a.getUniformLocation(c,"srcOriginStart");this.locSrcOriginEnd=a.getUniformLocation(c,"srcOriginEnd");this.locLayoutStart=a.getUniformLocation(c,"layoutStart");this.locLayoutEnd=a.getUniformLocation(c,
"layoutEnd");this.locDestStart=a.getUniformLocation(c,"destStart");this.locDestEnd=a.getUniformLocation(c,"destEnd");this.locSeconds=a.getUniformLocation(c,"seconds");this.locPixelSize=a.getUniformLocation(c,"pixelSize");this.locLayerScale=a.getUniformLocation(c,"layerScale");this.locLayerAngle=a.getUniformLocation(c,"layerAngle");this.hasAnyOptionalUniforms=!!(this.locPixelSize||this.locSeconds||this.locSamplerBack||this.locSrcStart||this.locSrcEnd||this.locSrcOriginStart||this.locSrcOriginEnd||
this.locLayoutStart||this.locLayoutEnd||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle);this.lpPixelHeight=this.lpPixelWidth=-999;this.lpOpacity=1;this.lpDestStartY=this.lpDestStartX=this.lpLayoutEndY=this.lpLayoutEndX=this.lpLayoutStartY=this.lpLayoutStartX=this.lpSrcOriginEndY=this.lpSrcOriginEndX=this.lpSrcOriginStartY=this.lpSrcOriginStartX=this.lpSrcEndY=this.lpSrcEndX=this.lpSrcStartY=this.lpSrcStartX=0;this.lpLayerScale=this.lpDestEndY=this.lpDestEndX=1;this.lpSeconds=
this.lpLayerAngle=0;this.lastCustomParams=[];this.lpMatMV=mat4$$module$str$c3runtime.create();this.locOpacity&&a.uniform1f(this.locOpacity,1);this.locColorFill&&a.uniform4f(this.locColorFill,1,1,1,1);this.locSamplerFront&&a.uniform1i(this.locSamplerFront,0);this.locSamplerBack&&a.uniform1i(this.locSamplerBack,1);this.locSrcStart&&a.uniform2f(this.locSrcStart,0,0);this.locSrcEnd&&a.uniform2f(this.locSrcEnd,1,1);this.locSrcOriginStart&&a.uniform2f(this.locSrcOriginStart,0,0);this.locSrcOriginEnd&&a.uniform2f(this.locSrcOriginEnd,
0,0);this.locLayoutStart&&a.uniform2f(this.locLayoutStart,0,0);this.locLayoutEnd&&a.uniform2f(this.locLayoutEnd,0,0);this.locDestStart&&a.uniform2f(this.locDestStart,0,0);this.locDestEnd&&a.uniform2f(this.locDestEnd,1,1);this.locLayerScale&&a.uniform1f(this.locLayerScale,1);this.locLayerAngle&&a.uniform1f(this.locLayerAngle,0);this.locSeconds&&a.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function v(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&
a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]}function A(a,c){this.type=a;this.glwrap=c;this.gl=c.gl;this.indexCount=this.startIndex=this.opacityParam=0;this.mat4param=this.texParam=null;this.layoutRect=quat4$$module$str$c3runtime.create();this.srcOriginRect=quat4$$module$str$c3runtime.create();this.shaderParams=[];cr$$module$str$c3runtime.seal(this)}var L=mat4$$module$str$c3runtime.create();b.prototype.initState=
function(){var a=this.gl,c;this.lastOpacity=1;this.lastTexture1=this.lastTexture0=null;this.currentOpacity=1;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);a.disable(a.CULL_FACE);a.disable(a.STENCIL_TEST);a.disable(a.DITHER);this.enableFrontToBack?(a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST);this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this.lastSrcBlend=a.ONE;this.lastDestBlend=a.ONE_MINUS_SRC_ALPHA;
this.vertexData=new Float32Array(8E3*(this.enableFrontToBack?3:2));this.texcoordData=new Float32Array(16E3);this.pointData=new Float32Array(32E3);this.pointBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer);a.bufferData(a.ARRAY_BUFFER,this.pointData.byteLength,a.DYNAMIC_DRAW);this.vertexBuffers=Array(4);this.texcoordBuffers=Array(4);for(c=0;4>c;c++)this.vertexBuffers[c]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[c]),a.bufferData(a.ARRAY_BUFFER,this.vertexData.byteLength,
a.DYNAMIC_DRAW),this.texcoordBuffers[c]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[c]),a.bufferData(a.ARRAY_BUFFER,this.texcoordData.byteLength,a.DYNAMIC_DRAW);this.curBuffer=0;this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var h=new Uint16Array(12E3),p=c=0;12E3>c;)h[c++]=p,h[c++]=p+1,h[c++]=p+2,h[c++]=p,h[c++]=p+2,h[c++]=p+3,p+=4;a.bufferData(a.ELEMENT_ARRAY_BUFFER,h,a.STATIC_DRAW);this.pointPtr=this.texPtr=this.vertexPtr=0;this.shaderPrograms=
[];c=this.enableFrontToBack?"attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}":"attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";
h=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}"},c,"<default>");this.shaderPrograms.push(h);h=this.createShaderProgram({src:"uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}"},"attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}",
"<point>");this.shaderPrograms.push(h);h=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}"},c,"<earlyz>");this.shaderPrograms.push(h);h=this.createShaderProgram({src:"uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}"},c,"<fill>");this.shaderPrograms.push(h);for(var m in cr$$module$str$c3runtime.shaders)cr$$module$str$c3runtime.shaders.hasOwnProperty(m)&&
this.shaderPrograms.push(this.createShaderProgram(cr$$module$str$c3runtime.shaders[m],c,m));a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,null);this.batch=[];this.batchPtr=0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.currentProgram=this.lastProgram=-1;this.currentShader=null;this.fbo=a.createFramebuffer();this.depthBuffer=this.renderToTex=null;this.attachedDepthBuffer=!1;this.enableFrontToBack&&(this.depthBuffer=a.createRenderbuffer());this.tmpVec3=vec3$$module$str$c3runtime.create([0,
0,0]);a=a.getParameter(a.ALIASED_POINT_SIZE_RANGE);this.minPointSize=a[0];this.maxPointSize=a[1];2048<this.maxPointSize&&(this.maxPointSize=2048);this.switchProgram(0);cr$$module$str$c3runtime.seal(this)};l.prototype.updateMatMV=function(a){v(this.lpMatMV,a)||(mat4$$module$str$c3runtime.set(a,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,a))};b.prototype.createShaderProgram=function(a,c,h){var p=this.gl,m=p.createShader(p.FRAGMENT_SHADER);p.shaderSource(m,a.src);p.compileShader(m);if(!p.getShaderParameter(m,
p.COMPILE_STATUS))throw a=p.getShaderInfoLog(m),p.deleteShader(m),Error("error compiling fragment shader: "+a);var t=p.createShader(p.VERTEX_SHADER);p.shaderSource(t,c);p.compileShader(t);if(!p.getShaderParameter(t,p.COMPILE_STATUS))throw a=p.getShaderInfoLog(t),p.deleteShader(m),p.deleteShader(t),Error("error compiling vertex shader: "+a);c=p.createProgram();p.attachShader(c,m);p.attachShader(c,t);p.linkProgram(c);if(!p.getProgramParameter(c,p.LINK_STATUS))throw a=p.getProgramInfoLog(c),p.deleteShader(m),
p.deleteShader(t),p.deleteProgram(c),Error("error linking shader program: "+a);p.useProgram(c);p.deleteShader(m);p.deleteShader(t);m=new l(p,c,h);m.extendBoxHorizontal=a.extendBoxHorizontal||0;m.extendBoxVertical=a.extendBoxVertical||0;m.crossSampling=!!a.crossSampling;m.preservesOpaqueness=!!a.preservesOpaqueness;m.animated=!!a.animated;m.parameters=a.parameters||[];a=0;for(t=m.parameters.length;a<t;a++)m.parameters[a][1]=p.getUniformLocation(c,m.parameters[a][0]),m.lastCustomParams.push(0);cr$$module$str$c3runtime.seal(m);
return m};b.prototype.getShaderIndex=function(a){var c;var h=0;for(c=this.shaderPrograms.length;h<c;h++)if(this.shaderPrograms[h].name===a)return h;return-1};b.prototype.project=function(a,c,h){var p=this.matMV,m=this.matP,t=[0,0,0,0,0,0,0,0];t[0]=p[0]*a+p[4]*c+p[12];t[1]=p[1]*a+p[5]*c+p[13];t[2]=p[2]*a+p[6]*c+p[14];t[3]=p[3]*a+p[7]*c+p[15];t[4]=m[0]*t[0]+m[4]*t[1]+m[8]*t[2]+m[12]*t[3];t[5]=m[1]*t[0]+m[5]*t[1]+m[9]*t[2]+m[13]*t[3];t[6]=m[2]*t[0]+m[6]*t[1]+m[10]*t[2]+m[14]*t[3];t[7]=-t[2];0!==t[7]&&
(t[7]=1/t[7],t[4]*=t[7],t[5]*=t[7],t[6]*=t[7],h[0]=(.5*t[4]+.5)*this.width,h[1]=(.5*t[5]+.5)*this.height)};b.prototype.setSize=function(a,c,h){if(this.width!==a||this.height!==c||h){this.endBatch();h=this.gl;this.width=a;this.height=c;h.viewport(0,0,a,c);mat4$$module$str$c3runtime.lookAt(this.cam,this.look,this.up,this.matMV);this.enableFrontToBack?(mat4$$module$str$c3runtime.ortho(-a/2,a/2,c/2,-c/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1):(mat4$$module$str$c3runtime.perspective(45,
a/c,this.zNear,this.zFar,this.matP),a=[0,0],c=[0,0],this.project(0,0,a),this.project(1,1,c),this.worldScale[0]=1/(c[0]-a[0]),this.worldScale[1]=-1/(c[1]-a[1]));a=0;for(c=this.shaderPrograms.length;a<c;a++){var p=this.shaderPrograms[a];p.hasCurrentMatMV=!1;p.locMatP&&(h.useProgram(p.shaderProgram),h.uniformMatrix4fv(p.locMatP,!1,this.matP))}h.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram);h.bindTexture(h.TEXTURE_2D,null);h.activeTexture(h.TEXTURE1);h.bindTexture(h.TEXTURE_2D,null);
h.activeTexture(h.TEXTURE0);this.lastTexture1=this.lastTexture0=null;this.depthBuffer&&(h.bindFramebuffer(h.FRAMEBUFFER,this.fbo),h.bindRenderbuffer(h.RENDERBUFFER,this.depthBuffer),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=!0),h.bindRenderbuffer(h.RENDERBUFFER,null),h.bindFramebuffer(h.FRAMEBUFFER,null),this.renderToTex=
null)}};b.prototype.resetModelView=function(){mat4$$module$str$c3runtime.lookAt(this.cam,this.look,this.up,this.matMV);mat4$$module$str$c3runtime.scale(this.matMV,this.worldScale)};b.prototype.translate=function(a,c){if(0!==a||0!==c)this.tmpVec3[0]=a,this.tmpVec3[1]=c,this.tmpVec3[2]=0,mat4$$module$str$c3runtime.translate(this.matMV,this.tmpVec3)};b.prototype.scale=function(a,c){if(1!==a||1!==c)this.tmpVec3[0]=a,this.tmpVec3[1]=c,this.tmpVec3[2]=1,mat4$$module$str$c3runtime.scale(this.matMV,this.tmpVec3)};
b.prototype.rotateZ=function(a){0!==a&&mat4$$module$str$c3runtime.rotateZ(this.matMV,a)};b.prototype.updateModelView=function(){if(!v(this.lastMV,this.matMV)){var a=this.pushBatch();a.type=5;a.mat4param?mat4$$module$str$c3runtime.set(this.matMV,a.mat4param):a.mat4param=mat4$$module$str$c3runtime.create(this.matMV);mat4$$module$str$c3runtime.set(this.matMV,this.lastMV);this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setEarlyZIndex=function(a){this.enableFrontToBack&&(32760<a&&(a=32760),
this.currentZ=this.cam[2]-this.zNear-a*this.zIncrement)};A.prototype.doSetEarlyZPass=function(){var a=this.gl,c=this.glwrap;0!==this.startIndex?(a.depthMask(!0),a.colorMask(!1,!1,!1,!1),a.disable(a.BLEND),a.bindFramebuffer(a.FRAMEBUFFER,c.fbo),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.clear(a.DEPTH_BUFFER_BIT),a.bindFramebuffer(a.FRAMEBUFFER,null),c.isBatchInEarlyZPass=!0):(a.depthMask(!1),a.colorMask(!0,!0,!0,!0),a.enable(a.BLEND),c.isBatchInEarlyZPass=!1)};
A.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)};A.prototype.doSetTexture1=function(){var a=this.gl;a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,this.texParam);a.activeTexture(a.TEXTURE0)};A.prototype.doSetOpacity=function(){var a=this.opacityParam,c=this.glwrap;c.currentOpacity=a;c=c.currentShader;c.locOpacity&&c.lpOpacity!==a&&(c.lpOpacity=a,this.gl.uniform1f(c.locOpacity,a))};A.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,
this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)};A.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,this.indexCount)};A.prototype.doUpdateModelView=function(){var a,c=this.glwrap.shaderPrograms,h=this.glwrap.currentProgram;var p=0;for(a=c.length;p<a;p++){var m=c[p];p===h&&m.locMatMV?(m.updateMatMV(this.mat4param),m.hasCurrentMatMV=!0):m.hasCurrentMatMV=!1}mat4$$module$str$c3runtime.set(this.mat4param,this.glwrap.currentMV)};A.prototype.doRenderToTexture=function(){var a=this.gl,
c=this.glwrap;this.texParam?(c.lastTexture1===this.texParam&&(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,null),c.lastTexture1=null,a.activeTexture(a.TEXTURE0)),a.bindFramebuffer(a.FRAMEBUFFER,c.fbo),c.isBatchInEarlyZPass||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texParam,0)):(c.enableFrontToBack||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.bindFramebuffer(a.FRAMEBUFFER,null))};A.prototype.doClear=function(){var a=this.gl,
c=this.startIndex;0===c?(a.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clear(a.COLOR_BUFFER_BIT)):1===c?(a.enable(a.SCISSOR_TEST),a.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.SCISSOR_TEST)):a.clear(a.DEPTH_BUFFER_BIT)};A.prototype.doSetDepthTestEnabled=function(){var a=this.gl;0!==this.startIndex?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST)};A.prototype.doPoints=
function(){var a=this.gl,c=this.glwrap;c.enableFrontToBack&&a.disable(a.DEPTH_TEST);var h=c.shaderPrograms[1];a.useProgram(h.shaderProgram);!h.hasCurrentMatMV&&h.locMatMV&&(h.updateMatMV(c.currentMV),h.hasCurrentMatMV=!0);a.enableVertexAttribArray(h.locAPos);a.bindBuffer(a.ARRAY_BUFFER,c.pointBuffer);a.vertexAttribPointer(h.locAPos,4,a.FLOAT,!1,0,0);a.drawArrays(a.POINTS,this.startIndex/4,this.indexCount);h=c.currentShader;a.useProgram(h.shaderProgram);0<=h.locAPos&&(a.enableVertexAttribArray(h.locAPos),
a.bindBuffer(a.ARRAY_BUFFER,c.vertexBuffers[c.curBuffer]),a.vertexAttribPointer(h.locAPos,c.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=h.locATex&&(a.enableVertexAttribArray(h.locATex),a.bindBuffer(a.ARRAY_BUFFER,c.texcoordBuffers[c.curBuffer]),a.vertexAttribPointer(h.locATex,2,a.FLOAT,!1,0,0));c.enableFrontToBack&&a.enable(a.DEPTH_TEST)};A.prototype.doSetProgram=function(){var a=this.gl,c=this.glwrap,h=c.shaderPrograms[this.startIndex];c.currentProgram=this.startIndex;c.currentShader=h;a.useProgram(h.shaderProgram);
!h.hasCurrentMatMV&&h.locMatMV&&(h.updateMatMV(c.currentMV),h.hasCurrentMatMV=!0);h.locOpacity&&h.lpOpacity!==c.currentOpacity&&(h.lpOpacity=c.currentOpacity,a.uniform1f(h.locOpacity,c.currentOpacity));0<=h.locAPos&&(a.enableVertexAttribArray(h.locAPos),a.bindBuffer(a.ARRAY_BUFFER,c.vertexBuffers[c.curBuffer]),a.vertexAttribPointer(h.locAPos,c.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=h.locATex&&(a.enableVertexAttribArray(h.locATex),a.bindBuffer(a.ARRAY_BUFFER,c.texcoordBuffers[c.curBuffer]),a.vertexAttribPointer(h.locATex,
2,a.FLOAT,!1,0,0))};A.prototype.doSetColor=function(){var a=this.mat4param;this.gl.uniform4f(this.glwrap.currentShader.locColorFill,a[0],a[1],a[2],a[3])};A.prototype.doSetProgramParameters=function(){var a=this.glwrap.currentShader,c=this.gl;var h=this.mat4param;var p=this.layoutRect;var m=this.srcOriginRect;a.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,c.activeTexture(c.TEXTURE0));
var t=h[0],E=h[1];!a.locPixelSize||t===a.lpPixelWidth&&E===a.lpPixelHeight||(a.lpPixelWidth=t,a.lpPixelHeight=E,c.uniform2f(a.locPixelSize,t,E));t=h[2];E=h[3];!a.locDestStart||t===a.lpDestStartX&&E===a.lpDestStartY||(a.lpDestStartX=t,a.lpDestStartY=E,c.uniform2f(a.locDestStart,t,E));t=h[4];E=h[5];!a.locDestEnd||t===a.lpDestEndX&&E===a.lpDestEndY||(a.lpDestEndX=t,a.lpDestEndY=E,c.uniform2f(a.locDestEnd,t,E));t=h[6];a.locLayerScale&&t!==a.lpLayerScale&&(a.lpLayerScale=t,c.uniform1f(a.locLayerScale,
t));t=h[7];a.locLayerAngle&&t!==a.lpLayerAngle&&(a.lpLayerAngle=t,c.uniform1f(a.locLayerAngle,t));t=h[12];E=h[13];!a.locSrcStart||t===a.lpSrcStartX&&E===a.lpSrcStartY||(a.lpSrcStartX=t,a.lpSrcStartY=E,c.uniform2f(a.locSrcStart,t,E));t=h[14];E=h[15];!a.locSrcEnd||t===a.lpSrcEndX&&E===a.lpSrcEndY||(a.lpSrcEndX=t,a.lpSrcEndY=E,c.uniform2f(a.locSrcEnd,t,E));t=m[0];E=m[1];!a.locSrcOriginStart||t===a.lpSrcOriginStartX&&E===a.lpSrcOriginStartY||(a.lpSrcOriginStartX=t,a.lpSrcOriginStartY=E,c.uniform2f(a.locSrcOriginStart,
t,E));t=m[2];E=m[3];!a.locSrcOriginEnd||t===a.lpSrcOriginEndX&&E===a.lpSrcOriginEndY||(a.lpSrcOriginEndX=t,a.lpSrcOriginEndY=E,c.uniform2f(a.locSrcOriginEnd,t,E));t=p[0];E=p[1];!a.locLayoutStart||t===a.lpLayoutStartX&&E===a.lpLayoutStartY||(a.lpLayoutStartX=t,a.lpLayoutStartY=E,c.uniform2f(a.locLayoutStart,t,E));t=p[2];E=p[3];!a.locLayoutEnd||t===a.lpLayoutEndX&&E===a.lpLayoutEndY||(a.lpLayoutEndX=t,a.lpLayoutEndY=E,c.uniform2f(a.locLayoutEnd,t,E));t=this.startIndex;a.locSeconds&&t!==a.lpSeconds&&
(a.lpSeconds=t,c.uniform1f(a.locSeconds,t));if(a.parameters.length)for(h=0,p=a.parameters.length;h<p;h++)t=this.shaderParams[h],Array.isArray(t)?c.uniform3fv(a.parameters[h][1],t):t!==a.lastCustomParams[h]&&(a.lastCustomParams[h]=t,c.uniform1f(a.parameters[h][1],t))};b.prototype.pushBatch=function(){this.batchPtr===this.batch.length&&this.batch.push(new A(0,this));return this.batch[this.batchPtr++]};b.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){this.maybeStartTiming();
var a=this.gl;0<this.pointPtr&&(a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),c&&0<=c.locAPos&&"<point>"===c.name&&a.vertexAttribPointer(c.locAPos,4,a.FLOAT,!1,0,0));if(0<this.vertexPtr){var c=this.currentShader;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexData.subarray(0,this.vertexPtr));c&&0<=c.locAPos&&"<point>"!==c.name&&a.vertexAttribPointer(c.locAPos,this.enableFrontToBack?
3:2,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr));c&&0<=c.locATex&&"<point>"!==c.name&&a.vertexAttribPointer(c.locATex,2,a.FLOAT,!1,0,0)}a=0;for(c=this.batchPtr;a<c;a++){var h=this.batch[a];switch(h.type){case 1:h.doQuad();break;case 2:h.doSetTexture();break;case 3:h.doSetOpacity();break;case 4:h.doSetBlend();break;case 5:h.doUpdateModelView();break;case 6:h.doRenderToTexture();break;case 7:h.doClear();
break;case 8:h.doPoints();break;case 9:h.doSetProgram();break;case 10:h.doSetProgramParameters();break;case 11:h.doSetTexture1();break;case 12:h.doSetColor();break;case 13:h.doSetDepthTestEnabled();break;case 14:h.doSetEarlyZPass()}}this.pointPtr=this.texPtr=this.vertexPtr=this.batchPtr=0;this.isBatchInEarlyZPass=this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.curBuffer++;4<=this.curBuffer&&(this.curBuffer=0)}};b.prototype.maybeStartTiming=function(){if(!this.isTiming&&this.timerExt){this.isTiming=
!0;var a={frameNumber:this.frameNumber,query:null,result:0};2===this.version?(a.query=this.gl.createQuery(),this.gl.beginQuery(this.timerExt.TIME_ELAPSED_EXT,a.query)):(a.query=this.timerExt.createQueryEXT(),this.timerExt.beginQueryEXT(this.timerExt.TIME_ELAPSED_EXT,a.query));this.timerResults.push(a);1E3<this.timerResults.length&&(a=this.timerResults.shift(),a.query&&(2===this.version?this.gl.deleteQuery(a.query):this.timerExt.deleteQueryEXT(a.query)))}};b.prototype.maybeFinishTiming=function(){this.isTiming&&
this.timerResults.length&&(2===this.version?this.gl.endQuery(this.timerExt.TIME_ELAPSED_EXT):this.timerExt.endQueryEXT(this.timerExt.TIME_ELAPSED_EXT),this.isTiming=!1)};b.prototype.checkForTimerResults=function(a){var c;var h=0;for(c=this.timerResults.length;h<c;++h){var p=this.timerResults[h];if(p.frameNumber>=a)break;if(p.query){var m=2===this.version?this.gl.getQueryParameter(p.query,this.gl.QUERY_RESULT_AVAILABLE):this.timerExt.getQueryObjectEXT(p.query,this.timerExt.QUERY_RESULT_AVAILABLE_EXT);
var t=this.gl.getParameter(this.timerExt.GPU_DISJOINT_EXT);m&&!t&&(p.result=2===this.version?this.gl.getQueryParameter(p.query,this.gl.QUERY_RESULT):this.timerExt.getQueryObjectEXT(p.query,this.timerExt.QUERY_RESULT_EXT),p.result/=1E9);if(m||t)2===this.version?this.gl.deleteQuery(p.query):this.timerExt.deleteQueryEXT(p.query),p.query=null}}};b.prototype.getFrameRangeTimerResults=function(a,c){if(c<=a)return-1;var h,p=0,m=0;var t=0;for(h=this.timerResults.length;t<h;++t){var E=this.timerResults[t];
if(E.frameNumber>=c)break;if(E.frameNumber>=a){if(E.query)return-1;p+=E.result;m++}}return m<c-a?-1:p};b.prototype.deleteTimerResultsToFrame=function(a){var c;var h=0;for(c=this.timerResults.length;h<c;++h){var p=this.timerResults[h];if(p.frameNumber>=a){0<h&&this.timerResults.splice(0,h);break}}};b.prototype.setOpacity=function(a){if(a!==this.lastOpacity&&!this.isEarlyZPass){var c=this.pushBatch();c.type=3;this.lastOpacity=c.opacityParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setTexture=
function(a){if(a!==this.lastTexture0){var c=this.pushBatch();c.type=2;this.lastTexture0=c.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setBlend=function(a,c){if((a!==this.lastSrcBlend||c!==this.lastDestBlend)&&!this.isEarlyZPass){var h=this.pushBatch();h.type=4;h.startIndex=a;h.indexCount=c;this.lastSrcBlend=a;this.lastDestBlend=c;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===
this.gl.ONE_MINUS_SRC_ALPHA};b.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)};b.prototype.setNoPremultiplyAlphaBlend=function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};b.prototype.quad=function(a,c,h,p,m,t,E,z){15992<=this.vertexPtr&&this.endBatch();var H=this.vertexPtr,B=this.texPtr,g=this.vertexData,r=this.texcoordData,x=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var N=this.pushBatch();N.type=
1;N.startIndex=this.enableFrontToBack?H:H/2*3;N.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(g[H++]=a,g[H++]=c,g[H++]=x,g[H++]=h,g[H++]=p,g[H++]=x,g[H++]=m,g[H++]=t,g[H++]=x,g[H++]=E,g[H++]=z,g[H++]=x):(g[H++]=a,g[H++]=c,g[H++]=h,g[H++]=p,g[H++]=m,g[H++]=t,g[H++]=E,g[H++]=z);r[B++]=0;r[B++]=0;r[B++]=1;r[B++]=0;r[B++]=1;r[B++]=1;r[B++]=0;r[B++]=1;this.vertexPtr=H;this.texPtr=B};b.prototype.quadTex=function(a,c,h,p,m,t,E,z,H){15992<=this.vertexPtr&&this.endBatch();
var B=this.vertexPtr,g=this.texPtr,r=this.vertexData,x=this.texcoordData,N=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var Q=this.pushBatch();Q.type=1;Q.startIndex=this.enableFrontToBack?B:B/2*3;Q.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}Q=H.left;var F=H.top,d=H.right;H=H.bottom;this.enableFrontToBack?(r[B++]=a,r[B++]=c,r[B++]=N,r[B++]=h,r[B++]=p,r[B++]=N,r[B++]=m,r[B++]=t,r[B++]=N,r[B++]=E,r[B++]=z,r[B++]=N):(r[B++]=a,r[B++]=c,r[B++]=
h,r[B++]=p,r[B++]=m,r[B++]=t,r[B++]=E,r[B++]=z);x[g++]=Q;x[g++]=F;x[g++]=d;x[g++]=F;x[g++]=d;x[g++]=H;x[g++]=Q;x[g++]=H;this.vertexPtr=B;this.texPtr=g};b.prototype.quadTexUV=function(a,c,h,p,m,t,E,z,H,B,g,r,x,N,Q,F){15992<=this.vertexPtr&&this.endBatch();var d=this.vertexPtr,k=this.texPtr,C=this.vertexData,e=this.texcoordData,u=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var G=this.pushBatch();G.type=1;G.startIndex=this.enableFrontToBack?d:d/2*3;G.indexCount=
6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(C[d++]=a,C[d++]=c,C[d++]=u,C[d++]=h,C[d++]=p,C[d++]=u,C[d++]=m,C[d++]=t,C[d++]=u,C[d++]=E,C[d++]=z,C[d++]=u):(C[d++]=a,C[d++]=c,C[d++]=h,C[d++]=p,C[d++]=m,C[d++]=t,C[d++]=E,C[d++]=z);e[k++]=H;e[k++]=B;e[k++]=g;e[k++]=r;e[k++]=x;e[k++]=N;e[k++]=Q;e[k++]=F;this.vertexPtr=d;this.texPtr=k};b.prototype.convexPoly=function(a){var c=a.length/2-2,h=c-1,p=a[0],m=a[1],t;for(t=0;t<c;t+=2){var E=2*t;var z=a[E+2];var H=a[E+3];var B=a[E+
4];var g=a[E+5];if(t===h)this.quad(p,m,z,H,B,g,B,g);else{var r=a[E+6];E=a[E+7];this.quad(p,m,z,H,B,g,r,E)}}};b.prototype.point=function(a,c,h,p){7996<=this.pointPtr&&this.endBatch();var m=this.pointPtr,t=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var E=this.pushBatch();E.type=8;E.startIndex=m;E.indexCount=1;this.hasPointBatchTop=!0;this.hasQuadBatchTop=!1}t[m++]=a;t[m++]=c;t[m++]=h;t[m++]=p;this.pointPtr=m};b.prototype.switchProgram=function(a){if(this.lastProgram!==
a){if(!this.shaderPrograms[a]){if(0===this.lastProgram)return;a=0}var c=this.pushBatch();c.type=9;this.lastProgram=c.startIndex=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.programUsesDest=function(a){a=this.shaderPrograms[a];return!(!a.locDestStart&&!a.locDestEnd)};b.prototype.programUsesCrossSampling=function(a){a=this.shaderPrograms[a];return!!(a.locDestStart||a.locDestEnd||a.crossSampling)};b.prototype.programPreservesOpaqueness=function(a){return this.shaderPrograms[a].preservesOpaqueness};
b.prototype.programExtendsBox=function(a){a=this.shaderPrograms[a];return 0!==a.extendBoxHorizontal||0!==a.extendBoxVertical};b.prototype.getProgramBoxExtendHorizontal=function(a){return this.shaderPrograms[a].extendBoxHorizontal};b.prototype.getProgramBoxExtendVertical=function(a){return this.shaderPrograms[a].extendBoxVertical};b.prototype.getProgramParameterType=function(a,c){return this.shaderPrograms[a].parameters[c][2]};b.prototype.programIsAnimated=function(a){return this.shaderPrograms[a].animated};
b.prototype.setProgramParameters=function(a,c,h,p,m,t,E,z,H,B,g,r,x,N,Q,F,d,k,C,e,u,G,I){var R=this.shaderPrograms[this.lastProgram];if(R.hasAnyOptionalUniforms||I.length){var S=this.pushBatch();S.type=10;S.mat4param?mat4$$module$str$c3runtime.set(this.matMV,S.mat4param):S.mat4param=mat4$$module$str$c3runtime.create();var V=S.mat4param;V[0]=c;V[1]=h;V[2]=F;V[3]=d;V[4]=k;V[5]=C;V[6]=e;V[7]=u;V[12]=p;V[13]=m;V[14]=t;V[15]=E;c=S.srcOriginRect;c[0]=z;c[1]=H;c[2]=B;c[3]=g;z=S.layoutRect;z[0]=r;z[1]=Q;
z[2]=N;z[3]=x;S.startIndex=G;S.texParam=R.locSamplerBack?a:null;if(I.length)for(x=S.shaderParams,x.length=I.length,a=0,r=I.length;a<r;a++)x[a]=I[a];this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.clear=function(a,c,h,p){var m=this.pushBatch();m.type=7;m.startIndex=0;m.mat4param||(m.mat4param=mat4$$module$str$c3runtime.create());m.mat4param[0]=a;m.mat4param[1]=c;m.mat4param[2]=h;m.mat4param[3]=p;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.clearRect=function(a,c,h,p){if(!(0>
h||0>p)){var m=this.pushBatch();m.type=7;m.startIndex=1;m.mat4param||(m.mat4param=mat4$$module$str$c3runtime.create());m.mat4param[0]=a;m.mat4param[1]=c;m.mat4param[2]=h;m.mat4param[3]=p;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.clearDepth=function(){var a=this.pushBatch();a.type=7;a.startIndex=2;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.setEarlyZPass=function(a){if(this.enableFrontToBack&&(a=!!a,this.isEarlyZPass!==a)){var c=this.pushBatch();c.type=14;c.startIndex=
a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.isEarlyZPass=a;this.renderToTex=null;this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}};b.prototype.setDepthTestEnabled=function(a){if(this.enableFrontToBack){var c=this.pushBatch();c.type=13;c.startIndex=a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.fullscreenQuad=function(){mat4$$module$str$c3runtime.set(this.lastMV,L);this.resetModelView();this.updateModelView();var a=this.width/2,c=this.height/2;this.quad(-a,
c,a,c,a,-c,-a,-c);mat4$$module$str$c3runtime.set(L,this.matMV);this.updateModelView()};b.prototype.setColorFillMode=function(a,c,h,p){this.switchProgram(3);var m=this.pushBatch();m.type=12;m.mat4param||(m.mat4param=mat4$$module$str$c3runtime.create());m.mat4param[0]=a;m.mat4param[1]=c;m.mat4param[2]=h;m.mat4param[3]=p;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.setTextureFillMode=function(){this.switchProgram(0)};b.prototype.restoreEarlyZMode=function(){this.switchProgram(2)};b.prototype.getFrameNumber=
function(){return this.frameNumber};b.prototype.present=function(){this.endBatch();this.maybeFinishTiming();this.gl.flush();this.checkForTimerResults(this.frameNumber);this.frameNumber++};b.prototype.supportsGpuProfiling=function(){return!!this.timerExt};var K=[],n={};b.prototype.contextLost=function(){cr$$module$str$c3runtime.clearArray(K);n={}};b.prototype.loadTexture=function(a,c,h,p,m,t){c=!!c;h=!!h;var E=a.src+","+c+","+h+(c?","+m:"");if("undefined"!==typeof a.src&&n.hasOwnProperty(E)){var z=
n[E];z.c2refcount++;return z}this.endBatch();var H=this.gl,B=cr$$module$str$c3runtime.isPOT(a.width)&&cr$$module$str$c3runtime.isPOT(a.height);z=H.createTexture();H.bindTexture(H.TEXTURE_2D,z);H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var g=H.RGBA,r=H.RGBA,x=H.UNSIGNED_BYTE;if(p&&!this.isIE)switch(p){case 1:r=g=H.RGB;break;case 2:x=H.UNSIGNED_SHORT_4_4_4_4;break;case 3:x=H.UNSIGNED_SHORT_5_5_5_1;break;case 4:r=g=H.RGB,x=H.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!B&&c){p=document.createElement("canvas");
p.width=cr$$module$str$c3runtime.nextHighestPowerOfTwo(a.width);p.height=cr$$module$str$c3runtime.nextHighestPowerOfTwo(a.height);var N=p.getContext("2d");N.imageSmoothingEnabled=h;N.drawImage(a,0,0,a.width,a.height,0,0,p.width,p.height);H.texImage2D(H.TEXTURE_2D,0,g,r,x,p)}else H.texImage2D(H.TEXTURE_2D,0,g,r,x,a);c?"repeat-x"===m?(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.REPEAT),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE)):("repeat-y"===m?H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,
H.CLAMP_TO_EDGE):H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.REPEAT),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.REPEAT)):(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE));h?(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),(B||2<=this.version)&&this.enable_mipmaps&&!t?(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR_MIPMAP_LINEAR),H.generateMipmap(H.TEXTURE_2D)):H.texParameteri(H.TEXTURE_2D,
H.TEXTURE_MIN_FILTER,H.LINEAR)):(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.NEAREST),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.NEAREST));H.bindTexture(H.TEXTURE_2D,null);this.lastTexture0=null;z.c2width=a.width;z.c2height=a.height;z.c2refcount=1;z.c2texkey=E;K.push(z);return n[E]=z};b.prototype.createEmptyTexture=function(a,c,h,p,m){this.endBatch();var t=this.gl;this.isIE&&(p=!1);var E=t.createTexture();t.bindTexture(t.TEXTURE_2D,E);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,a,c,0,t.RGBA,
p?t.UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_BYTE,null);m?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE));t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,h?t.LINEAR:t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,h?t.LINEAR:t.NEAREST);t.bindTexture(t.TEXTURE_2D,null);this.lastTexture0=null;E.c2width=
a;E.c2height=c;K.push(E);return E};b.prototype.videoToTexture=function(a,c,h){this.endBatch();var p=this.gl;this.isIE&&(h=!1);p.bindTexture(p.TEXTURE_2D,c);p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);try{p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,h?p.UNSIGNED_SHORT_4_4_4_4:p.UNSIGNED_BYTE,a)}catch(m){console&&console.error&&console.error("Error updating WebGL texture: ",m)}p.bindTexture(p.TEXTURE_2D,null);this.lastTexture0=null};b.prototype.deleteTexture=function(a){a&&("undefined"!==typeof a.c2refcount&&
1<a.c2refcount?a.c2refcount--:(this.endBatch(),a===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),a===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr$$module$str$c3runtime.arrayFindRemove(K,a),"undefined"!==typeof a.c2texkey&&delete n[a.c2texkey],this.gl.deleteTexture(a)))};b.prototype.estimateVRAM=function(){var a=this.width*this.height*
8,c;var h=0;for(c=K.length;h<c;h++){var p=K[h];a+=p.c2width*p.c2height*4}return a};b.prototype.textureCount=function(){return K.length};b.prototype.setRenderingToTexture=function(a){if(a!==this.renderToTex){var c=this.pushBatch();c.type=6;this.renderToTex=c.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};cr$$module$str$c3runtime.GLWrap=b})();
(function(){function b(f){var q=f.canvas,y=f.projectDataUrl;q||(q=document.createElement("canvas"),document.body.appendChild(q));if(q&&q.getContext){window.c3runtime=this;window.c3canvas=q;var D=this;this.exportType=f.exportType;this.isPreview="preview"===this.exportType;this.isRemotePreview=!!f.isRemotePreview;this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk);this.isPhoneGap=this.isCordova=
"cordova"===this.exportType;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;
this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad;this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=
this.isNWjs="nwjs"===this.exportType||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="scirra-arcade"===this.exportType;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10="windows-uwp"===this.exportType;this.isWinJS=
this.isWindows8App||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&!this.isFirefox&&!this.isAmazonWebApp;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));
this.isWKWebView=!(!this.isiOS||!this.isCordova);this.isPreview&&!this.isNWjs&&("?nw"===window.location.search||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent))&&(this.isNWjs=!0);this.isDebug=this.isPreview&&-1<window.location.search.indexOf("debug");this.useFbInstant="undefined"!==typeof FBInstant&&!this.isPreview&&!this.isCordova;this.hasInitialized=!1;this.canvas=q;this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=
0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=0;this.canvas.oncontextmenu=function(w){w.preventDefault&&w.preventDefault();return!1};this.canvas.onselectstart=function(w){w.preventDefault&&w.preventDefault();return!1};this.canvas.ontouchstart=function(w){w.preventDefault&&w.preventDefault();return!1};this.isNWjs&&(window.ondragover=function(w){w.preventDefault();return!1},window.ondrop=function(w){w.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
if(this.isCordova&&this.isiOS){function w(){var J=document.activeElement;if(!J)return!1;var M=J.tagName.toLowerCase(),O="email number password search tel text url".split(" ");if("textarea"===M)return!0;if("input"===M)return-1<O.indexOf(J.type.toLowerCase()||"text");a:{do{if(J.parentNode&&J.hasAttribute("contenteditable")){J=!0;break a}J=J.parentNode}while(J);J=!1}return J}window.addEventListener("focusout",function(){w()||(document.scrollingElement.scrollTop=0)})}this.projectDataUrl=y||"";this.width=
q.width;this.height=q.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_lowercase={};this.types_by_index=[];this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets={};this.eventsheets_by_index=
[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=!1;this.fireOnCreateAfterLoad=
[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr$$module$str$c3runtime.KahanAdder;this.wallTime=new cr$$module$str$c3runtime.KahanAdder;this.gpuTimeEndFrame=this.gpuTimeStartFrame=this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.gpuCurUtilisation=-1;this.gpuLastUtilisation=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=
[];this.event_stack_index=-1;this.localvar_stack=[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.stackLocalCount=this.loadingprogress=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr$$module$str$c3runtime.ObjectSet;this.objects_to_tick=
new cr$$module$str$c3runtime.ObjectSet;this.objects_to_tick2=new cr$$module$str$c3runtime.ObjectSet;this.registered_collisions=[];this.temp_poly=new cr$$module$str$c3runtime.CollisionPoly([]);this.temp_poly2=new cr$$module$str$c3runtime.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=
this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder="";this.objectsByUid={};this.webFontNames=this.loaderlogos=null;this.enhancedAccelerationPrecision=!0;this.snapshotCanvas=null;this.snapshotData="";this.objectRefTable=[];"html5"===this.exportType&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)");this.useFbInstant?
(FBInstant.initializeAsync().then(function(){D.requestProjectData()}).catch(function(w){console.warn("[Instant Games] Unable to load: ",w);D.requestProjectData()}),window.setTimeout(function(){D.hasInitialized||(console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."),D.useFbInstant=!1,D.requestProjectData())},4E3)):this.requestProjectData()}}function l(){var f=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;"object"!==
typeof f&&Promise.reject("Permission API is not loaded");return Promise.resolve(f)}function v(f){return l().then(function(q){return new Promise(function(y,D){q.requestPermission(q[f],function(w){y(w.hasPermission)},D)})})}function A(f){return l().then(function(q){return new Promise(function(y,D){q.checkPermission(q[f],function(w){y(w.hasPermission)},D)})})}function L(){try{return!!window.indexedDB}catch(f){return!1}}function K(f){f.target.result.createObjectStore("saves",{keyPath:"slot"})}function n(f,
q,y,D){try{var w=indexedDB.open("_C2SaveStates");w.onupgradeneeded=K;w.onerror=D;w.onsuccess=function(J){J=J.target.result;J.onerror=D;J.transaction(["saves"],"readwrite").objectStore("saves").put({slot:f,data:q}).onsuccess=y}}catch(J){D(J)}}function a(f,q,y){try{var D=indexedDB.open("_C2SaveStates");D.onupgradeneeded=K;D.onerror=y;D.onsuccess=function(w){w=w.target.result;w.onerror=y;var J=w.transaction(["saves"]).objectStore("saves").get(f);J.onsuccess=function(M){J.result?q(J.result.data):q(null)}}}catch(w){y(w)}}
function c(){cr$$module$str$c3runtime.logexport("Reloading for continuous preview");-1<window.location.search.indexOf("continuous")?window.location.reload(!0):window.location+="?continuous"}function h(f){var q,y={};for(q in f)!f.hasOwnProperty(q)||f[q]instanceof cr$$module$str$c3runtime.ObjectSet||f[q]&&"undefined"!==typeof f[q].c2userdata||"spriteCreatedDestroyCallback"!==q&&(y[q]=f[q]);return y}var p=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||
window.msRequestAnimationFrame||window.oRequestAnimationFrame,m=new Audio,t={"audio/webm; codecs=opus":!!m.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!m.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!m.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!m.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!m.canPlayType("audio/mp4"),"audio/mpeg":!!m.canPlayType("audio/mpeg")};m=null;b.prototype.requestProjectData=function(){if(!this.hasInitialized){this.hasInitialized=
!0;var f=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",function(w){f.loadProject(JSON.parse(w))},function(w){alert("Error fetching data.js")});else{var q=this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var y=this.projectDataUrl||"data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)y="data.json";q.open("GET",y,!0);var D=!1;if("response"in q&&"responseType"in q)try{q.responseType="json",D="json"===q.responseType}catch(w){D=
!1}if(!D&&"responseType"in q)try{q.responseType="text"}catch(w){}if("overrideMimeType"in q)try{q.overrideMimeType("application/json; charset=utf-8")}catch(w){}this.isWindowsPhone8?q.onreadystatechange=function(){4===q.readyState&&f.loadProject(JSON.parse(q.responseText))}:(q.onload=function(){D?f.loadProject(q.response):f.loadProject(JSON.parse(q.responseText))},q.onerror=function(w){cr$$module$str$c3runtime.logerror("Error requesting "+y+":");cr$$module$str$c3runtime.logerror(w)});q.send()}}};b.prototype.initRendererAndLoader=
function(){var f=this,q,y;this.isRetina=this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);var D=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio||1;this.devicePixelRatio=this.isRetina?D:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();"object"===typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,
window.innerHeight,!0);try{if(this.enableWebGL){var w={alpha:!0,depth:!1,antialias:!1,failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",w));this.gl||(this.gl=this.canvas.getContext("webgl",w)||this.canvas.getContext("experimental-webgl",w))}}catch(W){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(D=this.gl.getExtension("WEBGL_debug_renderer_info"))w=this.gl.getParameter(D.UNMASKED_VENDOR_WEBGL),this.glUnmaskedRenderer=this.gl.getParameter(D.UNMASKED_RENDERER_WEBGL)+
" ["+w+"]";this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.overlay_canvas=document.createElement("canvas");this.canvas.parentNode.appendChild(this.overlay_canvas);this.overlay_canvas.oncontextmenu=function(W){return!1};this.overlay_canvas.onselectstart=function(W){return!1};this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio);this.overlay_canvas.height=Math.round(this.cssHeight*this.devicePixelRatio);this.overlay_canvas.style.width=this.cssWidth+
"px";this.overlay_canvas.style.height=this.cssHeight+"px";this.overlay_canvas.style.position="absolute";this.overlay_ctx=this.overlay_canvas.getContext("2d");this.glwrap=new cr$$module$str$c3runtime.GLWrap(this.gl,this.isMobile,this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;this.canvas.addEventListener("webglcontextlost",function(W){W.preventDefault();f.onContextLost();cr$$module$str$c3runtime.logexport("[Construct 2] WebGL context lost");
window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(W){f.glwrap.initState();f.glwrap.setSize(f.glwrap.width,f.glwrap.height,!0);f.layer_tex=null;f.layout_tex=null;f.fx_tex[0]=null;f.fx_tex[1]=null;f.onContextRestored();f.redraw=!0;cr$$module$str$c3runtime.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);this.glwrap.supportsGpuProfiling()||(this.gpuLastUtilisation=NaN);D=0;for(w=this.types_by_index.length;D<w;D++){var J=this.types_by_index[D];
var M=0;for(q=J.effect_types.length;M<q;M++){var O=J.effect_types[M];O.shaderindex=this.glwrap.getShaderIndex(O.id);O.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(O.shaderindex);this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(O.shaderindex)}}D=0;for(w=this.layouts_by_index.length;D<w;D++){var P=this.layouts_by_index[D];M=0;for(q=P.effect_types.length;M<q;M++)O=P.effect_types[M],O.shaderindex=this.glwrap.getShaderIndex(O.id),O.preservesOpaqueness=
this.glwrap.programPreservesOpaqueness(O.shaderindex);P.updateActiveEffects();M=0;for(q=P.layers.length;M<q;M++){var X=P.layers[M];J=0;for(y=X.effect_types.length;J<y;J++)O=X.effect_types[J],O.shaderindex=this.glwrap.getShaderIndex(O.id),O.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(O.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(O.shaderindex);X.updateActiveEffects()}}}else w={alpha:!0},this.ctx=this.canvas.getContext("2d",w),
this.ctx.imageSmoothingEnabled=this.linearSampling,this.overlay_ctx=this.overlay_canvas=null,this.gpuLastUtilisation=NaN,this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=!0;this.tickFunc=function(W){f.tick(!1,W)};window==window.top||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));this.isPreview&&(-1<window.location.search.indexOf("continuous")&&(cr$$module$str$c3runtime.logexport("Reloading for continuous preview"),
this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(window.addEventListener("focus",function(){f.setSuspended(!1)}),window.addEventListener("blur",function(){var W=window.parent;W&&W.document.hasFocus()||f.setSuspended(!0)})));window.addEventListener("blur",function(){f.onWindowBlur()});D=function(W){"mousedown"===W.type&&1===W.button&&W.preventDefault();if(cr$$module$str$c3runtime.isCanvasInputEvent(W)&&document.activeElement&&document.activeElement!==
document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(U){}};"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",D):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",D):document.addEventListener("touchstart",D);document.addEventListener("mousedown",D);0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio?this.setSize(this.original_width,this.original_height,!0):this.setSize(window.innerWidth,
window.innerHeight,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr$$module$str$c3runtime.seal(this)};b.prototype.setSize=function(f,q,y){var D=0,w=0;if(this.lastWindowWidth!==f||this.lastWindowHeight!==q||y){if(this.isiPhone&&this.isCordova&&window.screen){var J=document.documentElement.style;var M=document.body.style;var O=window.innerWidth<window.innerHeight;var P=O?window.screen.height:window.screen.width;O=O?window.screen.width:window.screen.height;P&&O&&(M.height=J.height=
P+"px",M.width=J.width=O+"px")}this.lastWindowWidth=f;this.lastWindowHeight=q;J=this.fullscreen_mode;if((M=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen)&&!this.isCordova)||0!==this.fullscreen_mode||y)M&&(J=this.fullscreen_scaling),y=this.devicePixelRatio,4<=J?(5===J&&1!==y&&(f+=1,q+=1),M=this.original_width/this.original_height,f/q>M?(M*=q,5===J?(D=M*y/this.original_width,1<D?D=Math.floor(D):1>D&&(D=1/Math.ceil(1/D)),M=this.original_width*
D/y,P=this.original_height*D/y,D=(f-M)/2,w=(q-P)/2,f=M,q=P):(D=(f-M)/2,f=M)):(P=f/M,5===J?(D=P*y/this.original_height,1<D?D=Math.floor(D):1>D&&(D=1/Math.ceil(1/D)),M=this.original_width*D/y,P=this.original_height*D/y,D=(f-M)/2,w=(q-P)/2,f=M):w=(q-P)/2,q=P)):M&&0===J&&(D=Math.floor((f-this.original_width)/2),w=Math.floor((q-this.original_height)/2),f=this.original_width,q=this.original_height),2>J&&(this.aspect_scale=y),this.cssWidth=Math.round(f),this.cssHeight=Math.round(q),this.width=Math.round(f*
y),this.height=Math.round(q*y),this.redraw=!0,this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===J?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===J?(M=this.original_width/this.original_height,J=this.lastWindowWidth/
this.lastWindowHeight,J<M?this.draw_width=this.draw_height*J:J>M&&(this.draw_height=this.draw_width/J)):3===J&&(M=this.original_width/this.original_height,J=this.lastWindowWidth/this.lastWindowHeight,J>M?this.draw_width=this.draw_height*J:J<M&&(this.draw_height=this.draw_width/J))),this.canvas&&(this.canvas.width=Math.round(f*y),this.canvas.height=Math.round(q*y),this.isRetina&&(this.canvas.style.width=Math.round(f)+"px",this.canvas.style.height=Math.round(q)+"px"),this.canvas.style.marginLeft=Math.floor(D)+
"px",this.canvas.style.marginTop=Math.floor(w)+"px"),this.overlay_canvas&&(this.overlay_canvas.width=Math.round(f*y),this.overlay_canvas.height=Math.round(q*y),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px",this.overlay_canvas.style.left=Math.floor(D)+"px",this.overlay_canvas.style.top=Math.floor(w)+"px"),this.glwrap&&this.glwrap.setSize(Math.round(f*y),Math.round(q*y)),this.ctx&&(this.ctx.imageSmoothingEnabled=this.linearSampling),this.tryLockOrientation(),
this.isiPhone&&!this.isCordova&&window.scrollTo(0,0)}};b.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var f="portrait";2===this.orientations&&(f="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(f).catch(function(){}):screen.lockOrientation?screen.lockOrientation(f):screen.webkitLockOrientation?screen.webkitLockOrientation(f):screen.mozLockOrientation?screen.mozLockOrientation(f):screen.msLockOrientation&&screen.msLockOrientation(f)}catch(q){console&&
console.warn&&console.warn("Failed to lock orientation: ",q)}}};b.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var f;var q=0;for(f=this.types_by_index.length;q<f;q++){var y=this.types_by_index[q];if(y.onLostWebGLContext)y.onLostWebGLContext()}};b.prototype.onContextRestored=function(){this.is_WebGL_context_lost=!1;var f;var q=0;for(f=this.types_by_index.length;q<f;q++){var y=this.types_by_index[q];if(y.onRestoreWebGLContext)y.onRestoreWebGLContext()}};
var E=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;b.prototype.setSuspended=function(f){var q;if(f&&!this.isSuspended)for(cr$$module$str$c3runtime.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&E(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),f=0,q=this.suspend_events.length;f<q;f++)this.suspend_events[f](!0);else if(!f&&this.isSuspended){cr$$module$str$c3runtime.logexport("[Construct 2] Resuming");
this.isSuspended=!1;this.last_tick_time=cr$$module$str$c3runtime.performance_now();this.last_fps_time=cr$$module$str$c3runtime.performance_now();f=this.logictime=this.framecount=0;for(q=this.suspend_events.length;f<q;f++)this.suspend_events[f](!1);this.tick(!1)}};b.prototype.addSuspendCallback=function(f){this.suspend_events.push(f)};b.prototype.GetObjectReference=function(f){return this.objectRefTable[f]};b.prototype.loadProject=function(f){f&&f.project||cr$$module$str$c3runtime.logerror("Project model unavailable");
f=f.project;this.name=f[0];this.first_layout=f[1];this.fullscreen_mode=f[12];this.fullscreen_mode_set=f[12];this.original_width=f[10];this.original_height=f[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=this.original_height/2;this.uses_loader_layout=f[18];this.loaderstyle=f[19];this.iconsFolder=f[28];this.webFontNames=f[29].map(function(ca){return ca[0]});if(0===this.loaderstyle){var q=new Image;q.crossOrigin="anonymous";var y=this.loaderlogos={logo:q};q.addEventListener("error",
function(){y.logo=null});var D=f[39];D=this.isPreview?this.getProjectFileUrl(D):this.iconsFolder+D;this.setImageSrc(q,D)}else if(4===this.loaderstyle){q=new Image;q.src="splash-images/splash-logo.svg";D=new Image;D.src="splash-images/splash-poweredby-512.png";var w=new Image;w.src="splash-images/splash-poweredby-256.png";var J=new Image;J.src="splash-images/splash-poweredby-128.png";var M=new Image;M.src="splash-images/splash-website-512.png";var O=new Image;O.src="splash-images/splash-website-256.png";
var P=new Image;P.src="splash-images/splash-website-128.png";this.loaderlogos={logo:q,powered:[D,w,J],website:[M,O,P]}}this.next_uid=f[21];this.objectRefTable=cr$$module$str$c3runtime.getObjectRefTable();this.system=new cr$$module$str$c3runtime.system_object(this);q=0;for(D=f[2].length;q<D;q++){P=f[2][q];w=this.GetObjectReference(P[0]);cr$$module$str$c3runtime.add_common_aces(P,w.prototype);var X=new w(this);X.singleglobal=P[1];X.is_world=P[2];X.is_rotatable=P[5];X.must_predraw=P[9];if(X.onCreate)X.onCreate();
cr$$module$str$c3runtime.seal(X);this.plugins.push(X)}this.objectRefTable=cr$$module$str$c3runtime.getObjectRefTable();q=0;for(D=f[3].length;q<D;q++){P=f[3][q];M=this.GetObjectReference(P[1]);X=null;w=0;for(J=this.plugins.length;w<J;w++)if(this.plugins[w]instanceof M){X=this.plugins[w];break}var W=new X.Type(X);W.name=P[0];W.is_family=P[2];W.instvar_sids=P[3].slice(0);W.vars_count=P[3].length;W.behs_count=P[4];W.fx_count=P[5];W.sid=P[11];W.is_family?(W.members=[],W.family_index=this.family_count++,
W.families=null):(W.members=null,W.family_index=-1,W.families=[]);W.family_var_map=null;W.family_beh_map=null;W.family_fx_map=null;W.is_contained=!1;W.container=null;P[6]?(W.texture_file=P[6][0],W.texture_filesize=P[6][1],W.texture_pixelformat=P[6][2],W.texture_data=P[6]):(W.texture_file=null,W.texture_filesize=0,W.texture_pixelformat=0,W.texture_data=null);W.animations=P[7]?P[7]:null;W.index=q;W.instances=[];W.deadCache=[];W.solstack=[new cr$$module$str$c3runtime.selection(W)];W.cur_sol=0;W.default_instance=
null;W.default_layerindex=0;W.stale_iids=!0;W.updateIIDs=cr$$module$str$c3runtime.type_updateIIDs;W.getFirstPicked=cr$$module$str$c3runtime.type_getFirstPicked;W.getPairedInstance=cr$$module$str$c3runtime.type_getPairedInstance;W.getCurrentSol=cr$$module$str$c3runtime.type_getCurrentSol;W.pushCleanSol=cr$$module$str$c3runtime.type_pushCleanSol;W.pushCopySol=cr$$module$str$c3runtime.type_pushCopySol;W.popSol=cr$$module$str$c3runtime.type_popSol;W.getBehaviorByName=cr$$module$str$c3runtime.type_getBehaviorByName;
W.getBehaviorIndexByName=cr$$module$str$c3runtime.type_getBehaviorIndexByName;W.getEffectIndexByName=cr$$module$str$c3runtime.type_getEffectIndexByName;W.applySolToContainer=cr$$module$str$c3runtime.type_applySolToContainer;W.getInstanceByIID=cr$$module$str$c3runtime.type_getInstanceByIID;W.collision_grid=new cr$$module$str$c3runtime.SparseGrid(this.original_width,this.original_height);W.any_cell_changed=!0;W.any_instance_parallaxed=!1;W.extra={};W.toString=cr$$module$str$c3runtime.type_toString;
W.behaviors=[];w=0;for(J=P[8].length;w<J;w++){var U=P[8][w];var Y=this.GetObjectReference(U[1]),ba=null;M=0;for(O=this.behaviors.length;M<O;M++)if(this.behaviors[M]instanceof Y){ba=this.behaviors[M];break}if(!ba){ba=new Y(this);ba.my_types=[];ba.my_instances=new cr$$module$str$c3runtime.ObjectSet;if(ba.onCreate)ba.onCreate();cr$$module$str$c3runtime.seal(ba);this.behaviors.push(ba);cr$$module$str$c3runtime.behaviors.solid&&ba instanceof cr$$module$str$c3runtime.behaviors.solid&&(this.solidBehavior=
ba);cr$$module$str$c3runtime.behaviors.jumpthru&&ba instanceof cr$$module$str$c3runtime.behaviors.jumpthru&&(this.jumpthruBehavior=ba);cr$$module$str$c3runtime.behaviors.shadowcaster&&ba instanceof cr$$module$str$c3runtime.behaviors.shadowcaster&&(this.shadowcasterBehavior=ba)}-1===ba.my_types.indexOf(W)&&ba.my_types.push(W);M=new ba.Type(ba,W);M.name=U[0];M.sid=U[2];M.onCreate();cr$$module$str$c3runtime.seal(M);W.behaviors.push(M)}W.global=P[9];W.isOnLoaderLayout=P[10];W.effect_types=[];w=0;for(J=
P[12].length;w<J;w++)W.effect_types.push({id:P[12][w][0],name:P[12][w][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:w});w=P[13];W.tile_poly_data=w?w[0]:null;if(!this.uses_loader_layout||W.is_family||W.isOnLoaderLayout||!X.is_world)W.onCreate(),cr$$module$str$c3runtime.seal(W);W.name&&(this.types[W.name]=W,this.types_lowercase[W.name.toLowerCase()]=W);this.types_by_index.push(W);X.singleglobal&&(w=new X.Instance(W),w.uid=this.next_uid++,w.puid=this.next_puid++,w.iid=0,w.get_iid=cr$$module$str$c3runtime.inst_get_iid,
w.toString=cr$$module$str$c3runtime.inst_toString,w.properties=P[16],w.onCreate(),cr$$module$str$c3runtime.seal(w),W.instances.push(w),this.objectsByUid[w.uid.toString()]=w)}q=0;for(D=f[4].length;q<D;q++)for(M=f[4][q],O=this.types_by_index[M[0]],w=1,J=M.length;w<J;w++)P=this.types_by_index[M[w]],P.families.push(O),O.members.push(P);q=0;for(D=f[27].length;q<D;q++){M=f[27][q];O=[];w=0;for(J=M.length;w<J;w++)O.push(this.types_by_index[M[w]]);w=0;for(J=O.length;w<J;w++)O[w].is_contained=!0,O[w].container=
O}if(0<this.family_count)for(q=0,D=this.types_by_index.length;q<D;q++)if(P=this.types_by_index[q],!P.is_family&&P.families.length){P.family_var_map=Array(this.family_count);P.family_beh_map=Array(this.family_count);P.family_fx_map=Array(this.family_count);W=[];w=ba=Y=U=0;for(J=P.families.length;w<J;w++)for(X=P.families[w],P.family_var_map[X.family_index]=U,U+=X.vars_count,P.family_beh_map[X.family_index]=Y,Y+=X.behs_count,P.family_fx_map[X.family_index]=ba,ba+=X.fx_count,M=0,O=X.effect_types.length;M<
O;M++)W.push(cr$$module$str$c3runtime.shallowCopy({},X.effect_types[M]));P.effect_types=W.concat(P.effect_types);w=0;for(J=P.effect_types.length;w<J;w++)P.effect_types[w].index=w}q=0;for(D=f[5].length;q<D;q++)P=f[5][q],w=new cr$$module$str$c3runtime.layout(this,P),cr$$module$str$c3runtime.seal(w),this.layouts[w.name]=w,this.layouts_by_index.push(w);q=0;for(D=f[6].length;q<D;q++)P=f[6][q],w=new cr$$module$str$c3runtime.eventsheet(this,P),cr$$module$str$c3runtime.seal(w),this.eventsheets[w.name]=w,
this.eventsheets_by_index.push(w);q=0;for(D=this.eventsheets_by_index.length;q<D;q++)this.eventsheets_by_index[q].postInit();q=0;for(D=this.eventsheets_by_index.length;q<D;q++)this.eventsheets_by_index[q].updateDeepIncludes();q=0;for(D=this.triggers_to_postinit.length;q<D;q++)this.triggers_to_postinit[q].postInit();cr$$module$str$c3runtime.clearArray(this.triggers_to_postinit);this.audio_files_info=f[7];this.audio_files_map={};q=0;for(D=this.audio_files_info.length;q<D;++q)w=this.audio_files_info[q],
this.audio_files_map[w[0]]=w[1];this.files_subfolder=f[8];this.pixel_rounding=f[9];this.aspect_scale=1;this.enableWebGL=f[13];this.linearSampling=f[14];this.clearBackground=f[15];this.versionstr=f[16];this.useHighDpi=f[17];this.orientations=f[20];this.autoLockOrientation=0<this.orientations;this.pauseOnBlur=f[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=f[23];this.downscalingQuality=f[24];this.preloadSounds=f[25];this.enableFrontToBack=f[26]&&!this.isIE;this.enhancedAccelerationPrecision=
f[30];this.start_time=Date.now();cr$$module$str$c3runtime.clearArray(this.objectRefTable);this.preloadSounds||t["audio/webm; codecs=opus"]||!window.OpusDecoder||window.OpusDecoder.Initialise();this.initRendererAndLoader()};var z=!1;b.prototype.waitForImageLoad=function(f,q){window.cr_remotePreviewImageFiles&&q&&"blob:"!==q.substr(0,5)&&(q=window.cr_remotePreviewImageFiles[q]);f.onerror=function(y){z=f.c2error=!0;console&&console.error&&console.error("Error loading image '"+f.src+"': ",y)};f.src||
("undefined"!==typeof XAPKReader?XAPKReader.get(q,function(y){f.src=y},function(y){z=f.c2error=!0;console&&console.error&&console.error("Error extracting image '"+q+"' from expansion file: ",y)}):(f.crossOrigin="anonymous",this.setImageSrc(f,q)));this.wait_for_textures.push(f)};b.prototype.findWaitingTexture=function(f){var q;var y=0;for(q=this.wait_for_textures.length;y<q;y++)if(this.wait_for_textures[y].cr_src===f)return this.wait_for_textures[y];return null};var H=0,B=!1;b.prototype.getready=function(){if(this.audioInstance&&
this.preloadSounds){var f=[],q;var y=0;for(q=this.audio_files_info.length;y<q;++y){var D=this.audio_files_info[y];var w=D[0];var J=D[2];(D=this.getPreferredAudioFile(w))&&!J&&f.push({filename:w+D[1],size:D[2],type:D[0]})}H=this.audioInstance.setPreloadList(f)}};b.prototype.areAllTexturesAndSoundsLoaded=function(){var f=H,q=0,y=!0,D;var w=0;for(D=this.wait_for_textures.length;w<D;w++){var J=this.wait_for_textures[w];var M=J.cr_filesize;if(!M||0>=M)M=5E4;f+=M;J.src&&J.complete&&!J.c2error?q+=M:y=!1}y&&
this.preloadSounds&&this.audioInstance&&(B||(this.audioInstance.startPreloads(),B=!0),w=this.audioInstance.getPreloadedSize(),q+=w,w<H&&(y=!1));this.progress=0==f?1:q/f;return y};var g=!1;b.prototype.go=function(){if(this.ctx||this.glwrap){var f=this.ctx||this.overlay_ctx;if(0<this.fullscreen_mode){var q=window.innerWidth,y=window.innerHeight;this.lastWindowWidth===q&&this.lastWindowHeight===y||this.setSize(q,y)}this.progress=0;this.last_progress=-1;var D=this;if(this.areAllTexturesAndSoundsLoaded()&&
(4!==this.loaderstyle||g))this.useFbInstant?FBInstant.startGameAsync().then(function(){D.go_loading_finished()}):this.go_loading_finished();else{this.useFbInstant&&FBInstant.setLoadingProgress(100*this.progress);y=Date.now()-this.start_time;if(f){var w=this.width,J=this.height;q=this.devicePixelRatio;if(3>this.loaderstyle&&500<=y&&this.last_progress!=this.progress){f.clearRect(0,0,w,J);y=w/2;J/=2;w=0===this.loaderstyle&&this.loaderlogos.logo&&this.loaderlogos.logo.complete;var M=40*q,O=0,P=80*q;if(w){var X=
this.loaderlogos.logo;P=X.width*q;var W=X.height*q;M=P/2;O=W/2;f.drawImage(X,cr$$module$str$c3runtime.floor(y-M),cr$$module$str$c3runtime.floor(J-O),P,W)}1>=this.loaderstyle?(J+=O+(w?12*q:0),y=cr$$module$str$c3runtime.floor(y-M)+.5,J=cr$$module$str$c3runtime.floor(J)+.5,f.fillStyle=z?"red":"DodgerBlue",f.fillRect(y,J,Math.floor(P*this.progress),6*q),f.strokeStyle="black",f.strokeRect(y,J,P,6*q),f.strokeStyle="white",f.strokeRect(y-1*q,J-1*q,P+2*q,8*q)):2===this.loaderstyle&&(f.font="12pt Arial",f.fillStyle=
z?"#f00":"#999",f.textBaseLine="middle",q=Math.round(100*this.progress)+"%",w=f.measureText?f.measureText(q):null,f.fillText(q,y-(w?w.width:0)/2,J));this.last_progress=this.progress}else if(4===this.loaderstyle){this.draw_c3_splash_loader(f);p?p(function(){D.go()}):setTimeout(function(){D.go()},16);return}}setTimeout(function(){D.go()},100)}}};var r=-1,x=!0,N=!1,Q=0,F=0,d=null,k=null,C=0;b.prototype.draw_c3_splash_loader=function(f){if(!g){var q=this.isPreview||this.useFbInstant,y=q?0:200,D=q?0:3E3,
w=Math.ceil(this.width),J=Math.ceil(this.height),M=this.loaderlogos.logo,O=this.loaderlogos.powered,P=this.loaderlogos.website;if(M.complete){for(var X=0;3>X;++X)if(!O[X].complete||!P[X].complete)return;0===C&&(r=Date.now());X=Date.now();var W=!1,U=f;x||N?(f.clearRect(0,0,w,J),d&&d.width===w&&d.height===J||(d=document.createElement("canvas"),d.width=w,d.height=J,k=d.getContext("2d")),U=k,W=!0,x&&1===C&&(r=Date.now())):f.globalAlpha=1;U.fillStyle="#3B4045";U.fillRect(0,0,w,J);try{if(256<this.cssHeight){var Y=
1.5*cr$$module$str$c3runtime.clamp(.22*J,105,.6*w);var ba=Y/8;U.drawImage(128>=Y?O[2]:256>=Y?O[1]:O[0],.5*w-Y/2,.2*J-ba/2,Y,ba);ba=Y=Math.min(.395*J,.95*w);U.drawImage(M,.5*w-Y/2,.485*J-ba/2,Y,ba);Y=1.5*cr$$module$str$c3runtime.clamp(.22*J,105,.6*w);ba=Y/8;U.drawImage(128>=Y?P[2]:256>=Y?P[1]:P[0],.5*w-Y/2,.868*J-ba/2,Y,ba);U.fillStyle="#4D565D";Y=w;ba=Math.max(.005*J,2);U.fillRect(0,.8*J-ba/2,Y,ba);U.fillStyle=z?"red":"#29F3D0";Y=w*this.progress;U.fillRect(.5*w-Y/2,.8*J-ba/2,Y,ba)}else ba=Y=.55*J,
U.drawImage(M,.5*w-Y/2,.45*J-ba/2,Y,ba),U.fillStyle="#4D565D",Y=w,ba=Math.max(.005*J,2),U.fillRect(0,.85*J-ba/2,Y,ba),U.fillStyle=z?"red":"#29F3D0",Y=w*this.progress,U.fillRect(.5*w-Y/2,.85*J-ba/2,Y,ba);W&&(x?f.globalAlpha=0===C?0:Math.min((X-r)/300,1):N&&(f.globalAlpha=Math.max(1-(X-F)/300,0)),f.drawImage(d,0,0,w,J))}catch(ca){}x&&300<=X-r&&2<=C&&(x=!1,Q=X);!x&&X-Q>=D&&!N&&1<=this.progress&&(N=!0,F=X);if(N&&X-F>=300+y||q&&1<=this.progress&&500>Date.now()-r)g=!0,N=x=!1,this.loaderlogos=k=d=null;++C}}};
b.prototype.go_loading_finished=function(){if(this.webFontNames.length&&document.fonts&&document.fonts.load){var f=this;Promise.all(this.webFontNames.map(function(q){return document.fonts.load("1em '"+q+"'")})).then(function(){f.start_first_layout()})}else this.start_first_layout()};b.prototype.start_first_layout=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=this.overlay_ctx=null);this.start_time=Date.now();this.last_fps_time=cr$$module$str$c3runtime.performance_now();
var f;if(this.uses_loader_layout){var q=0;for(f=this.types_by_index.length;q<f;q++){var y=this.types_by_index[q];y.is_family||y.isOnLoaderLayout||!y.plugin.is_world||(y.onCreate(),cr$$module$str$c3runtime.seal(y))}}else this.isloading=!1;q=0;for(f=this.layouts_by_index.length;q<f;q++)this.layouts_by_index[q].createGlobalNonWorlds();2<=this.fullscreen_mode&&(q=this.original_width/this.original_height,f=this.width/this.height,this.aspect_scale=2!==this.fullscreen_mode&&f>q||2===this.fullscreen_mode&&
f<q?this.height/this.original_height:this.width/this.original_width);q=0;for(f=this.types_by_index.length;q<f;q++)if(y=this.types_by_index[q],y.onBeforeAppBegin)y.onBeforeAppBegin();this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&window.C3_RegisterSW());navigator.splashscreen&&navigator.splashscreen.hide&&
navigator.splashscreen.hide();q=0;for(f=this.types_by_index.length;q<f;q++)if(y=this.types_by_index[q],y.onAppBegin)y.onAppBegin();q=function(){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):window.cr_setSuspended(!1)};document.addEventListener("visibilitychange",q,!1);document.addEventListener("mozvisibilitychange",q,!1);document.addEventListener("webkitvisibilitychange",q,!1);document.addEventListener("msvisibilitychange",q,!1);this.isCordova&&
(document.addEventListener("pause",function(){window.cr_setSuspended(!0)}),document.addEventListener("resume",function(){window.cr_setSuspended(!1)}));document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1)};b.prototype.tick=function(f,q,y){if(this.running_layout){var D=cr$$module$str$c3runtime.performance_now();if(y||!this.isSuspended||f){f||(p?this.raf_id=p(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));
q=q||D;var w=this.fullscreen_mode;(y=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)&&0<this.fullscreen_scaling&&(w=this.fullscreen_scaling);if(0<w){w=window.innerWidth;var J=window.innerHeight;this.lastWindowWidth===w&&this.lastWindowHeight===J||this.setSize(w,J)}y?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/
this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height);this.isloading&&(y=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,y&&(this.isloading=!1,this.progress=1,this.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&window.C3_RegisterSW()));this.logic(q);!this.redraw||this.is_WebGL_context_lost||this.suspendDrawing||f||(this.redraw=!1,this.glwrap?
this.drawGL():this.draw(),this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr$$module$str$c3runtime.performance_now()-
D}}};b.prototype.logic=function(f){var q;1E3<=f-this.last_fps_time&&(this.last_fps_time+=1E3,1E3<=f-this.last_fps_time&&(this.last_fps_time=f),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=Math.min(this.logictime,1E3),this.logictime=0,this.glwrap&&0===this.gpuTimeEndFrame&&(this.gpuTimeEndFrame=this.glwrap.getFrameNumber(),this.gpuCurUtilisation=-1));this.glwrap&&-1===this.gpuCurUtilisation&&this.glwrap.supportsGpuProfiling()&&(this.gpuCurUtilisation=this.glwrap.getFrameRangeTimerResults(this.gpuTimeStartFrame,
this.gpuTimeEndFrame),-1!==this.gpuCurUtilisation&&(this.glwrap.deleteTimerResultsToFrame(this.gpuTimeEndFrame),this.gpuLastUtilisation=Math.min(this.gpuCurUtilisation,1),this.gpuTimeStartFrame=this.gpuTimeEndFrame,this.gpuTimeEndFrame=0));if(0!==this.last_tick_time){var y=f-this.last_tick_time;0>y&&(y=0);this.dt1=y/1E3;.5<this.dt1?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate)}this.last_tick_time=f;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(this.dt1);
f=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova;if(2<=this.fullscreen_mode||f&&0<this.fullscreen_scaling){y=this.original_width/this.original_height;var D=this.width/this.height;var w=this.fullscreen_mode;f&&0<this.fullscreen_scaling&&(w=this.fullscreen_scaling);this.aspect_scale=2!==w&&D>y||2===w&&D<y?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),
this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;D=this.objects_to_pretick.valuesRef();f=0;for(y=D.length;f<y;f++)D[f].pretick();f=0;for(y=this.types_by_index.length;f<y;f++){var J=this.types_by_index[f];if(!J.is_family&&(J.behaviors.length||J.families.length))for(D=0,w=J.instances.length;D<w;D++){var M=
J.instances[D];var O=0;for(q=M.behavior_insts.length;O<q;O++)M.behavior_insts[O].tick()}}f=0;for(y=this.types_by_index.length;f<y;f++)if(J=this.types_by_index[f],!J.is_family&&(J.behaviors.length||J.families.length))for(D=0,w=J.instances.length;D<w;D++)for(M=J.instances[D],O=0,q=M.behavior_insts.length;O<q;O++){var P=M.behavior_insts[O];P.posttick&&P.posttick()}D=this.objects_to_tick.valuesRef();f=0;for(y=D.length;f<y;f++)D[f].tick();this.isInOnDestroy--;this.handleSaveLoad();for(f=0;this.changelayout&&
10>f++;)this.doChangeLayout(this.changelayout);f=0;for(y=this.eventsheets_by_index.length;f<y;f++)this.eventsheets_by_index[f].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr$$module$str$c3runtime.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;f=0;for(y=this.types_by_index.length;f<y;f++)if(J=this.types_by_index[f],!J.is_family&&(J.behaviors.length||J.families.length))for(D=0,w=J.instances.length;D<w;D++)for(M=J.instances[D],
O=0,q=M.behavior_insts.length;O<q;O++)P=M.behavior_insts[O],P.tick2&&P.tick2();D=this.objects_to_tick2.valuesRef();f=0;for(y=D.length;f<y;f++)D[f].tick2();this.isInOnDestroy--};b.prototype.onWindowBlur=function(){var f,q,y;var D=0;for(f=this.types_by_index.length;D<f;D++){var w=this.types_by_index[D];if(!w.is_family){var J=0;for(q=w.instances.length;J<q;J++){var M=w.instances[J];if(M.onWindowBlur)M.onWindowBlur();if(M.behavior_insts){var O=0;for(y=M.behavior_insts.length;O<y;O++){var P=M.behavior_insts[O];
if(P.onWindowBlur)P.onWindowBlur()}}}}}};b.prototype.doChangeLayout=function(f){var q=this.running_layout;this.running_layout.stopRunning();var y;if(this.glwrap){var D=0;for(y=this.types_by_index.length;D<y;D++){var w=this.types_by_index[D];w.is_family||!w.unloadTextures||w.global&&0!==w.instances.length||-1!==f.initial_types.indexOf(w)||w.unloadTextures()}}q==f&&cr$$module$str$c3runtime.clearArray(this.system.waits);cr$$module$str$c3runtime.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);
f.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=this.redraw=!0;this.ClearDeathRow()};b.prototype.runLayoutChangeMethods=function(f){var q,y,D;var w=0;for(q=this.behaviors.length;w<q;w++){var J=this.behaviors[w];if(f){if(J.onBeforeLayoutChange)J.onBeforeLayoutChange()}else if(J.onLayoutChange)J.onLayoutChange()}w=0;for(q=this.types_by_index.length;w<q;w++)if(J=this.types_by_index[w],J.global||J.plugin.singleglobal){var M=0;for(y=J.instances.length;M<y;M++){var O=J.instances[M];
if(f){if(O.onBeforeLayoutChange)O.onBeforeLayoutChange()}else if(O.onLayoutChange)O.onLayoutChange();if(O.behavior_insts){var P=0;for(D=O.behavior_insts.length;P<D;P++){var X=O.behavior_insts[P];if(f){if(X.onBeforeLayoutChange)X.onBeforeLayoutChange()}else if(X.onLayoutChange)X.onLayoutChange()}}}}};b.prototype.pretickMe=function(f){this.objects_to_pretick.add(f)};b.prototype.unpretickMe=function(f){this.objects_to_pretick.remove(f)};b.prototype.tickMe=function(f){this.objects_to_tick.add(f)};b.prototype.untickMe=
function(f){this.objects_to_tick.remove(f)};b.prototype.tick2Me=function(f){this.objects_to_tick2.add(f)};b.prototype.untick2Me=function(f){this.objects_to_tick2.remove(f)};b.prototype.getDt=function(f){return f&&-1!==f.my_timescale?this.dt1*f.my_timescale:this.dt};b.prototype.draw=function(){this.running_layout.draw(this.ctx)};b.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));this.running_layout.drawGL(this.glwrap);this.glwrap.present()};
b.prototype.addDestroyCallback=function(f){f&&this.destroycallbacks.push(f)};b.prototype.removeDestroyCallback=function(f){cr$$module$str$c3runtime.arrayFindRemove(this.destroycallbacks,f)};b.prototype.getObjectByUID=function(f){f=f.toString();return this.objectsByUid.hasOwnProperty(f)?this.objectsByUid[f]:null};var e=[];b.prototype.DestroyInstance=function(f){var q;var y=f.type.name;if(this.deathRow.hasOwnProperty(y)){var D=this.deathRow[y];if(D.contains(f))return}else D=e.length?e.pop():new cr$$module$str$c3runtime.ObjectSet,
this.deathRow[y]=D;f.isDestroyed=!0;D.add(f);this.hasPendingInstances=!0;if(f.is_contained)for(y=0,q=f.siblings.length;y<q;y++)this.DestroyInstance(f.siblings[y]);this.isInClearDeathRow&&D.values_cache.push(f);this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(f.type.plugin).cnds.OnDestroyed,f),this.isInOnDestroy--)};b.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var f,q;this.isInClearDeathRow=!0;var y=0;for(f=this.createRow.length;y<f;++y){var D=this.createRow[y];
var w=D.type;w.instances.push(D);var J=0;for(q=w.families.length;J<q;++J)w.families[J].instances.push(D),w.families[J].stale_iids=!0}cr$$module$str$c3runtime.clearArray(this.createRow);this.IterateDeathRow();cr$$module$str$c3runtime.wipe(this.deathRow);this.hasPendingInstances=this.isInClearDeathRow=!1}};b.prototype.IterateDeathRow=function(){for(var f in this.deathRow)this.deathRow.hasOwnProperty(f)&&this.ClearDeathRowForType(this.deathRow[f])};b.prototype.ClearDeathRowForType=function(f){var q=
f.valuesRef(),y=q[0].type,D,w;cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet(y.instances,f);y.stale_iids=!0;0===y.instances.length&&(y.any_instance_parallaxed=!1);var J=0;for(D=y.families.length;J<D;++J){var M=y.families[J];cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet(M.instances,f);M.stale_iids=!0}J=0;for(D=this.system.waits.length;J<D;++J){var O=this.system.waits[J];O.sols.hasOwnProperty(y.index)&&cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet(O.sols[y.index].insts,f);if(!y.is_family){var P=
0;for(w=y.families.length;P<w;++P)M=y.families[P],O.sols.hasOwnProperty(M.index)&&cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet(O.sols[M.index].insts,f)}}if(O=q[0].layer){if(O.useRenderCells)for(P=O.instances,J=0,D=P.length;J<D;++J)w=P[J],f.contains(w)&&(w.update_bbox(),O.render_grid.update(w,w.rendercells,null),w.rendercells.set(0,0,-1,-1));cr$$module$str$c3runtime.arrayRemoveAllFromObjectSet(O.instances,f);O.setZIndicesStaleFrom(0)}for(J=0;J<q.length;++J)this.ClearDeathRowForSingleInstance(q[J],
y);f.clear();e.push(f);this.redraw=!0};b.prototype.ClearDeathRowForSingleInstance=function(f,q){var y;var D=0;for(y=this.destroycallbacks.length;D<y;++D)this.destroycallbacks[D](f);f.collcells&&q.collision_grid.update(f,f.collcells,null);(D=f.layer)&&D.removeFromInstanceList(f,!0);if(f.behavior_insts)for(D=0,y=f.behavior_insts.length;D<y;++D){var w=f.behavior_insts[D];if(w.onDestroy)w.onDestroy();w.behavior.my_instances.remove(f)}this.objects_to_pretick.remove(f);this.objects_to_tick.remove(f);this.objects_to_tick2.remove(f);
if(f.onDestroy)f.onDestroy();this.objectsByUid.hasOwnProperty(f.uid.toString())&&delete this.objectsByUid[f.uid.toString()];this.objectcount--;100>q.deadCache.length&&q.deadCache.push(f)};b.prototype.createInstance=function(f,q,y,D){if(f.is_family){var w=cr$$module$str$c3runtime.floor(Math.random()*f.members.length);return this.createInstance(f.members[w],q,y,D)}return f.default_instance?this.createInstanceFromInit(f.default_instance,q,!1,y,D,!1):null};var u=[];b.prototype.createInstanceFromInit=
function(f,q,y,D,w,J){var M,O;if(!f)return null;var P=this.types_by_index[f[1]],X=P.plugin.is_world;if(this.isloading&&X&&!P.isOnLoaderLayout||X&&!this.glwrap&&11===f[0][11])return null;var W=q;X||(q=null);if(P.deadCache.length){var U=P.deadCache.pop();U.recycled=!0;P.plugin.Instance.call(U,P)}else U=new P.plugin.Instance(P),U.recycled=!1;!y||J||this.objectsByUid.hasOwnProperty(f[2].toString())?U.uid=this.next_uid++:U.uid=f[2];this.objectsByUid[U.uid.toString()]=U;U.puid=this.next_puid++;U.iid=P.instances.length;
var Y=0;for(M=this.createRow.length;Y<M;++Y)this.createRow[Y].type===P&&U.iid++;U.get_iid=cr$$module$str$c3runtime.inst_get_iid;U.toString=cr$$module$str$c3runtime.inst_toString;U.isDestroyed=!1;var ba=f[3];if(U.recycled)cr$$module$str$c3runtime.wipe(U.extra);else{U.extra={};if(this.isPreview)for(U.instance_var_names=[],U.instance_var_names.length=ba.length,Y=0,M=ba.length;Y<M;Y++)U.instance_var_names[Y]=ba[Y][1];U.instance_vars=[];U.instance_vars.length=ba.length}Y=0;for(M=ba.length;Y<M;Y++)U.instance_vars[Y]=
ba[Y][0];if(X){var ca=f[0];U.x=cr$$module$str$c3runtime.is_undefined(D)?ca[0]:D;U.y=cr$$module$str$c3runtime.is_undefined(w)?ca[1]:w;U.z=ca[2];U.width=ca[3];U.height=ca[4];U.depth=ca[5];U.angle=ca[6];U.opacity=ca[7];U.hotspotX=ca[8];U.hotspotY=ca[9];U.blend_mode=ca[10];Y=ca[11];!this.glwrap&&P.effect_types.length&&(U.blend_mode=Y);U.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(U.blend_mode);this.gl&&cr$$module$str$c3runtime.setGLBlend(U,U.blend_mode,this.gl);if(U.recycled){Y=0;for(M=ca[12].length;Y<
M;Y++)for(ba=0,O=ca[12][Y].length;ba<O;ba++)U.effect_params[Y][ba]=ca[12][Y][ba],Array.isArray(U.effect_params[Y][ba])&&(U.effect_params[Y][ba]=U.effect_params[Y][ba].slice(0));U.bbox.set(0,0,0,0);U.collcells.set(0,0,-1,-1);U.rendercells.set(0,0,-1,-1);U.bquad.set_from_rect(U.bbox);cr$$module$str$c3runtime.clearArray(U.bbox_changed_callbacks)}else{U.effect_params=ca[12].slice(0);Y=0;for(M=U.effect_params.length;Y<M;Y++)for(U.effect_params[Y]=ca[12][Y].slice(0),ba=0,O=U.effect_params[Y].length;ba<
O;++ba)Array.isArray(U.effect_params[Y][ba])&&(U.effect_params[Y][ba]=U.effect_params[Y][ba].slice(0));U.active_effect_types=[];U.active_effect_flags=[];U.active_effect_flags.length=P.effect_types.length;U.bbox=new cr$$module$str$c3runtime.rect(0,0,0,0);U.collcells=new cr$$module$str$c3runtime.rect(0,0,-1,-1);U.rendercells=new cr$$module$str$c3runtime.rect(0,0,-1,-1);U.bquad=new cr$$module$str$c3runtime.quad;U.bbox_changed_callbacks=[];U.set_bbox_changed=cr$$module$str$c3runtime.set_bbox_changed;
U.add_bbox_changed_callback=cr$$module$str$c3runtime.add_bbox_changed_callback;U.contains_pt=cr$$module$str$c3runtime.inst_contains_pt;U.update_bbox=cr$$module$str$c3runtime.update_bbox;U.update_render_cell=cr$$module$str$c3runtime.update_render_cell;U.update_collision_cell=cr$$module$str$c3runtime.update_collision_cell;U.get_zindex=cr$$module$str$c3runtime.inst_get_zindex}U.tilemap_exists=!1;U.tilemap_width=0;U.tilemap_height=0;U.tilemap_data=null;ca[13]&&(U.tilemap_exists=!0,U.tilemap_width=ca[13][0],
U.tilemap_height=ca[13][1],U.tilemap_data=ca[13][2]);Y=0;for(M=P.effect_types.length;Y<M;Y++)U.active_effect_flags[Y]=!0;U.shaders_preserve_opaqueness=!0;U.updateActiveEffects=cr$$module$str$c3runtime.inst_updateActiveEffects;U.updateActiveEffects();U.uses_shaders=!!U.active_effect_types.length;U.bbox_changed=!0;U.cell_changed=!0;P.any_cell_changed=!0;U.visible=!0;U.my_timescale=-1;U.layer=q;U.zindex=q.instances.length;U.earlyz_index=0;"undefined"===typeof U.collision_poly&&(U.collision_poly=null);
this.redraw=U.collisionsEnabled=!0}cr$$module$str$c3runtime.clearArray(u);Y=0;for(M=P.families.length;Y<M;Y++)u.push.apply(u,P.families[Y].behaviors);u.push.apply(u,P.behaviors);if(U.recycled)for(Y=0,M=u.length;Y<M;Y++){var ea=u[Y];var da=U.behavior_insts[Y];da.recycled=!0;ea.behavior.Instance.call(da,ea,U);ca=f[4][Y];ba=0;for(O=ca.length;ba<O;ba++)da.properties[ba]=ca[ba];da.onCreate();ea.behavior.my_instances.add(U)}else for(U.behavior_insts=[],Y=0,M=u.length;Y<M;Y++)ea=u[Y],da=new ea.behavior.Instance(ea,
U),da.recycled=!1,da.properties=f[4][Y].slice(0),da.onCreate(),cr$$module$str$c3runtime.seal(da),U.behavior_insts.push(da),ea.behavior.my_instances.add(U);ca=f[5];if(U.recycled)for(Y=0,M=ca.length;Y<M;Y++)U.properties[Y]=ca[Y];else U.properties=ca.slice(0);this.createRow.push(U);this.hasPendingInstances=!0;q&&(q.appendToInstanceList(U,!0),1!==q.parallaxX||1!==q.parallaxY)&&(P.any_instance_parallaxed=!0);this.objectcount++;if(P.is_contained){if(U.is_contained=!0,U.recycled?cr$$module$str$c3runtime.clearArray(U.siblings):
U.siblings=[],!y&&!J){Y=0;for(M=P.container.length;Y<M;Y++)if(P.container[Y]!==P){if(!P.container[Y].default_instance)return null;U.siblings.push(this.createInstanceFromInit(P.container[Y].default_instance,W,!1,X?U.x:D,X?U.y:w,!0))}Y=0;for(M=U.siblings.length;Y<M;Y++)for(U.siblings[Y].siblings.push(U),ba=0;ba<M;ba++)Y!==ba&&U.siblings[Y].siblings.push(U.siblings[ba])}}else U.is_contained=!1,U.siblings=null;U.onCreate();U.recycled||cr$$module$str$c3runtime.seal(U);Y=0;for(M=U.behavior_insts.length;Y<
M;Y++)U.behavior_insts[Y].postCreate&&U.behavior_insts[Y].postCreate();return U};b.prototype.getLayerByName=function(f){var q;var y=0;for(q=this.running_layout.layers.length;y<q;y++){var D=this.running_layout.layers[y];if(cr$$module$str$c3runtime.equals_nocase(D.name,f))return D}return null};b.prototype.getLayerByNumber=function(f){f=cr$$module$str$c3runtime.floor(f);0>f&&(f=0);f>=this.running_layout.layers.length&&(f=this.running_layout.layers.length-1);return this.running_layout.layers[f]};b.prototype.getLayer=
function(f){return cr$$module$str$c3runtime.is_number(f)?this.getLayerByNumber(f):this.getLayerByName(f.toString())};b.prototype.clearSol=function(f){var q;var y=0;for(q=f.length;y<q;y++)f[y].getCurrentSol().select_all=!0};b.prototype.pushCleanSol=function(f){var q;var y=0;for(q=f.length;y<q;y++)f[y].pushCleanSol()};b.prototype.pushCopySol=function(f){var q;var y=0;for(q=f.length;y<q;y++)f[y].pushCopySol()};b.prototype.popSol=function(f){var q;var y=0;for(q=f.length;y<q;y++)f[y].popSol()};b.prototype.updateAllCells=
function(f){if(f.any_cell_changed){var q,y=f.instances;var D=0;for(q=y.length;D<q;++D)y[D].update_collision_cell();y=this.createRow;D=0;for(q=y.length;D<q;++D)y[D].type===f&&y[D].update_collision_cell();f.any_cell_changed=!1}};b.prototype.getCollisionCandidates=function(f,q,y,D){var w,J=f?1!==f.parallaxX||1!==f.parallaxY:!1;if(q.is_family)for(f=0,w=q.members.length;f<w;++f){var M=q.members[f];J||M.any_instance_parallaxed?cr$$module$str$c3runtime.appendArray(D,M.instances):(this.updateAllCells(M),
M.collision_grid.queryRange(y,D))}else J||q.any_instance_parallaxed?cr$$module$str$c3runtime.appendArray(D,q.instances):(this.updateAllCells(q),q.collision_grid.queryRange(y,D))};b.prototype.getTypesCollisionCandidates=function(f,q,y,D){var w;var J=0;for(w=q.length;J<w;++J)this.getCollisionCandidates(f,q[J],y,D)};b.prototype.getSolidCollisionCandidates=function(f,q,y){var D=this.getSolidBehavior();if(!D)return null;this.getTypesCollisionCandidates(f,D.my_types,q,y)};b.prototype.getJumpthruCollisionCandidates=
function(f,q,y){var D=this.getJumpthruBehavior();if(!D)return null;this.getTypesCollisionCandidates(f,D.my_types,q,y)};b.prototype.testAndSelectCanvasPointOverlap=function(f,q,y,D){var w=f.getCurrentSol(),J,M=this.getCurrentEventStack().current_event.orblock;if(w.select_all){D||(w.select_all=!1,cr$$module$str$c3runtime.clearArray(w.instances));var O=0;for(J=f.instances.length;O<J;O++){var P=f.instances[O];P.update_bbox();var X=P.layer.canvasToLayer(q,y,!0);var W=P.layer.canvasToLayer(q,y,!1);if(P.contains_pt(X,
W)){if(D)return!1;w.instances.push(P)}else M&&w.else_instances.push(P)}}else{var U=0;var Y=M?w.else_instances:w.instances;O=0;for(J=Y.length;O<J;O++)if(P=Y[O],P.update_bbox(),X=P.layer.canvasToLayer(q,y,!0),W=P.layer.canvasToLayer(q,y,!1),P.contains_pt(X,W)){if(D)return!1;M?w.instances.push(P):(w.instances[U]=w.instances[O],U++)}D||(Y.length=U)}f.applySolToContainer();return D?!0:w.hasObjects()};b.prototype.testOverlap=function(f,q){if(!(f&&q&&f!==q&&f.collisionsEnabled&&q.collisionsEnabled))return!1;
f.update_bbox();q.update_bbox();var y=f.layer,D=q.layer,w;if(y===D||y.parallaxX===D.parallaxX&&D.parallaxY===D.parallaxY&&y.scale===D.scale&&y.angle===D.angle&&y.zoomRate===D.zoomRate){if(!f.bbox.intersects_rect(q.bbox)||!f.bquad.intersects_quad(q.bquad)||f.tilemap_exists&&q.tilemap_exists)return!1;if(f.tilemap_exists)return this.testTilemapOverlap(f,q);if(q.tilemap_exists)return this.testTilemapOverlap(q,f);var J=f.collision_poly&&!f.collision_poly.is_empty();var M=q.collision_poly&&!q.collision_poly.is_empty();
if(!J&&!M)return!0;J?(f.collision_poly.cache_poly(f.width,f.height,f.angle),J=f.collision_poly):(this.temp_poly.set_from_quad(f.bquad,f.x,f.y,f.width,f.height),J=this.temp_poly);if(M){q.collision_poly.cache_poly(q.width,q.height,q.angle);var O=q.collision_poly}else this.temp_poly.set_from_quad(q.bquad,q.x,q.y,q.width,q.height),O=this.temp_poly;return J.intersects_poly(O,q.x-f.x,q.y-f.y)}J=f.collision_poly&&!f.collision_poly.is_empty();M=q.collision_poly&&!q.collision_poly.is_empty();J?(f.collision_poly.cache_poly(f.width,
f.height,f.angle),this.temp_poly.set_from_poly(f.collision_poly)):this.temp_poly.set_from_quad(f.bquad,f.x,f.y,f.width,f.height);J=this.temp_poly;M?(q.collision_poly.cache_poly(q.width,q.height,q.angle),this.temp_poly2.set_from_poly(q.collision_poly)):this.temp_poly2.set_from_quad(q.bquad,q.x,q.y,q.width,q.height);O=this.temp_poly2;M=0;for(w=J.pts_count;M<w;M++){var P=2*M;var X=P+1;var W=J.pts_cache[P];var U=J.pts_cache[X];J.pts_cache[P]=y.layerToCanvas(W+f.x,U+f.y,!0);J.pts_cache[X]=y.layerToCanvas(W+
f.x,U+f.y,!1)}J.update_bbox();M=0;for(w=O.pts_count;M<w;M++)P=2*M,X=P+1,W=O.pts_cache[P],U=O.pts_cache[X],O.pts_cache[P]=D.layerToCanvas(W+q.x,U+q.y,!0),O.pts_cache[X]=D.layerToCanvas(W+q.x,U+q.y,!1);O.update_bbox();return J.intersects_poly(O,0,0)};var G=new cr$$module$str$c3runtime.quad,I=new cr$$module$str$c3runtime.rect(0,0,0,0),R=[];b.prototype.testTilemapOverlap=function(f,q){var y,D=q.bbox,w=f.x,J=f.y;f.getCollisionRectCandidates(D,R);var M=q.collision_poly&&!q.collision_poly.is_empty();f=0;
for(y=R.length;f<y;++f){var O=R[f];var P=O.rc;if(D.intersects_rect_off(P,w,J)&&(G.set_from_rect(P),G.offset(w,J),G.intersects_quad(q.bquad)))if(M)if(q.collision_poly.cache_poly(q.width,q.height,q.angle),O.poly){if(O.poly.intersects_poly(q.collision_poly,q.x-(w+P.left),q.y-(J+P.top)))return cr$$module$str$c3runtime.clearArray(R),!0}else{if(this.temp_poly.set_from_quad(G,0,0,P.right-P.left,P.bottom-P.top),this.temp_poly.intersects_poly(q.collision_poly,q.x,q.y))return cr$$module$str$c3runtime.clearArray(R),
!0}else if(O.poly){if(this.temp_poly.set_from_quad(q.bquad,0,0,q.width,q.height),O.poly.intersects_poly(this.temp_poly,-(w+P.left),-(J+P.top)))return cr$$module$str$c3runtime.clearArray(R),!0}else return cr$$module$str$c3runtime.clearArray(R),!0}cr$$module$str$c3runtime.clearArray(R);return!1};b.prototype.testRectOverlap=function(f,q){if(!q||!q.collisionsEnabled)return!1;q.update_bbox();if(!q.bbox.intersects_rect(f))return!1;if(q.tilemap_exists){q.getCollisionRectCandidates(f,R);var y,D=q.x,w=q.y;
q=0;for(y=R.length;q<y;++q){var J=R[q];var M=J.rc;if(f.intersects_rect_off(M,D,w))if(J.poly){if(this.temp_poly.set_from_rect(f,0,0),J.poly.intersects_poly(this.temp_poly,-(D+M.left),-(w+M.top)))return cr$$module$str$c3runtime.clearArray(R),!0}else return cr$$module$str$c3runtime.clearArray(R),!0}cr$$module$str$c3runtime.clearArray(R);return!1}G.set_from_rect(f);if(!q.bquad.intersects_quad(G))return!1;if(!q.collision_poly||q.collision_poly.is_empty())return!0;q.collision_poly.cache_poly(q.width,q.height,
q.angle);G.offset(-f.left,-f.top);this.temp_poly.set_from_quad(G,0,0,1,1);return q.collision_poly.intersects_poly(this.temp_poly,f.left-q.x,f.top-q.y)};b.prototype.testSegmentOverlap=function(f,q,y,D,w){if(!w||!w.collisionsEnabled)return!1;w.update_bbox();I.set(cr$$module$str$c3runtime.min(f,y),cr$$module$str$c3runtime.min(q,D),cr$$module$str$c3runtime.max(f,y),cr$$module$str$c3runtime.max(q,D));if(!w.bbox.intersects_rect(I))return!1;if(w.tilemap_exists){w.getCollisionRectCandidates(I,R);var J,M=
w.x,O=w.y;w=0;for(J=R.length;w<J;++w){var P=R[w];var X=P.rc;if(I.intersects_rect_off(X,M,O)&&(G.set_from_rect(X),G.offset(M,O),G.intersects_segment(f,q,y,D)))if(P.poly){if(P.poly.intersects_segment(M+X.left,O+X.top,f,q,y,D))return cr$$module$str$c3runtime.clearArray(R),!0}else return cr$$module$str$c3runtime.clearArray(R),!0}cr$$module$str$c3runtime.clearArray(R);return!1}if(!w.bquad.intersects_segment(f,q,y,D))return!1;if(!w.collision_poly||w.collision_poly.is_empty())return!0;w.collision_poly.cache_poly(w.width,
w.height,w.angle);return w.collision_poly.intersects_segment(w.x,w.y,f,q,y,D)};b.prototype.typeHasBehavior=function(f,q){if(!q)return!1;var y,D;var w=0;for(y=f.behaviors.length;w<y;w++)if(f.behaviors[w].behavior instanceof q)return!0;if(!f.is_family)for(w=0,y=f.families.length;w<y;w++){var J=f.families[w];var M=0;for(D=J.behaviors.length;M<D;M++)if(J.behaviors[M].behavior instanceof q)return!0}return!1};b.prototype.typeHasNoSaveBehavior=function(f){return this.typeHasBehavior(f,cr$$module$str$c3runtime.behaviors.NoSave)};
b.prototype.typeHasPersistBehavior=function(f){return this.typeHasBehavior(f,cr$$module$str$c3runtime.behaviors.Persist)};b.prototype.getSolidBehavior=function(){return this.solidBehavior};b.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var S=[];b.prototype.testOverlapSolid=function(f){var q;f.update_bbox();this.getSolidCollisionCandidates(f.layer,f.bbox,S);var y=0;for(q=S.length;y<q;++y){var D=S[y];if(D.extra.solidEnabled&&this.testOverlap(f,D))return cr$$module$str$c3runtime.clearArray(S),
D}cr$$module$str$c3runtime.clearArray(S);return null};b.prototype.testRectOverlapSolid=function(f){var q;this.getSolidCollisionCandidates(null,f,S);var y=0;for(q=S.length;y<q;++y){var D=S[y];if(D.extra.solidEnabled&&this.testRectOverlap(f,D))return cr$$module$str$c3runtime.clearArray(S),D}cr$$module$str$c3runtime.clearArray(S);return null};var V=[];b.prototype.testOverlapJumpThru=function(f,q){var y=null;q&&(y=V,cr$$module$str$c3runtime.clearArray(y));f.update_bbox();this.getJumpthruCollisionCandidates(f.layer,
f.bbox,S);var D;var w=0;for(D=S.length;w<D;++w){var J=S[w];if(J.extra.jumpthruEnabled&&this.testOverlap(f,J))if(q)y.push(J);else return cr$$module$str$c3runtime.clearArray(S),J}cr$$module$str$c3runtime.clearArray(S);return y};b.prototype.pushOutSolid=function(f,q,y,D,w,J){D=D||50;var M=f.x,O=f.y,P,X=null,W=null;for(P=0;P<D;P++)if(f.x=M+q*P,f.y=O+y*P,f.set_bbox_changed(),!this.testOverlap(f,X)&&((X=this.testOverlapSolid(f))&&(W=X),!X&&(w&&(X=J?this.testOverlap(f,J)?J:null:this.testOverlapJumpThru(f))&&
(W=X),!X)))return W&&this.pushInFractional(f,q,y,W,16),!0;f.x=M;f.y=O;f.set_bbox_changed();return!1};b.prototype.pushOutSolidAxis=function(f,q,y,D){D=D||50;var w=f.x,J=f.y,M=null,O=null,P,X;for(P=0;P<D;++P)for(X=0;2>X;++X){var W=2*X-1;f.x=w+q*P*W;f.y=J+y*P*W;f.set_bbox_changed();if(!this.testOverlap(f,M))if(M=this.testOverlapSolid(f))O=M;else return O&&this.pushInFractional(f,q*W,y*W,O,16),!0}f.x=w;f.y=J;f.set_bbox_changed();return!1};b.prototype.pushOut=function(f,q,y,D,w){D=D||50;var J=f.x,M=f.y,
O;for(O=0;O<D;O++)if(f.x=J+q*O,f.y=M+y*O,f.set_bbox_changed(),!this.testOverlap(f,w))return!0;f.x=J;f.y=M;f.set_bbox_changed();return!1};b.prototype.pushInFractional=function(f,q,y,D,w){var J=2,M=!1;var O=!1;for(var P=f.x,X=f.y;J<=w;)O=1/J,J*=2,f.x+=q*O*(M?1:-1),f.y+=y*O*(M?1:-1),f.set_bbox_changed(),this.testOverlap(f,D)?O=M=!0:(O=M=!1,P=f.x,X=f.y);O&&(f.x=P,f.y=X,f.set_bbox_changed())};b.prototype.pushOutSolidNearest=function(f,q){q=cr$$module$str$c3runtime.is_undefined(q)?100:q;var y=0,D=f.x,w=
f.y,J=0,M=0,O=0,P=this.testOverlapSolid(f);if(!P)return!0;for(;y<=q;){switch(J){case 0:M=0;O=-1;y++;break;case 1:M=1;O=-1;break;case 2:M=1;O=0;break;case 3:O=M=1;break;case 4:M=0;O=1;break;case 5:M=-1;O=1;break;case 6:M=-1;O=0;break;case 7:O=M=-1}J=(J+1)%8;f.x=cr$$module$str$c3runtime.floor(D+M*y);f.y=cr$$module$str$c3runtime.floor(w+O*y);f.set_bbox_changed();if(!this.testOverlap(f,P)&&(P=this.testOverlapSolid(f),!P))return!0}f.x=D;f.y=w;f.set_bbox_changed();return!1};b.prototype.registerCollision=
function(f,q){f.collisionsEnabled&&q.collisionsEnabled&&this.registered_collisions.push([f,q])};b.prototype.addRegisteredCollisionCandidates=function(f,q,y){var D;var w=0;for(D=this.registered_collisions.length;w<D;++w){var J=this.registered_collisions[w];if(J[0]===f)J=J[1];else if(J[1]===f)J=J[0];else continue;if(q.is_family){if(-1===q.members.indexOf(q))continue}else if(J.type!==q)continue;-1===y.indexOf(J)&&y.push(J)}};b.prototype.checkRegisteredCollision=function(f,q){var y;var D=0;for(y=this.registered_collisions.length;D<
y;D++){var w=this.registered_collisions[D];if(w[0]===f&&w[1]===q||w[0]===q&&w[1]===f)return!0}return!1};b.prototype.calculateSolidBounceAngle=function(f,q,y,D){var w=f.x,J=f.y,M=cr$$module$str$c3runtime.max(10,cr$$module$str$c3runtime.distanceTo(q,y,w,J)),O=cr$$module$str$c3runtime.angleTo(q,y,w,J),P=D||this.testOverlapSolid(f);if(!P)return cr$$module$str$c3runtime.clamp_angle(O+cr$$module$str$c3runtime.PI);var X=P,W,U=cr$$module$str$c3runtime.to_radians(5);for(W=1;36>W;W++){var Y=O-W*U;f.x=q+Math.cos(Y)*
M;f.y=y+Math.sin(Y)*M;f.set_bbox_changed();if(!this.testOverlap(f,X)&&(X=D?null:this.testOverlapSolid(f),!X)){var ba=Y;break}}36===W&&(ba=cr$$module$str$c3runtime.clamp_angle(O+cr$$module$str$c3runtime.PI));X=P;for(W=1;36>W;W++)if(Y=O+W*U,f.x=q+Math.cos(Y)*M,f.y=y+Math.sin(Y)*M,f.set_bbox_changed(),!this.testOverlap(f,X)&&(X=D?null:this.testOverlapSolid(f),!X)){var ca=Y;break}36===W&&(ca=cr$$module$str$c3runtime.clamp_angle(O+cr$$module$str$c3runtime.PI));f.x=w;f.y=J;f.set_bbox_changed();if(ca===
ba)return ca;f=cr$$module$str$c3runtime.angleDiff(ca,ba)/2;f=cr$$module$str$c3runtime.angleClockwise(ca,ba)?cr$$module$str$c3runtime.clamp_angle(ba+f+cr$$module$str$c3runtime.PI):cr$$module$str$c3runtime.clamp_angle(ca+f);ba=Math.cos(O);O=Math.sin(O);ca=Math.cos(f);f=Math.sin(f);q=ba*ca+O*f;return cr$$module$str$c3runtime.angleTo(0,0,ba-2*q*ca,O-2*q*f)};var T=-1;b.prototype.trigger=function(f,q,y){if(!this.running_layout)return!1;var D=this.running_layout.event_sheet;if(!D)return!1;var w=!1,J;T++;
var M=D.deep_includes;var O=0;for(J=M.length;O<J;++O){var P=this.triggerOnSheet(f,q,M[O],y);w=w||P}P=this.triggerOnSheet(f,q,D,y);T--;return w||P};b.prototype.triggerOnSheet=function(f,q,y,D){var w=!1,J;if(q){var M=this.triggerOnSheetForTypeName(f,q,q.type.name,y,D);w=w||M;var O=q.type.families;var P=0;for(J=O.length;P<J;++P)M=this.triggerOnSheetForTypeName(f,q,O[P].name,y,D),w=w||M}else M=this.triggerOnSheetForTypeName(f,q,"system",y,D),w=w||M;return w};b.prototype.triggerOnSheetForTypeName=function(f,
q,y,D,w){var J,M=!1;var O="undefined"!==typeof w;var P=(O?D.fasttriggers:D.triggers)[y];if(!P)return M;var X=null;D=0;for(J=P.length;D<J;++D)if(P[D].method==f){X=P[D].evs;break}if(!X)return M;f=O?X[w]:X;if(!f)return null;D=0;for(J=f.length;D<J;D++)w=f[D][0],O=f[D][1],w=this.executeSingleTrigger(q,y,w,O),M=M||w;return M};b.prototype.executeSingleTrigger=function(f,q,y,D){var w,J=!1;this.trigger_depth++;var M=this.getCurrentEventStack().current_event;M&&this.pushCleanSol(M.solModifiersIncludingParents);
var O=1<this.trigger_depth;this.pushCleanSol(y.solModifiersIncludingParents);O&&this.pushLocalVarStack();var P=this.pushEventStack(y);P.current_event=y;if(f){var X=this.types[q].getCurrentSol();X.select_all=!1;cr$$module$str$c3runtime.clearArray(X.instances);X.instances[0]=f;this.types[q].applySolToContainer()}f=!0;if(y.parent){q=P.temp_parents_arr;for(X=y.parent;X;)q.push(X),X=X.parent;q.reverse();X=0;for(w=q.length;X<w;X++)if(!q[X].run_pretrigger()){f=!1;break}}f&&(this.execcount++,y.orblock?y.run_orblocktrigger(D):
y.run(),J=J||P.last_event_true);this.popEventStack();O&&this.popLocalVarStack();this.popSol(y.solModifiersIncludingParents);M&&this.popSol(M.solModifiersIncludingParents);this.hasPendingInstances&&0===this.isInOnDestroy&&0===T&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return J};b.prototype.getCurrentCondition=function(){var f=this.getCurrentEventStack();return f.current_event.conditions[f.cndindex]};b.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};
b.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};b.prototype.getCurrentAction=function(){var f=this.getCurrentEventStack();return f.current_event.actions[f.actindex]};b.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};b.prototype.popLocalVarStack=function(){this.localvar_stack_index--};b.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};
b.prototype.pushEventStack=function(f){this.event_stack_index++;this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr$$module$str$c3runtime.eventStackFrame);var q=this.getCurrentEventStack();q.reset(f);return q};b.prototype.popEventStack=function(){this.event_stack_index--};b.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};b.prototype.pushLoopStack=function(f){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&
this.loop_stack.push(cr$$module$str$c3runtime.seal({name:f,index:0,stopped:!1}));var q=this.getCurrentLoop();q.name=f;q.index=0;q.stopped=!1;return q};b.prototype.popLoopStack=function(){this.loop_stack_index--};b.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]};b.prototype.getEventVariableByName=function(f,q){for(var y,D,w,J,M;q;){y=0;for(D=q.subevents.length;y<D;y++)if(M=q.subevents[y],M instanceof cr$$module$str$c3runtime.eventvariable&&cr$$module$str$c3runtime.equals_nocase(f,
M.name))return M;q=q.parent}y=0;for(D=this.eventsheets_by_index.length;y<D;y++)for(J=this.eventsheets_by_index[y],q=0,w=J.events.length;q<w;q++)if(M=J.events[q],M instanceof cr$$module$str$c3runtime.eventvariable&&cr$$module$str$c3runtime.equals_nocase(f,M.name))return M;return null};b.prototype.getLayoutBySid=function(f){var q;var y=0;for(q=this.layouts_by_index.length;y<q;y++)if(this.layouts_by_index[y].sid===f)return this.layouts_by_index[y];return null};b.prototype.getObjectTypeBySid=function(f){var q;
var y=0;for(q=this.types_by_index.length;y<q;y++)if(this.types_by_index[y].sid===f)return this.types_by_index[y];return null};b.prototype.getGroupBySid=function(f){var q;var y=0;for(q=this.allGroups.length;y<q;y++)if(this.allGroups[y].sid===f)return this.allGroups[y];return null};b.prototype.requirePermissions=function(f){return this.getPermissions(f).then(function(q){if(!1===q)return Promise.reject("Permission not granted")})};b.prototype.getPermissions=function(f){return this.isCordova&&this.isAndroid?
f.reduce(function(q,y){return q.then(function(D){return!1===D?!1:A(y).then(function(w){return w?!0:v(y)})})},Promise.resolve(!0)):Promise.resolve(!0)};b.prototype.doCanvasSnapshot=function(f,q){this.snapshotCanvas=[f,q];this.redraw=!0};b.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};b.prototype.handleSaveLoad=function(){var f=this,q=this.saveToSlot,y=this.lastSaveJson,D=this.loadFromSlot,w=!1;this.signalledContinuousPreview&&(w=!0,q="__c2_continuouspreview",this.signalledContinuousPreview=
!1);if(q.length){this.ClearDeathRow();y=this.saveToJSONString();if(L())n(q,y,function(){cr$$module$str$c3runtime.logexport("Saved state to IndexedDB storage ("+y.length+" bytes)");f.lastSaveJson=y;f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnSaveComplete,null);y=f.lastSaveJson="";w&&c()},function(J){try{localStorage.setItem("__c2save_"+q,y),cr$$module$str$c3runtime.logexport("Saved state to WebStorage ("+y.length+" bytes)"),f.lastSaveJson=y,f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnSaveComplete,
null),y=f.lastSaveJson="",w&&c()}catch(M){cr$$module$str$c3runtime.logexport("Failed to save game state: "+J+"; "+M),f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+q,y),cr$$module$str$c3runtime.logexport("Saved state to WebStorage ("+y.length+" bytes)"),f.lastSaveJson=y,this.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnSaveComplete,null),y=f.lastSaveJson="",w&&c()}catch(J){cr$$module$str$c3runtime.logexport("Error saving to WebStorage: "+
J),f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(D.length){if(L())a(D,function(J){J?(f.loadFromJson=J,cr$$module$str$c3runtime.logexport("Loaded state from IndexedDB storage ("+f.loadFromJson.length+" bytes)")):(f.loadFromJson=localStorage.getItem("__c2save_"+D)||"",cr$$module$str$c3runtime.logexport("Loaded state from WebStorage ("+f.loadFromJson.length+" bytes)"));f.suspendDrawing=!1;f.loadFromJson||
(f.loadFromJson=null,f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadFailed,null))},function(J){f.loadFromJson=localStorage.getItem("__c2save_"+D)||"";cr$$module$str$c3runtime.logexport("Loaded state from WebStorage ("+f.loadFromJson.length+" bytes)");f.suspendDrawing=!1;f.loadFromJson||(f.loadFromJson=null,f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadFailed,null))});else{try{this.loadFromJson=localStorage.getItem("__c2save_"+D)||"",cr$$module$str$c3runtime.logexport("Loaded state from WebStorage ("+
this.loadFromJson.length+" bytes)")}catch(J){this.loadFromJson=null}this.suspendDrawing=!1;f.loadFromJson||(f.loadFromJson=null,f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadComplete,null),this.lastSaveJson=""):f.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLoadFailed,
null),this.loadFromJson=null)};b.prototype.saveToJSONString=function(){var f,q,y,D={c2save:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var w=0;for(f=this.types_by_index.length;w<f;w++){var J=this.types_by_index[w];if(!J.is_family&&
!this.typeHasNoSaveBehavior(J)){var M={instances:[]};cr$$module$str$c3runtime.hasAnyOwnProperty(J.extra)&&(M.ex=h(J.extra));var O=0;for(q=J.instances.length;O<q;O++)M.instances.push(this.saveInstanceToJSON(J.instances[O]));D.types[J.sid.toString()]=M}}w=0;for(f=this.layouts_by_index.length;w<f;w++)O=this.layouts_by_index[w],D.layouts[O.sid.toString()]=O.saveToJSON();q=D.events.groups;w=0;for(f=this.allGroups.length;w<f;w++)O=this.allGroups[w],q[O.sid.toString()]=this.groups_by_name[O.group_name].group_active;
f=D.events.cnds;for(y in this.cndsBySid)this.cndsBySid.hasOwnProperty(y)&&(w=this.cndsBySid[y],cr$$module$str$c3runtime.hasAnyOwnProperty(w.extra)&&(f[y]={ex:h(w.extra)}));f=D.events.acts;for(y in this.actsBySid)this.actsBySid.hasOwnProperty(y)&&(w=this.actsBySid[y],cr$$module$str$c3runtime.hasAnyOwnProperty(w.extra)&&(f[y]={ex:h(w.extra)}));f=D.events.vars;for(y in this.varsBySid)this.varsBySid.hasOwnProperty(y)&&(w=this.varsBySid[y],w.is_constant||w.parent&&!w.is_static||(f[y]=w.data));D.system=
this.system.saveToJSON();return JSON.stringify(D)};b.prototype.refreshUidMap=function(){var f,q;this.objectsByUid={};var y=0;for(f=this.types_by_index.length;y<f;y++){var D=this.types_by_index[y];if(!D.is_family){var w=0;for(q=D.instances.length;w<q;w++){var J=D.instances[w];this.objectsByUid[J.uid.toString()]=J}}}};b.prototype.loadFromJSONString=function(f){try{var q=JSON.parse(f)}catch(W){return!1}if(!q.c2save||1<q.version)return!1;this.isLoadingState=!0;f=q.rt;this.kahanTime.reset();this.kahanTime.sum=
f.time;this.wallTime.reset();this.wallTime.sum=f.walltime||0;this.timescale=f.timescale;this.tickcount=f.tickcount;this.execcount=f.execcount;this.start_time=Date.now()-f.start_time_offset;var y=f.running_layout;if(y!==this.running_layout.sid)if(y=this.getLayoutBySid(y))this.doChangeLayout(y);else return;var D,w,J;var M=q.types;for(w in M)if(M.hasOwnProperty(w)&&(J=this.getObjectTypeBySid(parseInt(w,10)))&&!J.is_family&&!this.typeHasNoSaveBehavior(J)){M[w].ex?J.extra=M[w].ex:cr$$module$str$c3runtime.wipe(J.extra);
var O=J.instances;var P=M[w].instances;y=0;for(D=cr$$module$str$c3runtime.min(O.length,P.length);y<D;y++)this.loadInstanceFromJSON(O[y],P[y]);y=P.length;for(D=O.length;y<D;y++)this.DestroyInstance(O[y]);y=O.length;for(D=P.length;y<D;y++){O=null;if(J.plugin.is_world&&(O=this.running_layout.getLayerBySid(P[y].w.l),!O))continue;O=this.createInstanceFromInit(J.default_instance,O,!1,0,0,!0);this.loadInstanceFromJSON(O,P[y])}J.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();D=q.layouts;for(w in D)D.hasOwnProperty(w)&&
(y=this.getLayoutBySid(parseInt(w,10)))&&y.loadFromJSON(D[w]);D=q.events.groups;for(w in D)D.hasOwnProperty(w)&&(y=this.getGroupBySid(parseInt(w,10)))&&this.groups_by_name[y.group_name]&&this.groups_by_name[y.group_name].setGroupActive(D[w]);y=q.events.cnds;for(w in this.cndsBySid)this.cndsBySid.hasOwnProperty(w)&&(y.hasOwnProperty(w)?this.cndsBySid[w].extra=y[w].ex:this.cndsBySid[w].extra={});y=q.events.acts;for(w in this.actsBySid)this.actsBySid.hasOwnProperty(w)&&(y.hasOwnProperty(w)?this.actsBySid[w].extra=
y[w].ex:this.actsBySid[w].extra={});y=q.events.vars;for(w in y)y.hasOwnProperty(w)&&this.varsBySid.hasOwnProperty(w)&&(this.varsBySid[w].data=y[w]);this.next_uid=f.next_uid;this.isLoadingState=!1;y=0;for(D=this.fireOnCreateAfterLoad.length;y<D;++y)O=this.fireOnCreateAfterLoad[y],this.trigger(Object.getPrototypeOf(O.type.plugin).cnds.OnCreated,O);cr$$module$str$c3runtime.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(q.system);y=0;for(D=this.types_by_index.length;y<D;y++)if(J=this.types_by_index[y],
!J.is_family&&!this.typeHasNoSaveBehavior(J))for(q=0,w=J.instances.length;q<w;q++){O=J.instances[q];if(J.is_contained)for(M=O.get_iid(),cr$$module$str$c3runtime.clearArray(O.siblings),f=0,P=J.container.length;f<P;f++){var X=J.container[f];J!==X&&O.siblings.push(X.instances[M])}O.afterLoad&&O.afterLoad();if(O.behavior_insts)for(f=0,P=O.behavior_insts.length;f<P;f++)M=O.behavior_insts[f],M.afterLoad&&M.afterLoad()}return this.redraw=!0};b.prototype.saveInstanceToJSON=function(f,q){var y;var D=f.type;
var w=D.plugin;var J={};q?J.c2=!0:J.uid=f.uid;cr$$module$str$c3runtime.hasAnyOwnProperty(f.extra)&&(J.ex=h(f.extra));if(f.instance_vars&&f.instance_vars.length)for(J.ivs={},q=0,y=f.instance_vars.length;q<y;q++)J.ivs[f.type.instvar_sids[q].toString()]=f.instance_vars[q];if(w.is_world){w={x:f.x,y:f.y,w:f.width,h:f.height,l:f.layer.sid,zi:f.get_zindex()};0!==f.angle&&(w.a=f.angle);1!==f.opacity&&(w.o=f.opacity);.5!==f.hotspotX&&(w.hX=f.hotspotX);.5!==f.hotspotY&&(w.hY=f.hotspotY);0!==f.blend_mode&&(w.bm=
f.blend_mode);f.visible||(w.v=f.visible);f.collisionsEnabled||(w.ce=f.collisionsEnabled);-1!==f.my_timescale&&(w.mts=f.my_timescale);if(D.effect_types.length)for(w.fx=[],q=0,y=D.effect_types.length;q<y;q++){var M=D.effect_types[q];w.fx.push({name:M.name,active:f.active_effect_flags[M.index],params:f.effect_params[M.index]})}J.w=w}if(f.behavior_insts&&f.behavior_insts.length)for(J.behs={},q=0,y=f.behavior_insts.length;q<y;q++)D=f.behavior_insts[q],D.saveToJSON&&(J.behs[D.type.sid.toString()]=D.saveToJSON());
f.saveToJSON&&(J.data=f.saveToJSON());return J};b.prototype.getInstanceVarIndexBySid=function(f,q){var y;var D=0;for(y=f.instvar_sids.length;D<y;D++)if(f.instvar_sids[D]===q)return D;return-1};b.prototype.getBehaviorIndexBySid=function(f,q){var y;var D=0;for(y=f.behavior_insts.length;D<y;D++)if(f.behavior_insts[D].type.sid===q)return D;return-1};b.prototype.loadInstanceFromJSON=function(f,q,y){var D,w;var J=f.type;var M=J.plugin;if(y){if(!q.c2)return}else f.uid=q.uid;q.ex?f.extra=q.ex:cr$$module$str$c3runtime.wipe(f.extra);
if(w=q.ivs)for(D in w)if(w.hasOwnProperty(D)){var O=this.getInstanceVarIndexBySid(J,parseInt(D,10));if(!(0>O||O>=f.instance_vars.length)){var P=w[D];null===P&&(P=NaN);f.instance_vars[O]=P}}if(M.is_world){O=q.w;f.layer.sid!==O.l&&(w=f.layer,f.layer=this.running_layout.getLayerBySid(O.l),f.layer?(w.removeFromInstanceList(f,!0),f.layer.appendToInstanceList(f,!0),f.set_bbox_changed(),f.layer.setZIndicesStaleFrom(0)):(f.layer=w,y||this.DestroyInstance(f)));f.x=O.x;f.y=O.y;f.width=O.w;f.height=O.h;f.zindex=
O.zi;f.angle=O.hasOwnProperty("a")?O.a:0;f.opacity=O.hasOwnProperty("o")?O.o:1;f.hotspotX=O.hasOwnProperty("hX")?O.hX:.5;f.hotspotY=O.hasOwnProperty("hY")?O.hY:.5;f.visible=O.hasOwnProperty("v")?O.v:!0;f.collisionsEnabled=O.hasOwnProperty("ce")?O.ce:!0;f.my_timescale=O.hasOwnProperty("mts")?O.mts:-1;f.blend_mode=O.hasOwnProperty("bm")?O.bm:0;f.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(f.blend_mode);this.gl&&cr$$module$str$c3runtime.setGLBlend(f,f.blend_mode,this.gl);f.set_bbox_changed();
if(O.hasOwnProperty("fx"))for(y=0,w=O.fx.length;y<w;y++)P=J.getEffectIndexByName(O.fx[y].name),0>P||(f.active_effect_flags[P]=O.fx[y].active,f.effect_params[P]=O.fx[y].params);f.updateActiveEffects()}if(J=q.behs)for(D in J)J.hasOwnProperty(D)&&(y=this.getBehaviorIndexBySid(f,parseInt(D,10)),0>y||f.behavior_insts[y].loadFromJSON(J[D]));q.data&&f.loadFromJSON(q.data)};b.prototype.getProjectFileUrl=function(f){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(f.toLowerCase())?window.cr_previewProjectFiles[f.toLowerCase()]:
f:this.files_subfolder+f};b.prototype.getProjectFileBlob=function(f){return this.isPreview?window.cr_previewProjectFileBlobs&&window.cr_previewProjectFiles.hasOwnProperty(f.toLowerCase())?window.cr_previewProjectFileBlobs[f.toLowerCase()]:null:null};b.prototype.getLocalFileUrl=function(f){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(f.toLowerCase())?window.cr_previewProjectFiles[f.toLowerCase()]:f:f};b.prototype.fetchLocalFileViaCordova=function(f,q,y){window.resolveLocalFileSystemURL(window.cordova.file.applicationDirectory+
"www/"+f,function(D){D.file(q,y)},y)};b.prototype.fetchLocalFileViaCordovaAsText=function(f,q,y){this.fetchLocalFileViaCordova(f,function(D){var w=new FileReader;w.onload=function(J){q(J.target.result)};w.onerror=y;w.readAsText(D)},y)};var Z=[],aa=0;b.prototype.maybeStartNextArrayBufferRead=function(){if(Z.length&&!(8<=aa)){aa++;var f=Z.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(f.filename,f.successCallback,f.errorCallback)}};b.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(f,
q,y){var D=this;Z.push({filename:f,successCallback:function(w){aa--;D.maybeStartNextArrayBufferRead();q(w)},errorCallback:function(w){aa--;D.maybeStartNextArrayBufferRead();y(w)}});this.maybeStartNextArrayBufferRead()};b.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(f,q,y){this.fetchLocalFileViaCordova(f,function(D){var w=new FileReader;w.onload=function(J){q(J.target.result)};w.readAsArrayBuffer(D)},y)};b.prototype.fetchLocalFileViaCordovaAsURL=function(f,q,y){var D="",w=f.toLowerCase(),
J=w.substr(w.length-4);w=w.substr(w.length-5);".mp4"===J?D="video/mp4":".webm"===w?D="video/webm":".m4a"===J?D="audio/mp4":".mp3"===J&&(D="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(f,function(M){M=new Blob([M],{type:D});M=URL.createObjectURL(M);q(M)},y)};b.prototype.isAbsoluteUrl=function(f){return/^(?:[a-z]+:)?\/\//.test(f)||"data:"===f.substr(0,5)||"blob:"===f.substr(0,5)};b.prototype.setImageSrc=function(f,q){this.isWKWebView&&!this.isAbsoluteUrl(q)?this.fetchLocalFileViaCordovaAsURL(q,
function(y){f.src=y},function(y){alert("Failed to load image: "+y)}):this.isPreview&&!this.isAbsoluteUrl(q)?f.src=this.getLocalFileUrl(q):(this.isAbsoluteUrl(q)||(q=q.toLowerCase()),f.src=q)};b.prototype.getPreferredAudioFile=function(f){f=f.toLowerCase();if(!this.audio_files_map.hasOwnProperty(f))return null;f=this.audio_files_map[f];var q=null,y;var D=0;for(y=f.length;D<y;++D){var w=f[D];var J=w[0];q||"audio/webm; codecs=opus"!==J||(q=w);if(t[J])return w}return q};b.prototype.getProjectAudioFileUrl=
function(f){var q=f.toLowerCase();return(f=this.getPreferredAudioFile(f))?{url:this.getProjectFileUrl(q+f[1]),type:f[0]}:null};b.prototype.getStatusInfo=function(){return{fps:this.fps,cpu:this.cpuutilisation/1E3,gpu:this.gpuLastUtilisation,layout:this.running_layout?this.running_layout.name:"",renderer:this.glUnmaskedRenderer}};b.prototype.accelerate=function(f,q,y,D,w){return this.enhancedAccelerationPrecision?cr$$module$str$c3runtime.clamp(f*w+.5*D*w*w,q*w,y*w):f*w};cr$$module$str$c3runtime.runtime=
b;cr$$module$str$c3runtime.createRuntime=function(f){return new b(f)};window.cr_createRuntime=cr$$module$str$c3runtime.createRuntime})();window.cr_getSnapshot=function(b,l){var v=window.c3runtime;v&&v.doCanvasSnapshot(b,l)};window.cr_sizeCanvas=function(b,l){if(0!==b&&0!==l){var v=window.c3runtime;v&&v.setSize(b,l)}};window.cr_setSuspended=function(b){var l=window.c3runtime;l&&l.setSuspended(b)};
(function(){function b(a,c){return a.zindex-c.zindex}function l(a,c){this.layout=a;this.runtime=a.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr$$module$str$c3runtime.rect(0,0,0,0);this.tmpquad=new cr$$module$str$c3runtime.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=c[0];this.index=c[1];this.sid=c[2];this.visible=c[3];this.background_color=c[4];
this.transparent=c[5];this.parallaxX=c[6];this.parallaxY=c[7];this.opacity=c[8];this.forceOwnTexture=c[9];this.useRenderCells=c[10];this.zoomRate=c[11];this.blend_mode=c[12];this.effect_fallback=c[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=v();this.render_list_stale=!0;this.last_render_cells=new cr$$module$str$c3runtime.rect(0,0,-1,-1);this.cur_render_cells=new cr$$module$str$c3runtime.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=
new cr$$module$str$c3runtime.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=!1;a=c[14];var h;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var p=0;for(h=a.length;p<h;p++){var m=a[p],t=this.runtime.types_by_index[m[1]];t.default_instance||(t.default_instance=m,t.default_layerindex=this.index);this.initial_instances.push(m);-1===this.layout.initial_types.indexOf(t)&&this.layout.initial_types.push(t)}cr$$module$str$c3runtime.shallowAssignArray(this.startup_initial_instances,
this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];p=0;for(h=c[15].length;p<h;p++)this.effect_types.push({id:c[15][p][0],name:c[15][p][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:p}),this.effect_params.push(c[15][p][2].slice(0));this.updateActiveEffects();this.rcTexBounce=new cr$$module$str$c3runtime.rect(0,0,1,1);this.rcTexDest=new cr$$module$str$c3runtime.rect(0,0,1,1);this.rcTexOrigin=new cr$$module$str$c3runtime.rect(0,
0,1,1)}function v(){return L.length?L.pop():[]}function A(a){cr$$module$str$c3runtime.clearArray(a);L.push(a)}l.prototype.updateActiveEffects=function(){cr$$module$str$c3runtime.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var a;var c=0;for(a=this.effect_types.length;c<a;c++){var h=this.effect_types[c];h.active&&(this.active_effect_types.push(h),h.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};l.prototype.getEffectByName=function(a){var c;var h=0;for(c=this.effect_types.length;h<
c;h++){var p=this.effect_types[h];if(p.name===a)return p}return null};l.prototype.createInitialInstances=function(a){var c,h;var p=c=0;for(h=this.initial_instances.length;c<h;c++){var m=this.initial_instances[c];var t=this.runtime.types_by_index[m[1]];var E=this.runtime.typeHasPersistBehavior(t);t=!0;if(!E||this.layout.first_visit){m=this.runtime.createInstanceFromInit(m,this,!0);if(!m)continue;a.push(m);m.type.global&&(t=!1,this.created_globals.push(m.uid))}t&&(this.initial_instances[p]=this.initial_instances[c],
p++)}this.initial_instances.length=p;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(this.blend_mode);this.runtime.gl&&cr$$module$str$c3runtime.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};l.prototype.recreateInitialObjects=function(a,c){var h,p=this.runtime.types_by_index,m=a.is_family,t=a.members;var E=0;for(h=this.initial_instances.length;E<
h;++E){var z=this.initial_instances[E];var H=z[0];var B=H[0];H=H[1];if(c.contains_pt(B,H)){B=p[z[1]];if(B!==a)if(m){if(0>t.indexOf(B))continue}else continue;z=this.runtime.createInstanceFromInit(z,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(B.plugin).cnds.OnCreated,z);if(z.is_contained)for(B=0,H=z.siblings.length;B<H;B++){var g=z.siblings[E];this.runtime.trigger(Object.getPrototypeOf(g.type.plugin).cnds.OnCreated,g)}this.runtime.isInOnDestroy--}}};l.prototype.removeFromInstanceList=
function(a,c){var h=cr$$module$str$c3runtime.fastIndexOf(this.instances,a);0>h||(c&&this.useRenderCells&&a.rendercells&&a.rendercells.right>=a.rendercells.left&&(a.update_bbox(),this.render_grid.update(a,a.rendercells,null),a.rendercells.set(0,0,-1,-1)),h===this.instances.length-1?this.instances.pop():(cr$$module$str$c3runtime.arrayRemove(this.instances,h),this.setZIndicesStaleFrom(h)),this.render_list_stale=!0)};l.prototype.appendToInstanceList=function(a,c){a.zindex=this.instances.length;this.instances.push(a);
c&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed();this.render_list_stale=!0};l.prototype.prependToInstanceList=function(a,c){this.instances.unshift(a);this.setZIndicesStaleFrom(0);c&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed()};l.prototype.moveInstanceAdjacent=function(a,c,h){var p=a.get_zindex();c=c.get_zindex();cr$$module$str$c3runtime.arrayRemove(this.instances,p);p<c&&c--;h&&c++;c===this.instances.length?this.instances.push(a):this.instances.splice(c,0,a);this.setZIndicesStaleFrom(p<
c?p:c)};l.prototype.setZIndicesStaleFrom=function(a){-1===this.zindices_stale_from?this.zindices_stale_from=a:a<this.zindices_stale_from&&(this.zindices_stale_from=a);this.render_list_stale=this.zindices_stale=!0};l.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=0);var a;if(this.useRenderCells){var c=this.zindices_stale_from;for(a=this.instances.length;c<a;++c){var h=this.instances[c];h.zindex=c;this.render_grid.markRangeChanged(h.rendercells)}}else for(c=
this.zindices_stale_from,a=this.instances.length;c<a;++c)this.instances[c].zindex=c;this.zindices_stale=!1;this.zindices_stale_from=-1}};l.prototype.getScale=function(a){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||a?this.runtime.aspect_scale:1)};l.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1};l.prototype.getAngle=function(){return this.disableAngle?0:cr$$module$str$c3runtime.clamp_angle(this.layout.angle+this.angle)};var L=[],
K=[],n=[];l.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,n);if(!n.length)return v();if(1===n.length){var a=v();cr$$module$str$c3runtime.shallowAssignArray(a,n[0]);cr$$module$str$c3runtime.clearArray(n);return a}for(var c=!0;1<n.length;){var h;a=n;var p=c;var m=0;for(h=a.length;m<h-1;m+=2){var t=a[m];var E=a[m+1];c=v();var z=t,H=E,B=c,g=0,r=0,x=0,N=z.length,Q=H.length;for(B.length=N+Q;g<
N&&r<Q;++x){var F=z[g];var d=H[r];F.zindex<d.zindex?(B[x]=F,++g):(B[x]=d,++r)}for(;g<N;++g,++x)B[x]=z[g];for(;r<Q;++r,++x)B[x]=H[r];p||(A(t),A(E));K.push(c)}1===h%2&&(p?(t=v(),cr$$module$str$c3runtime.shallowAssignArray(t,a[h-1]),K.push(t)):K.push(a[h-1]));cr$$module$str$c3runtime.shallowAssignArray(a,K);cr$$module$str$c3runtime.clearArray(K);c=!1}a=n[0];cr$$module$str$c3runtime.clearArray(n);return a};l.prototype.draw=function(a){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==
this.blend_mode;var c=this.runtime.canvas,h=a,p=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),c=this.runtime.layer_canvas,c.width=this.runtime.draw_width,c.height=this.runtime.draw_height,this.runtime.layer_ctx=c.getContext("2d"),p=!0),c=this.runtime.layer_canvas,h=this.runtime.layer_ctx,c.width!==this.runtime.draw_width&&(c.width=this.runtime.draw_width,p=!0),c.height!==this.runtime.draw_height&&(c.height=this.runtime.draw_height,
p=!0),p&&(h.imageSmoothingEnabled=this.runtime.linearSampling),this.transparent&&h.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));h.globalAlpha=1;h.globalCompositeOperation="source-over";this.transparent||(h.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",h.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));h.save();this.disableAngle=!0;p=this.canvasToLayer(0,0,!0,!0);var m=this.canvasToLayer(0,0,!1,!0);this.disableAngle=
!1;this.runtime.pixel_rounding&&(p=Math.round(p),m=Math.round(m));this.rotateViewport(p,m,h);var t=this.getScale();h.scale(t,t);h.translate(-p,-m);this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?
(A(this.last_render_list),p=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):p=this.last_render_list):p=this.instances;var E=null;m=0;for(t=p.length;m<t;++m){var z=p[m];z!==E&&(this.drawInstance(z,h),E=z)}this.useRenderCells&&(this.last_render_list=p);h.restore();this.render_offscreen&&(a.globalCompositeOperation=this.compositeOp,a.globalAlpha=this.opacity,a.drawImage(c,0,0))};l.prototype.drawInstance=function(a,c){if(a.visible&&0!==
a.width&&0!==a.height){a.update_bbox();var h=a.bbox;h.right<this.viewLeft||h.bottom<this.viewTop||h.left>this.viewRight||h.top>this.viewBottom||(c.globalCompositeOperation=a.compositeOp,a.draw(c))}};l.prototype.updateViewport=function(a){this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0),h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),h=Math.round(h));this.rotateViewport(c,h,a)};l.prototype.rotateViewport=function(a,c,h){var p=this.getScale();
this.viewLeft=a;this.viewTop=c;this.viewRight=a+1/p*this.runtime.draw_width;this.viewBottom=c+1/p*this.runtime.draw_height;a=this.getAngle();0!==a&&(h&&(h.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),h.rotate(-a),h.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
a),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};l.prototype.drawGL_earlyZPass=function(a){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0),h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),h=Math.round(h));
this.rotateViewport(c,h,null);c=this.getScale();a.resetModelView();a.scale(c,c);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(A(this.last_render_list),c=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):c=this.last_render_list):c=this.instances;var p=null;for(h=c.length-1;0<=h;--h){var m=c[h];m!==p&&(this.drawInstanceGL_earlyZPass(c[h],a),p=m)}this.useRenderCells&&(this.last_render_list=c);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,a.setEarlyZIndex(this.clear_earlyz_index),
a.setColorFillMode(1,1,1,1),a.fullscreenQuad(),a.restoreEarlyZMode())};l.prototype.drawGL=function(a){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&a.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(a.setEarlyZIndex(this.clear_earlyz_index),a.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),a.fullscreenQuad(),a.setTextureFillMode()):a.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0);var h=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),h=Math.round(h));this.rotateViewport(c,h,null);c=this.getScale();a.resetModelView();a.scale(c,c);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(A(this.last_render_list),h=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):h=this.last_render_list):h=this.instances;var p,m=null;if(2.220446049250313E-16<
this.getNormalScale()){var t=0;for(p=h.length;t<p;++t){var E=h[t];E!==m&&(this.drawInstanceGL(h[t],a),m=E)}}this.useRenderCells&&(this.last_render_list=h);this.render_offscreen&&(h=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,t=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!a.programUsesCrossSampling(h)&&1===this.opacity?(1===this.active_effect_types.length?(a.switchProgram(h),
a.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,0,0,1,1,c,this.getAngle(),this.runtime.kahanTime.sum,this.effect_params[t]),a.programIsAnimated(h)&&(this.runtime.redraw=!0)):a.switchProgram(0),a.setRenderingToTexture(this.layout.getRenderTarget()),a.setOpacity(this.opacity),a.setTexture(this.runtime.layer_tex),a.setBlend(this.srcBlend,this.destBlend),a.resetModelView(),
a.updateModelView(),c=this.runtime.draw_width/2,h=this.runtime.draw_height/2,a.quad(-c,h,c,h,c,-h,-c,-h),a.setTexture(null)):this.layout.renderEffectChain(a,this,null,this.layout.getRenderTarget()))};l.prototype.drawInstanceGL=function(a,c){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var h=a.bbox;h.right<this.viewLeft||h.bottom<this.viewTop||h.left>this.viewRight||h.top>this.viewBottom||(c.setEarlyZIndex(a.earlyz_index),a.uses_shaders?this.drawInstanceWithShadersGL(a,c):(c.switchProgram(0),
c.setBlend(a.srcBlend,a.destBlend),a.drawGL(c)))}};l.prototype.drawInstanceGL_earlyZPass=function(a,c){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var h=a.bbox;h.right<this.viewLeft||h.bottom<this.viewTop||h.left>this.viewRight||h.top>this.viewBottom||(a.earlyz_index=this.runtime.earlyz_index++,0===a.blend_mode&&1===a.opacity&&a.shaders_preserve_opaqueness&&a.drawGL_earlyZPass&&(c.setEarlyZIndex(a.earlyz_index),a.drawGL_earlyZPass(c)))}};l.prototype.drawInstanceWithShadersGL=function(a,
c){var h=a.active_effect_types[0].shaderindex,p=a.active_effect_types[0].index,m=this.getScale(),t=this.runtime.draw_width,E=this.runtime.draw_height;if(1!==a.active_effect_types.length||c.programUsesCrossSampling(h)||c.programExtendsBox(h)||(a.angle||a.layer.getAngle())&&c.programUsesDest(h)||1!==a.opacity||a.type.plugin.must_predraw)this.layout.renderEffectChain(c,this,a,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),c.resetModelView(),c.scale(m,m),c.rotateZ(-this.getAngle()),
c.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),c.updateModelView();else{c.switchProgram(h);c.setBlend(a.srcBlend,a.destBlend);c.programIsAnimated(h)&&(this.runtime.redraw=!0);var z=0,H=0,B=0,g=0;c.programUsesDest(h)&&(g=a.bbox,z=this.layerToCanvas(g.left,g.top,!0,!0),H=this.layerToCanvas(g.left,g.top,!1,!0),B=this.layerToCanvas(g.right,g.bottom,!0,!0),g=this.layerToCanvas(g.right,g.bottom,!1,!0),z/=t,H=1-H/E,B/=t,g=1-g/E);E=t=0;var r=h=1,x=1/a.width,N=1/a.height;
a.curFrame&&a.curFrame.sheetTex&&(t=a.curFrame.sheetTex.left,E=a.curFrame.sheetTex.top,h=a.curFrame.sheetTex.right,r=a.curFrame.sheetTex.bottom,a.curFrame.texture_img&&(x=1/a.curFrame.texture_img.width,N=1/a.curFrame.texture_img.height));c.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),x,N,t,E,h,r,t,E,h,r,a.bbox.left,a.bbox.top,a.bbox.right,a.bbox.bottom,z,H,B,g,m,this.getAngle(),this.runtime.kahanTime.sum,a.effect_params[p]);a.drawGL(c)}};l.prototype.canvasToLayer=
function(a,c,h,p){var m=this.runtime.devicePixelRatio;this.runtime.isRetina&&(a*=m,c*=m);m=this.runtime.parallax_x_origin;var t=this.runtime.parallax_y_origin;m=(this.layout.scrollX-m)*this.parallaxX+m;t=(this.layout.scrollY-t)*this.parallaxY+t;var E=m,z=t,H=1/this.getScale(!p);p?(E-=this.runtime.draw_width*H/2,z-=this.runtime.draw_height*H/2):(E-=this.runtime.width*H/2,z-=this.runtime.height*H/2);E+=a*H;z+=c*H;c=this.getAngle();0!==c&&(E-=m,z-=t,a=Math.cos(c),c=Math.sin(c),p=E*a-z*c,z=z*a+E*c,E=
p+m,z+=t);return h?E:z};l.prototype.layerToCanvas=function(a,c,h,p){var m=this.runtime.parallax_x_origin,t=this.runtime.parallax_y_origin,E=(this.layout.scrollX-m)*this.parallaxX+m,z=(this.layout.scrollY-t)*this.parallaxY+t;t=E;m=z;var H=this.getAngle();if(0!==H){a-=E;c-=z;var B=Math.cos(-H);H=Math.sin(-H);var g=a*B-c*H;c=c*B+a*H;a=g+E;c+=z}E=1/this.getScale(!p);p?(t-=this.runtime.draw_width*E/2,m-=this.runtime.draw_height*E/2):(t-=this.runtime.width*E/2,m-=this.runtime.height*E/2);t=(a-t)/E;m=(c-
m)/E;a=this.runtime.devicePixelRatio;this.runtime.isRetina&&!p&&(t/=a,m/=a);return h?t:m};l.prototype.rotatePt=function(a,c,h){if(0===this.getAngle())return h?a:c;var p=this.layerToCanvas(a,c,!0);c=this.layerToCanvas(a,c,!1);this.disableAngle=!0;a=this.canvasToLayer(p,c,!0);p=this.canvasToLayer(p,c,!0);this.disableAngle=!1;return h?a:p};l.prototype.saveToJSON=function(){var a,c={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,
t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var h=0;for(a=this.effect_types.length;h<a;h++){var p=this.effect_types[h];c.fx.push({name:p.name,active:p.active,params:this.effect_params[p.index]})}return c};l.prototype.loadFromJSON=function(a){var c;this.scale=a.s;this.angle=a.a;this.viewLeft=a.vl;this.viewTop=a.vt;this.viewRight=a.vr;this.viewBottom=a.vb;this.visible=a.v;this.background_color=a.bc;this.transparent=
a.t;this.parallaxX=a.px;this.parallaxY=a.py;this.opacity=a.o;this.zoomRate=a.zr;this.created_globals=a.cg||[];cr$$module$str$c3runtime.shallowAssignArray(this.initial_instances,this.startup_initial_instances);var h=new cr$$module$str$c3runtime.ObjectSet;var p=0;for(c=this.created_globals.length;p<c;++p)h.add(this.created_globals[p]);var m=p=0;for(c=this.initial_instances.length;p<c;++p)h.contains(this.initial_instances[p][2])||(this.initial_instances[m]=this.initial_instances[p],++m);cr$$module$str$c3runtime.truncateArray(this.initial_instances,
m);m=a.fx;p=0;for(c=m.length;p<c;p++)if(a=this.getEffectByName(m[p].name))a.active=m[p].active,this.effect_params[a.index]=m[p].params;this.updateActiveEffects();this.instances.sort(b);this.zindices_stale=!0};cr$$module$str$c3runtime.layer=l})();
(function(){function b(n,a){this.runtime=n;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=a[0];this.originalWidth=a[1];this.originalHeight=a[2];this.width=a[1];this.height=a[2];this.unbounded_scrolling=a[3];this.sheetname=a[4];this.sid=a[5];var c=a[6],h;this.layers=[];this.initial_types=[];n=0;for(h=c.length;n<h;n++){var p=new cr$$module$str$c3runtime.layer(this,c[n]);p.number=n;cr$$module$str$c3runtime.seal(p);
this.layers.push(p)}c=a[7];this.initial_nonworld=[];n=0;for(h=c.length;n<h;n++){p=c[n];var m=this.runtime.types_by_index[p[1]];m.default_instance||(m.default_instance=p);this.initial_nonworld.push(p);-1===this.initial_types.indexOf(m)&&this.initial_types.push(m)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];n=0;for(h=a[8].length;n<h;n++)this.effect_types.push({id:a[8][n][0],name:a[8][n][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,
index:n}),this.effect_params.push(a[8][n][2].slice(0));this.updateActiveEffects();this.rcTexBounce=new cr$$module$str$c3runtime.rect(0,0,1,1);this.rcTexDest=new cr$$module$str$c3runtime.rect(0,0,1,1);this.rcTexOrigin=new cr$$module$str$c3runtime.rect(0,0,1,1);this.viewRect=new cr$$module$str$c3runtime.rect(0,0,0,0);this.persist_data={}}function l(n,a){return n.zindex-a.zindex}function v(n){return n.some(function(a){return a.plugin.is_world})}b.prototype.saveObjectToPersist=function(n){var a=n.type.sid.toString();
this.persist_data.hasOwnProperty(a)||(this.persist_data[a]=[]);this.persist_data[a].push(this.runtime.saveInstanceToJSON(n))};b.prototype.hasOpaqueBottomLayer=function(){var n=this.layers[0];return!n.transparent&&1===n.opacity&&!n.forceOwnTexture&&n.visible};b.prototype.updateActiveEffects=function(){cr$$module$str$c3runtime.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var n;var a=0;for(n=this.effect_types.length;a<n;a++){var c=this.effect_types[a];c.active&&(this.active_effect_types.push(c),
c.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};b.prototype.getEffectByName=function(n){var a;var c=0;for(a=this.effect_types.length;c<a;c++){var h=this.effect_types[c];if(h.name===n)return h}return null};var A=[],L=!0;b.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;this.scrollX=this.runtime.original_width/
2;this.scrollY=this.runtime.original_height/2;var n,a;var c=0;for(n=this.runtime.types_by_index.length;c<n;c++){var h=this.runtime.types_by_index[c];if(!h.is_family){var p=h.instances;h=0;for(a=p.length;h<a;h++){var m=p[h];if(m.layer){var t=m.layer.number;t>=this.layers.length&&(t=this.layers.length-1);m.layer=this.layers[t];-1===m.layer.instances.indexOf(m)&&m.layer.instances.push(m);m.layer.zindices_stale=!0}}}}if(!L)for(c=0,n=this.layers.length;c<n;++c)this.layers[c].instances.sort(l);cr$$module$str$c3runtime.clearArray(A);
this.boundScrolling();c=0;for(n=this.layers.length;c<n;c++)m=this.layers[c],m.createInitialInstances(A),m.updateViewport(null);p=!1;if(!this.first_visit){for(E in this.persist_data)if(this.persist_data.hasOwnProperty(E)&&(h=this.runtime.getObjectTypeBySid(parseInt(E,10)))&&!h.is_family&&this.runtime.typeHasPersistBehavior(h)){a=this.persist_data[E];c=0;for(n=a.length;c<n;c++){m=null;if(h.plugin.is_world&&(m=this.getLayerBySid(a[c].w.l),!m))continue;m=this.runtime.createInstanceFromInit(h.default_instance,
m,!1,0,0,!0);this.runtime.loadInstanceFromJSON(m,a[c]);p=!0;A.push(m)}cr$$module$str$c3runtime.clearArray(a)}c=0;for(n=this.layers.length;c<n;c++)this.layers[c].instances.sort(l),this.layers[c].zindices_stale=!0}p&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());this.createAndLinkContainerInstances(A);c=0;for(n=this.initial_nonworld.length;c<n;c++){var E=this.initial_nonworld[c];h=this.runtime.types_by_index[E[1]];h.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[c],
null,!0)}this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx)for(c=0,n=this.runtime.types_by_index.length;c<n;c++)E=this.runtime.types_by_index[c],!E.is_family&&E.instances.length&&E.preloadCanvas2D&&E.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr$$module$str$c3runtime.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,A);else for(c=0,n=A.length;c<n;c++)m=A[c],this.runtime.trigger(Object.getPrototypeOf(m.type.plugin).cnds.OnCreated,m);cr$$module$str$c3runtime.clearArray(A);
this.runtime.isLoadingState||this.runtime.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};b.prototype.createAndLinkContainerInstances=function(n){var a,c;for(a=0;a<n.length;a++){var h=n[a];if(h.type.is_contained){var p=h.get_iid();var m=0;for(c=h.type.container.length;m<c;m++){var t=h.type.container[m];if(h.type!==t)if(t.instances.length>p)h.siblings.push(t.instances[p]);else if(t.default_instance){var E=this.runtime.createInstanceFromInit(t.default_instance,
h.layer,!0,h.x,h.y,!0);this.runtime.ClearDeathRow();t.updateIIDs();h.siblings.push(E);n.push(E)}}}}};b.prototype.createGlobalNonWorlds=function(){var n,a,c=[];var h=n=0;for(a=this.initial_nonworld.length;n<a;n++){var p=this.initial_nonworld[n];var m=this.runtime.types_by_index[p[1]];m.global?m.is_contained&&v(m.container)||c.push(this.runtime.createInstanceFromInit(p,null,!0)):(this.initial_nonworld[h]=p,h++)}cr$$module$str$c3runtime.truncateArray(this.initial_nonworld,h);this.runtime.ClearDeathRow();
this.createAndLinkContainerInstances(c)};b.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr$$module$str$c3runtime.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=!0;cr$$module$str$c3runtime.clearArray(this.runtime.system.waits);var n,a;if(!this.first_visit){var c=0;for(n=this.layers.length;c<n;c++){this.layers[c].updateZIndices();var h=this.layers[c].instances;var p=0;for(a=h.length;p<a;p++){var m=h[p];m.type.global||this.runtime.typeHasPersistBehavior(m.type)&&
this.saveObjectToPersist(m)}}}c=0;for(n=this.layers.length;c<n;c++){h=this.layers[c].instances;p=0;for(a=h.length;p<a;p++)m=h[p],m.type.global||this.runtime.DestroyInstance(m);this.runtime.ClearDeathRow();cr$$module$str$c3runtime.clearArray(h);this.layers[c].zindices_stale=!0}c=0;for(n=this.runtime.types_by_index.length;c<n;c++)if(h=this.runtime.types_by_index[c],!(h.global||h.plugin.is_world||h.plugin.singleglobal||h.is_family)){p=0;for(a=h.instances.length;p<a;p++)this.runtime.DestroyInstance(h.instances[p]);
this.runtime.ClearDeathRow()}L=!1;this.runtime.isEndingLayout=!1};var K=new cr$$module$str$c3runtime.rect(0,0,0,0);b.prototype.recreateInitialObjects=function(n,a,c,h,p){K.set(a,c,h,p);a=0;for(c=this.layers.length;a<c;a++)this.layers[a].recreateInitialObjects(n,K)};b.prototype.draw=function(n){var a=n,c=!1,h=!this.runtime.fullscreenScalingQuality;if(h){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=document.createElement("canvas");var p=this.runtime.layout_canvas;p.width=this.runtime.draw_width;
p.height=this.runtime.draw_height;this.runtime.layout_ctx=p.getContext("2d");c=!0}p=this.runtime.layout_canvas;a=this.runtime.layout_ctx;p.width!==this.runtime.draw_width&&(p.width=this.runtime.draw_width,c=!0);p.height!==this.runtime.draw_height&&(p.height=this.runtime.draw_height,c=!0);c&&(a.imageSmoothingEnabled=this.runtime.linearSampling)}a.globalAlpha=1;a.globalCompositeOperation="source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&a.clearRect(0,0,this.runtime.draw_width,
this.runtime.draw_height);var m;c=0;for(m=this.layers.length;c<m;c++){var t=this.layers[c];t.visible&&0<t.opacity&&11!==t.blend_mode&&(t.instances.length||!t.transparent)?t.draw(a):t.updateViewport(null)}h&&n.drawImage(p,0,0,this.runtime.width,this.runtime.height)};b.prototype.drawGL_earlyZPass=function(n){n.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=n.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==
this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)n.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=n.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);n.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||n.setSize(this.runtime.draw_width,this.runtime.draw_height);var a;for(a=this.layers.length-1;0<=a;--a){var c=this.layers[a];c.visible&&1===c.opacity&&c.shaders_preserve_opaqueness&&
0===c.blend_mode&&(c.instances.length||!c.transparent)?c.drawGL_earlyZPass(n):c.updateViewport(null)}n.setEarlyZPass(!1)};b.prototype.drawGL=function(n){var a=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;if(a){this.runtime.layout_tex||(this.runtime.layout_tex=n.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||
this.runtime.layout_tex.c2height!==this.runtime.draw_height)n.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=n.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);n.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||n.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&(n.setRenderingToTexture(null),n.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);
this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&n.clear(0,0,0,0);var c;var h=0;for(c=this.layers.length;h<c;h++){var p=this.layers[h];p.visible&&0<p.opacity&&(p.instances.length||!p.transparent)?p.drawGL(n):p.updateViewport(null)}a&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(a=this.active_effect_types[0].index,h=this.calculateViewRect(),n.switchProgram(this.active_effect_types[0].shaderindex),
n.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,h.left,h.top,h.right,h.bottom,0,0,1,1,this.scale,this.angle,this.runtime.kahanTime.sum,this.effect_params[a]),n.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):n.switchProgram(0),this.runtime.fullscreenScalingQuality||n.setSize(this.runtime.width,this.runtime.height),n.setRenderingToTexture(null),n.setDepthTestEnabled(!1),n.setOpacity(1),n.setTexture(this.runtime.layout_tex),
n.setAlphaBlend(),n.resetModelView(),n.updateModelView(),a=this.runtime.width/2,h=this.runtime.height/2,n.quad(-a,h,a,h,a,-h,-a,-h),n.setTexture(null),n.setDepthTestEnabled(!0)):this.renderEffectChain(n,null,null,null))};b.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:null};b.prototype.getMinLayerScale=function(){var n=this.layers[0].getScale(),
a;var c=1;for(a=this.layers.length;c<a;c++){var h=this.layers[c];(0!==h.parallaxX||0!==h.parallaxY)&&h.getScale()<n&&(n=h.getScale())}return n};b.prototype.scrollToX=function(n){if(!this.unbounded_scrolling){var a=this.runtime.draw_width*(1/this.getMinLayerScale())/2;n>this.width-a&&(n=this.width-a);n<a&&(n=a)}this.scrollX!==n&&(this.scrollX=n,this.runtime.redraw=!0)};b.prototype.scrollToY=function(n){if(!this.unbounded_scrolling){var a=this.runtime.draw_height*(1/this.getMinLayerScale())/2;n>this.height-
a&&(n=this.height-a);n<a&&(n=a)}this.scrollY!==n&&(this.scrollY=n,this.runtime.redraw=!0)};b.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};b.prototype.calculateViewRect=function(){var n=this.scrollX,a=this.scrollY,c=1/(this.scale*this.runtime.aspect_scale);n-=this.runtime.width*c/2;a-=this.runtime.height*c/2;this.viewRect.set(n,a,n+this.runtime.draw_width*c,a+this.runtime.draw_height*c);return this.viewRect};b.prototype.renderEffectChain=function(n,
a,c,h){var p=c?c.active_effect_types:a?a.active_effect_types:this.active_effect_types;if(c){var m=c.layer.getScale();var t=c.layer.getAngle();var E=c.layer.viewLeft;var z=c.layer.viewTop;var H=c.layer.viewRight;var B=c.layer.viewBottom}else a?(m=a.getScale(),t=a.getAngle(),E=a.viewLeft,z=a.viewTop,H=a.viewRight,B=a.viewBottom):(m=this.scale,t=this.angle,B=this.calculateViewRect(),E=B.left,z=B.top,H=B.right,B=B.bottom);var g=this.runtime.fx_tex,r,x,N=0,Q=1,F=this.runtime.draw_width,d=this.runtime.draw_height,
k=F/2,C=d/2,e=a?a.rcTexBounce:this.rcTexBounce,u=a?a.rcTexDest:this.rcTexDest,G=a?a.rcTexOrigin:this.rcTexOrigin,I=0,R=0,S=0,V=0,T=F,Z=F,aa=d,f=d,q=x=0,y=c?c.layer.getAngle():0;if(c){var D=0;for(r=p.length;D<r;D++)x+=n.getProgramBoxExtendHorizontal(p[D].shaderindex),q+=n.getProgramBoxExtendVertical(p[D].shaderindex);V=c.bbox;I=a.layerToCanvas(V.left,V.top,!0,!0);S=a.layerToCanvas(V.left,V.top,!1,!0);T=a.layerToCanvas(V.right,V.bottom,!0,!0);aa=a.layerToCanvas(V.right,V.bottom,!1,!0);if(0!==y){D=a.layerToCanvas(V.right,
V.top,!0,!0);r=a.layerToCanvas(V.right,V.top,!1,!0);R=a.layerToCanvas(V.left,V.bottom,!0,!0);V=a.layerToCanvas(V.left,V.bottom,!1,!0);var w=Math.min(I,T,D,R);T=Math.max(I,T,D,R);I=w;w=Math.min(S,aa,r,V);aa=Math.max(S,aa,r,V);S=w}G.left=I/F;G.top=1-S/d;G.right=T/F;G.bottom=1-aa/d;I-=x;S-=q;T+=x;aa+=q;u.left=I/F;u.top=1-S/d;u.right=T/F;u.bottom=1-aa/d;R=I=cr$$module$str$c3runtime.floor(I);V=S=cr$$module$str$c3runtime.floor(S);Z=T=cr$$module$str$c3runtime.ceil(T);f=aa=cr$$module$str$c3runtime.ceil(aa);
R-=x;V-=q;Z+=x;f+=q;0>I&&(I=0);0>S&&(S=0);T>F&&(T=F);aa>d&&(aa=d);0>R&&(R=0);0>V&&(V=0);Z>F&&(Z=F);f>d&&(f=d);e.left=I/F;e.top=1-S/d;e.right=T/F;e.bottom=1-aa/d}else e.left=u.left=G.left=0,e.top=u.top=G.top=0,e.right=u.right=G.right=1,e.bottom=u.bottom=1;q=c&&(n.programUsesDest(p[0].shaderindex)||0!==x||0!==q||1!==c.opacity||c.type.plugin.must_predraw)||a&&!c&&1!==a.opacity;n.setAlphaBlend();if(q){g[N]||(g[N]=n.createEmptyTexture(F,d,this.runtime.linearSampling));if(g[N].c2width!==F||g[N].c2height!==
d)n.deleteTexture(g[N]),g[N]=n.createEmptyTexture(F,d,this.runtime.linearSampling);n.switchProgram(0);n.setRenderingToTexture(g[N]);var J=f-V;n.clearRect(R,d-V-J,Z-R,J);c?c.drawGL(n):(n.setTexture(this.runtime.layer_tex),n.setOpacity(a.opacity),n.resetModelView(),n.translate(-k,-C),n.updateModelView(),n.quadTex(I,aa,T,aa,T,S,I,S,e));u.left=u.top=0;u.right=u.bottom=1;c&&(w=e.top,e.top=e.bottom,e.bottom=w);N=1;Q=0}n.setOpacity(1);x=p.length-1;y=n.programUsesCrossSampling(p[x].shaderindex)||!a&&!c&&
!this.runtime.fullscreenScalingQuality;D=0;for(r=p.length;D<r;D++){g[N]||(g[N]=n.createEmptyTexture(F,d,this.runtime.linearSampling));if(g[N].c2width!==F||g[N].c2height!==d)n.deleteTexture(g[N]),g[N]=n.createEmptyTexture(F,d,this.runtime.linearSampling);n.switchProgram(p[D].shaderindex);w=p[D].index;n.programIsAnimated(p[D].shaderindex)&&(this.runtime.redraw=!0);if(0!=D||q){n.setProgramParameters(h,1/F,1/d,0,0,1,1,G.left,G.top,G.right,G.bottom,E,z,H,B,u.left,u.top,u.right,u.bottom,m,t,this.runtime.kahanTime.sum,
c?c.effect_params[w]:a?a.effect_params[w]:this.effect_params[w]);n.setTexture(null);if(D!==x||y){n.setRenderingToTexture(g[N]);J=f-V;var M=d-V-J;n.clearRect(R,M,Z-R,J)}else c?n.setBlend(c.srcBlend,c.destBlend):a&&n.setBlend(a.srcBlend,a.destBlend),n.setRenderingToTexture(h);n.setTexture(g[Q]);n.resetModelView();n.translate(-k,-C);n.updateModelView();n.quadTex(I,aa,T,aa,T,S,I,S,e);D!==x||y||n.setTexture(null)}else{n.setRenderingToTexture(g[N]);J=f-V;M=d-V-J;n.clearRect(R,M,Z-R,J);if(c){M=Q=0;var O=
J=1,P=1/c.width,X=1/c.height;c.curFrame&&c.curFrame.sheetTex&&(Q=c.curFrame.sheetTex.left,M=c.curFrame.sheetTex.top,J=c.curFrame.sheetTex.right,O=c.curFrame.sheetTex.bottom,c.curFrame.texture_img&&(P=1/c.curFrame.texture_img.width,X=1/c.curFrame.texture_img.height));n.setProgramParameters(h,P,X,Q,M,J,O,Q,M,J,O,c.bbox.left,c.bbox.top,c.bbox.right,c.bbox.bottom,u.left,u.top,u.right,u.bottom,m,t,this.runtime.kahanTime.sum,c.effect_params[w]);c.drawGL(n)}else n.setProgramParameters(h,1/F,1/d,0,0,1,1,
0,0,1,1,E,z,H,B,0,0,1,1,m,t,this.runtime.kahanTime.sum,a?a.effect_params[w]:this.effect_params[w]),n.setTexture(a?this.runtime.layer_tex:this.runtime.layout_tex),n.resetModelView(),n.translate(-k,-C),n.updateModelView(),n.quadTex(I,aa,T,aa,T,S,I,S,e);u.left=u.top=0;u.right=u.bottom=1;c&&!y&&(w=aa,aa=S,S=w)}N=0===N?1:0;Q=0===N?1:0}y&&(n.switchProgram(0),c?n.setBlend(c.srcBlend,c.destBlend):a?n.setBlend(a.srcBlend,a.destBlend):this.runtime.fullscreenScalingQuality||(n.setSize(this.runtime.width,this.runtime.height),
k=this.runtime.width/2,C=this.runtime.height/2,S=I=0,T=this.runtime.width,aa=this.runtime.height),n.setRenderingToTexture(h),n.setTexture(g[Q]),n.resetModelView(),n.translate(-k,-C),n.updateModelView(),c&&1===p.length&&!q?n.quadTex(I,S,T,S,T,aa,I,aa,e):n.quadTex(I,aa,T,aa,T,S,I,S,e),n.setTexture(null))};b.prototype.getLayerBySid=function(n){var a;var c=0;for(a=this.layers.length;c<a;c++)if(this.layers[c].sid===n)return this.layers[c];return null};b.prototype.saveToJSON=function(){var n,a={sx:this.scrollX,
sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var c=0;for(n=this.effect_types.length;c<n;c++){var h=this.effect_types[c];a.fx.push({name:h.name,active:h.active,params:this.effect_params[h.index]})}c=0;for(n=this.layers.length;c<n;c++)h=this.layers[c],a.layers[h.sid.toString()]=h.saveToJSON();return a};b.prototype.loadFromJSON=function(n){var a,c,h;this.scrollX=n.sx;this.scrollY=n.sy;this.scale=n.s;this.angle=n.a;
this.width=n.w;this.height=n.h;this.persist_data=n.persist;"undefined"!==typeof n.fv&&(this.first_visit=n.fv);var p=n.fx;var m=0;for(a=p.length;m<a;m++)if(c=this.getEffectByName(p[m].name))c.active=p[m].active,this.effect_params[c.index]=p[m].params;this.updateActiveEffects();m=n.layers;for(h in m)m.hasOwnProperty(h)&&(n=this.getLayerBySid(parseInt(h,10)))&&n.loadFromJSON(m[h])};cr$$module$str$c3runtime.layout=b})();
(function(){function b(g,r){var x,N=g.length;switch(N){case 0:return!0;case 1:return g[0]===r[0];case 2:return g[0]===r[0]&&g[1]===r[1];default:for(x=0;x<N;x++)if(g[x]!==r[x])return!1;return!0}}function l(g,r){return g.index-r.index}function v(g){var r;if(2===g.length){if(g[0].index>g[1].index){var x=g[0];g[0]=g[1];g[1]=x}}else 2<g.length&&g.sort(l);g.length>=z.length&&(z.length=g.length+1);z[g.length]||(z[g.length]=[]);var N=z[g.length];x=0;for(r=N.length;x<r;x++){var Q=N[x];if(b(g,Q))return Q}N.push(g);
return g}function A(g,r){this.runtime=g;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr$$module$str$c3runtime.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=r[0];g=r[1];this.events=[];var x;r=0;for(x=g.length;r<x;r++)this.init_event(g[r],null,this.events)}function L(g){this.type=g;this.instances=[];this.else_instances=[];this.select_all=!0}function K(g,r,x){this.sheet=g;this.parent=r;this.runtime=g.runtime;this.solModifiers=[];this.solModifiersIncludingParents=
[];this.has_else_block=this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;3===x[0]&&(this.group_name=x[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!x[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=x[2];this.sid=x[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var N=x[6];g=0;for(r=N.length;g<r;g++){var Q=new cr$$module$str$c3runtime.condition(this,N[g]);Q.index=g;cr$$module$str$c3runtime.seal(Q);this.conditions.push(Q);this.addSolModifier(Q.type)}N=x[7];g=0;for(r=N.length;g<r;g++)Q=new cr$$module$str$c3runtime.action(this,N[g]),Q.index=g,cr$$module$str$c3runtime.seal(Q),this.actions.push(Q);if(9===x.length)for(x=x[8],g=0,r=x.length;g<r;g++)this.sheet.init_event(x[g],
this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=null==this.conditions[0].type&&this.conditions[0].func==cr$$module$str$c3runtime.system_object.prototype.cnds.Else)}function n(g,r){var x;if(g&&(-1===r.indexOf(g)&&r.push(g),g.is_contained)){var N=0;for(x=g.container.length;N<x;N++){var Q=g.container[N];g!==Q&&-1===r.indexOf(Q)&&r.push(Q)}}}function a(g,r){this.block=g;this.sheet=g.sheet;this.runtime=g.runtime;this.parameters=[];this.results=[];this.extra={};this.index=
-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(r[1]);this.trigger=0<r[3];this.fasttrigger=2===r[3];this.looping=r[4];this.inverted=r[5];this.isstatic=r[6];this.sid=r[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===r[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[r[0]],this.run=this.isstatic?this.run_static:this.run_object,r[2]?(this.behaviortype=this.type.getBehaviorByName(r[2]),
this.beh_index=this.type.getBehaviorIndexByName(r[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===r.length){var x=r[9];g=0;for(r=x.length;g<r;g++){var N=new cr$$module$str$c3runtime.parameter(this,x[g]);cr$$module$str$c3runtime.seal(N);this.parameters.push(N)}this.results.length=x.length}}function c(g,r){this.block=g;this.sheet=g.sheet;this.runtime=g.runtime;this.parameters=[];this.results=
[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(r[1]);-1===r[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[r[0]],this.run=this.run_object,r[2]?(this.behaviortype=this.type.getBehaviorByName(r[2]),this.beh_index=this.type.getBehaviorIndexByName(r[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=r[3];this.runtime.actsBySid[this.sid.toString()]=this;if(7===
r.length){var x=r[6];g=0;for(r=x.length;g<r;g++){var N=new cr$$module$str$c3runtime.parameter(this,x[g]);cr$$module$str$c3runtime.seal(N);this.parameters.push(N)}this.results.length=x.length}}function h(){B++;H.length===B&&H.push(new cr$$module$str$c3runtime.expvalue);return H[B]}function p(g,r){this.owner=g;this.block=g.block;this.sheet=g.sheet;this.runtime=g.runtime;this.type=r[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=
0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var x;switch(this.type){case 0:case 7:this.expression=new cr$$module$str$c3runtime.expNode(this,r[1]);this.solindex=0;this.get=this.get_exp;break;case 1:case 14:this.expression=new cr$$module$str$c3runtime.expNode(this,r[1]);this.solindex=0;this.get=this.get_exp_str;14===this.type&&(this.block.setAllSolModifiers(),this.owner instanceof cr$$module$str$c3runtime.action&&this.block.setSolWriterAfterCnds());
break;case 5:this.expression=new cr$$module$str$c3runtime.expNode(this,r[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=r[1];this.get=this.get_combosel;break;case 16:this.combosel=r[1]?1:0;this.get=this.get_boolean;break;case 6:this.layout=this.runtime.layouts[r[1]];this.get=this.get_layout;break;case 9:this.key=r[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[r[1]];this.get=this.get_object;this.block.addSolModifier(this.object);this.owner instanceof
cr$$module$str$c3runtime.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=r[1];g.type&&g.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=r[1];this.eventvar=null;this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=r[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],g=1,x=r.length;g<
x;g++){var N=new cr$$module$str$c3runtime.parameter(this.owner,r[g]);cr$$module$str$c3runtime.seal(N);this.subparams.push(N);this.variadicret.push(0)}}}function m(g,r,x){this.sheet=g;this.parent=r;this.runtime=g.runtime;this.solModifiers=[];this.name=x[1];this.vartype=x[2];this.initial=x[3];this.is_static=!!x[4];this.is_constant=!!x[5];this.sid=x[6];this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,
this.runtime.all_local_vars.push(this)):(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function t(g,r,x){this.sheet=g;this.parent=r;this.runtime=g.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=x[1];this.active=!0}function E(){this.temp_parents_arr=[];this.reset(null);cr$$module$str$c3runtime.seal(this)}var z=[];A.prototype.toString=function(){return this.name};A.prototype.init_event=function(g,r,x){switch(g[0]){case 0:case 3:g=new cr$$module$str$c3runtime.eventblock(this,
r,g);cr$$module$str$c3runtime.seal(g);if(g.orblock)for(x.push(g),x=0,r=g.conditions.length;x<r;x++)g.conditions[x].trigger&&this.init_trigger(g,x);else g.is_trigger()?this.init_trigger(g,0):x.push(g);break;case 1:g=new cr$$module$str$c3runtime.eventvariable(this,r,g);cr$$module$str$c3runtime.seal(g);x.push(g);break;case 2:g=new cr$$module$str$c3runtime.eventinclude(this,r,g),cr$$module$str$c3runtime.seal(g),x.push(g)}};A.prototype.postInit=function(){var g;var r=0;for(g=this.events.length;r<g;r++)this.events[r].postInit(r<
g-1&&this.events[r+1].is_else_block)};A.prototype.updateDeepIncludes=function(){cr$$module$str$c3runtime.clearArray(this.deep_includes);cr$$module$str$c3runtime.clearArray(this.already_included_sheets);this.addDeepIncludes(this);cr$$module$str$c3runtime.clearArray(this.already_included_sheets)};A.prototype.addDeepIncludes=function(g){var r,x=g.deep_includes,N=g.already_included_sheets,Q=this.includes.valuesRef();var F=0;for(r=Q.length;F<r;++F){var d=Q[F];var k=d.include_sheet;!d.isActive()||g===k||
-1<N.indexOf(k)||(N.push(k),k.addDeepIncludes(g),x.push(k))}};A.prototype.run=function(g){this.runtime.resuming_breakpoint||(this.hasRun=!0,g||(this.runtime.isRunningEvents=!0));var r;var x=0;for(r=this.events.length;x<r;x++){var N=this.events[x];N.run();this.runtime.clearSol(N.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}g||(this.runtime.isRunningEvents=!1)};A.prototype.init_trigger=function(g,r){g.orblock||this.runtime.triggers_to_postinit.push(g);var x,N,Q=g.conditions[r];
var F=Q.type?Q.type.name:"system";var d=(x=Q.fasttrigger)?this.fasttriggers:this.triggers;d[F]||(d[F]=[]);F=d[F];d=Q.func;if(x){if(Q.parameters.length&&(Q=Q.parameters[0],1===Q.type&&2===Q.expression.type)){Q=Q.expression.value.toLowerCase();x=0;for(N=F.length;x<N;x++)if(F[x].method==d){x=F[x].evs;x[Q]?x[Q].push([g,r]):x[Q]=[[g,r]];return}x={};x[Q]=[[g,r]];F.push({method:d,evs:x})}}else{x=0;for(N=F.length;x<N;x++)if(F[x].method==d){F[x].evs.push([g,r]);return}Q=cr$$module$str$c3runtime.plugins_.Sprite&&
d===cr$$module$str$c3runtime.plugins_.Sprite.prototype.cnds.OnFrameChanged?!0:!1;Q?F.unshift({method:d,evs:[[g,r]]}):F.push({method:d,evs:[[g,r]]})}};cr$$module$str$c3runtime.eventsheet=A;L.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};L.prototype.getObjects=function(){return this.select_all?this.type.instances:this.instances};L.prototype.pick_one=function(g){g&&(g.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr$$module$str$c3runtime.clearArray(this.instances),
cr$$module$str$c3runtime.shallowAssignArray(this.else_instances,g.type.instances),this.select_all=!1),g=this.else_instances.indexOf(g),-1!==g&&(this.instances.push(this.else_instances[g]),this.else_instances.splice(g,1))):(this.select_all=!1,cr$$module$str$c3runtime.clearArray(this.instances),this.instances[0]=g))};cr$$module$str$c3runtime.selection=L;K.prototype.postInit=function(g){var r,x=this.parent;if(this.group)for(this.toplevelgroup=!0;x;){if(!x.group){this.toplevelgroup=!1;break}x=x.parent}this.toplevelevent=
!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!g;x=this.runtime.types_by_index;if(this.solModifiers===x)this.solModifiersIncludingParents=x;else{this.solModifiersIncludingParents=this.solModifiers.slice(0);for(x=this.parent;x;){g=0;for(r=x.solModifiers.length;g<r;g++)this.addParentSolModifier(x.solModifiers[g]);x=x.parent}this.solModifiers=v(this.solModifiers);this.solModifiersIncludingParents=v(this.solModifiersIncludingParents)}g=0;for(r=this.conditions.length;g<
r;g++)this.conditions[g].postInit();g=0;for(r=this.actions.length;g<r;g++)this.actions[g].postInit();g=0;for(r=this.subevents.length;g<r;g++)this.subevents[g].postInit(g<r-1&&this.subevents[g+1].is_else_block)};K.prototype.setGroupActive=function(g){if(this.group_active!==!!g){this.group_active=!!g;var r;g=0;for(r=this.contained_includes.length;g<r;++g)this.contained_includes[g].updateActive();0<r&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};
K.prototype.addSolModifier=function(g){n(g,this.solModifiers)};K.prototype.addParentSolModifier=function(g){n(g,this.solModifiersIncludingParents)};K.prototype.setAllSolModifiers=function(){this.solModifiers=this.runtime.types_by_index};K.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};K.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};K.prototype.run=function(){var g,r=!1,x=this.runtime,
N=this.runtime.getCurrentEventStack();N.current_event=this;var Q=this.conditions;this.is_else_block||(N.else_branch_ran=!1);if(this.orblock){0===Q.length&&(r=!0);N.cndindex=0;for(g=Q.length;N.cndindex<g;N.cndindex++){var F=Q[N.cndindex];F.trigger||(F=F.run())&&(r=!0)}(N.last_event_true=r)&&this.run_actions_and_subevents()}else{N.cndindex=0;for(g=Q.length;N.cndindex<g;N.cndindex++)if(F=Q[N.cndindex].run(),!F){N.last_event_true=!1;this.toplevelevent&&x.hasPendingInstances&&x.ClearDeathRow();return}N.last_event_true=
!0;this.run_actions_and_subevents()}this.end_run(N)};K.prototype.end_run=function(g){g.last_event_true&&this.has_else_block&&(g.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};K.prototype.run_orblocktrigger=function(g){this.runtime.getCurrentEventStack().current_event=this;this.conditions[g].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};K.prototype.run_actions_and_subevents=function(){var g=
this.runtime.getCurrentEventStack(),r;g.actindex=0;for(r=this.actions.length;g.actindex<r;g.actindex++)if(this.actions[g.actindex].run())return;this.run_subevents()};K.prototype.resume_actions_and_subevents=function(){var g=this.runtime.getCurrentEventStack(),r;for(r=this.actions.length;g.actindex<r;g.actindex++)if(this.actions[g.actindex].run())return;this.run_subevents()};K.prototype.run_subevents=function(){if(this.subevents.length){var g,r,x=this.subevents.length-1;this.runtime.pushEventStack(this);
if(this.solWriterAfterCnds){var N=0;for(g=this.subevents.length;N<g;N++){var Q=this.subevents[N];(r=!this.toplevelgroup||!this.group&&N<x)&&this.runtime.pushCopySol(Q.solModifiers);Q.run();r?this.runtime.popSol(Q.solModifiers):this.runtime.clearSol(Q.solModifiers)}}else for(N=0,g=this.subevents.length;N<g;N++)this.subevents[N].run();this.runtime.popEventStack()}};K.prototype.run_pretrigger=function(){var g=this.runtime.getCurrentEventStack();g.current_event=this;var r=!1,x;g.cndindex=0;for(x=this.conditions.length;g.cndindex<
x;g.cndindex++)if(this.conditions[g.cndindex].run())r=!0;else if(!this.orblock)return!1;return this.orblock?r:!0};K.prototype.retrigger=function(){this.runtime.execcount++;var g=this.runtime.getCurrentEventStack().cndindex,r=this.runtime.pushEventStack(this);if(!this.orblock)for(r.cndindex=g+1,g=this.conditions.length;r.cndindex<g;r.cndindex++)if(!this.conditions[r.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};K.prototype.isFirstConditionOfType=
function(g){var r=g.index;if(0===r)return!0;for(--r;0<=r;--r)if(this.conditions[r].type===g.type)return!1;return!0};cr$$module$str$c3runtime.eventblock=K;a.prototype.postInit=function(){var g;var r=0;for(g=this.parameters.length;r<g;r++){var x=this.parameters[r];x.postInit();x.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};a.prototype.run_true=function(){return!0};a.prototype.run_system=function(){var g;var r=0;for(g=this.parameters.length;r<g;r++)this.results[r]=this.parameters[r].get();
return cr$$module$str$c3runtime.xor(this.func.apply(this.runtime.system,this.results),this.inverted)};a.prototype.run_static=function(){var g;var r=0;for(g=this.parameters.length;r<g;r++)this.results[r]=this.parameters[r].get();r=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return r};a.prototype.run_object=function(){var g,r,x,N=this.type,Q=N.getCurrentSol(),F=this.block.orblock&&!this.trigger,d=N.is_contained,k=N.is_family,C=N.family_index,
e=this.beh_index,u=-1<e,G=this.anyParamVariesPerInstance,I=this.parameters,R=this.results,S=this.inverted,V=this.func;if(G){var T=0;for(r=I.length;T<r;++T){var Z=I[T];Z.variesPerInstance||(R[T]=Z.get(0))}}else for(T=0,r=I.length;T<r;++T)R[T]=I[T].get(0);if(Q.select_all){cr$$module$str$c3runtime.clearArray(Q.instances);cr$$module$str$c3runtime.clearArray(Q.else_instances);var aa=N.instances;var f=0;for(g=aa.length;f<g;++f){var q=aa[f];if(G)for(T=0,r=I.length;T<r;++T)Z=I[T],Z.variesPerInstance&&(R[T]=
Z.get(f));u?(T=0,k&&(T=q.type.family_beh_map[C]),T=V.apply(q.behavior_insts[e+T],R)):T=V.apply(q,R);(x=cr$$module$str$c3runtime.xor(T,S))?Q.instances.push(q):F&&Q.else_instances.push(q)}N.finish&&N.finish(!0);Q.select_all=!1;N.applySolToContainer();return Q.hasObjects()}var y=0;aa=(x=F&&!this.block.isFirstConditionOfType(this))?Q.else_instances:Q.instances;var D=!1;f=0;for(g=aa.length;f<g;++f){q=aa[f];if(G)for(T=0,r=I.length;T<r;++T)Z=I[T],Z.variesPerInstance&&(R[T]=Z.get(f));u?(T=0,k&&(T=q.type.family_beh_map[C]),
T=V.apply(q.behavior_insts[e+T],R)):T=V.apply(q,R);if(cr$$module$str$c3runtime.xor(T,S))if(D=!0,x){if(Q.instances.push(q),d)for(T=0,r=q.siblings.length;T<r;T++)Z=q.siblings[T],Z.type.getCurrentSol().instances.push(Z)}else{aa[y]=q;if(d)for(T=0,r=q.siblings.length;T<r;T++)Z=q.siblings[T],Z.type.getCurrentSol().instances[y]=Z;y++}else if(x){aa[y]=q;if(d)for(T=0,r=q.siblings.length;T<r;T++)Z=q.siblings[T],Z.type.getCurrentSol().else_instances[y]=Z;y++}else if(F&&(Q.else_instances.push(q),d))for(T=0,r=
q.siblings.length;T<r;T++)Z=q.siblings[T],Z.type.getCurrentSol().else_instances.push(Z)}cr$$module$str$c3runtime.truncateArray(aa,y);if(d)for(k=N.container,f=0,g=k.length;f<g;f++)q=k[f].getCurrentSol(),x?cr$$module$str$c3runtime.truncateArray(q.else_instances,y):cr$$module$str$c3runtime.truncateArray(q.instances,y);y=D;if(x&&!D)for(f=0,g=Q.instances.length;f<g;f++){q=Q.instances[f];if(G)for(T=0,r=I.length;T<r;T++)Z=I[T],Z.variesPerInstance&&(R[T]=Z.get(f));T=u?V.apply(q.behavior_insts[e],R):V.apply(q,
R);if(cr$$module$str$c3runtime.xor(T,S)){D=!0;break}}N.finish&&N.finish(y||F);return F?D:Q.hasObjects()};cr$$module$str$c3runtime.condition=a;c.prototype.postInit=function(){var g;var r=0;for(g=this.parameters.length;r<g;r++){var x=this.parameters[r];x.postInit();x.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};c.prototype.run_system=function(){var g=this.runtime,r,x=this.parameters,N=this.results;var Q=0;for(r=x.length;Q<r;++Q)N[Q]=x[Q].get();return this.func.apply(g.system,N)};c.prototype.run_object=
function(){var g=this.type,r=this.beh_index,x=g.family_index,N=this.anyParamVariesPerInstance,Q=this.parameters,F=this.results,d=this.func,k=g.getCurrentSol().getObjects();g=g.is_family;var C=-1<r,e,u;if(N){var G=0;for(u=Q.length;G<u;++G){var I=Q[G];I.variesPerInstance||(F[G]=I.get(0))}}else for(G=0,u=Q.length;G<u;++G)F[G]=Q[G].get(0);var R=0;for(e=k.length;R<e;++R){var S=k[R];if(N)for(G=0,u=Q.length;G<u;++G)I=Q[G],I.variesPerInstance&&(F[G]=I.get(R));C?(G=0,g&&(G=S.type.family_beh_map[x]),d.apply(S.behavior_insts[r+
G],F)):d.apply(S,F)}return!1};cr$$module$str$c3runtime.action=c;var H=[],B=-1;p.prototype.postInit=function(){var g;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var r=0;for(g=this.subparams.length;r<g;r++)this.subparams[r].postInit()}this.expression&&this.expression.postInit()};p.prototype.maybeVaryForType=function(g){this.variesPerInstance||!g||g.plugin.singleglobal||(this.variesPerInstance=!0)};p.prototype.setVaries=
function(){this.variesPerInstance=!0};p.prototype.get_exp=function(g){this.solindex=g||0;g=h();this.expression.get(g);B--;return g.data};p.prototype.get_exp_str=function(g){this.solindex=g||0;g=h();this.expression.get(g);B--;return cr$$module$str$c3runtime.is_string(g.data)?g.data:""};p.prototype.get_object=function(){return this.object};p.prototype.get_combosel=function(){return this.combosel};p.prototype.get_boolean=function(){return!!this.combosel};p.prototype.get_layer=function(g){this.solindex=
g||0;g=h();this.expression.get(g);B--;return g.is_number()?this.runtime.getLayerByNumber(g.data):this.runtime.getLayerByName(g.data)};p.prototype.get_layout=function(){return this.layout};p.prototype.get_key=function(){return this.key};p.prototype.get_instvar=function(){return this.index};p.prototype.get_familyvar=function(g){var r=g||0;g=this.owner.type;var x=g.getCurrentSol(),N=x.getObjects();if(N.length)r=N[r%N.length].type;else if(x.else_instances.length)r=x.else_instances[r%x.else_instances.length].type;
else if(g.instances.length)r=g.instances[r%g.instances.length].type;else return 0;return this.index+r.family_var_map[g.family_index]};p.prototype.get_eventvar=function(){return this.eventvar};p.prototype.get_audiofile=function(){return this.fileinfo};p.prototype.get_variadic=function(){var g;var r=0;for(g=this.subparams.length;r<g;r++)this.variadicret[r]=this.subparams[r].get();return this.variadicret};cr$$module$str$c3runtime.parameter=p;m.prototype.postInit=function(){this.solModifiers=v(this.solModifiers)};
m.prototype.setValue=function(g){var r=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&r?(this.localIndex>=r.length&&(r.length=this.localIndex+1),r[this.localIndex]=g):this.data=g};m.prototype.getValue=function(){var g=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!g||this.is_constant?this.data:this.localIndex>=g.length||"undefined"===typeof g[this.localIndex]?this.initial:g[this.localIndex]};m.prototype.run=function(){!this.parent||this.is_static||
this.is_constant||this.setValue(this.initial)};cr$$module$str$c3runtime.eventvariable=m;t.prototype.toString=function(){return"include:"+this.include_sheet.toString()};t.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=v(this.solModifiers);for(var g=this.parent;g;)g.group&&g.contained_includes.push(this),g=g.parent;this.updateActive()};t.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);
this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};t.prototype.updateActive=function(){for(var g=this.parent;g;){if(g.group&&!g.group_active){this.active=!1;return}g=g.parent}this.active=!0};t.prototype.isActive=function(){return this.active};cr$$module$str$c3runtime.eventinclude=t;E.prototype.reset=function(g){this.current_event=g;this.actindex=this.cndindex=0;cr$$module$str$c3runtime.clearArray(this.temp_parents_arr);this.any_true_state=
this.else_branch_ran=this.last_event_true=!1};E.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr$$module$str$c3runtime.eventStackFrame=E})();
(function(){function b(n,a){this.owner=n;this.runtime=n.runtime;this.type=a[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var c=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=a[1];break;case 3:this.first=new cr$$module$str$c3runtime.expNode(n,a[1]);break;case 18:this.first=new cr$$module$str$c3runtime.expNode(n,a[1]);this.second=new cr$$module$str$c3runtime.expNode(n,
a[2]);this.third=new cr$$module$str$c3runtime.expNode(n,a[3]);break;case 19:this.func=this.runtime.GetObjectReference(a[1]);this.func!==cr$$module$str$c3runtime.system_object.prototype.exps.random&&this.func!==cr$$module$str$c3runtime.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===a.length?(c=a[2],this.results.length=c.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[a[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(a[2]);
this.return_string=a[3];cr$$module$str$c3runtime.plugins_.Function&&this.func===cr$$module$str$c3runtime.plugins_.Function.prototype.exps.Call&&this.owner.setVaries();this.instance_expr=a[4]?new cr$$module$str$c3runtime.expNode(n,a[4]):null;this.results=[];this.parameters=[];6===a.length?(c=a[5],this.results.length=c.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[a[1]];this.return_string=a[2];this.instance_expr=a[3]?new cr$$module$str$c3runtime.expNode(n,
a[3]):null;this.varindex=a[4];break;case 22:this.object_type=this.runtime.types_by_index[a[1]];this.behavior_type=this.object_type.getBehaviorByName(a[2]);this.beh_index=this.object_type.getBehaviorIndexByName(a[2]);this.func=this.runtime.GetObjectReference(a[3]);this.return_string=a[4];this.instance_expr=a[5]?new cr$$module$str$c3runtime.expNode(n,a[5]):null;this.results=[];this.parameters=[];7===a.length?(c=a[6],this.results.length=c.length+1):this.results.length=1;break;case 23:this.varname=a[1],
this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr$$module$str$c3runtime.expNode(n,a[1]),this.second=new cr$$module$str$c3runtime.expNode(n,a[2]));if(c){var h;a=0;for(h=c.length;a<h;a++)this.parameters.push(new cr$$module$str$c3runtime.expNode(n,c[a]))}cr$$module$str$c3runtime.seal(this)}function l(){++K;L.length===K&&L.push(new cr$$module$str$c3runtime.expvalue);return L[K]}function v(n,a,c){var h;var p=0;for(h=n.length;p<h;++p)n[p].get(c),
a[p+1]=c.data}function A(n,a){this.type=n||cr$$module$str$c3runtime.exptype.Integer;this.data=a||0;this.object_class=null;this.type==cr$$module$str$c3runtime.exptype.Integer&&(this.data=Math.floor(this.data));cr$$module$str$c3runtime.seal(this)}b.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&
this.instance_expr.postInit();if(this.parameters){var n;var a=0;for(n=this.parameters.length;a<n;a++)this.parameters[a].postInit()}};var L=[],K=-1;b.prototype.eval_system_exp=function(n){var a=this.parameters,c=this.results;c[0]=n;n=l();v(a,c,n);--K;this.func.apply(this.runtime.system,c)};b.prototype.eval_object_exp=function(n){var a=this.object_type,c=this.results,h=this.parameters,p=this.instance_expr,m=this.func,t=this.owner.solindex,E=a.getCurrentSol(),z=E.getObjects();if(!z.length)if(E.else_instances.length)z=
E.else_instances;else{this.return_string?n.set_string(""):n.set_int(0);return}c[0]=n;n.object_class=a;n=l();v(h,c,n);p&&(p.get(n),n.is_number()&&(t=n.data,z=a.instances));--K;a=z.length;if(t>=a||t<=-a)t%=a;0>t&&(t+=a);m.apply(z[t],c)};b.prototype.eval_behavior_exp=function(n){var a=this.object_type,c=this.results,h=this.parameters,p=this.instance_expr,m=this.beh_index,t=this.func,E=this.owner.solindex,z=a.getCurrentSol(),H=z.getObjects();if(!H.length)if(z.else_instances.length)H=z.else_instances;
else{this.return_string?n.set_string(""):n.set_int(0);return}c[0]=n;n.object_class=a;n=l();v(h,c,n);p&&(p.get(n),n.is_number()&&(E=n.data,H=a.instances));--K;h=H.length;if(E>=h||E<=-h)E%=h;0>E&&(E+=h);E=H[E];H=0;a.is_family&&(H=E.type.family_beh_map[a.family_index]);t.apply(E.behavior_insts[m+H],c)};b.prototype.eval_instvar_exp=function(n){var a=this.instance_expr,c=this.object_type,h=this.varindex,p=this.owner.solindex,m=c.getCurrentSol(),t=m.getObjects();if(!t.length)if(m.else_instances.length)t=
m.else_instances;else{this.return_string?n.set_string(""):n.set_int(0);return}if(a){m=l();a.get(m);if(m.is_number()){p=m.data;t=c.instances;0!==t.length&&(p%=t.length,0>p&&(p+=t.length));p=c.getInstanceByIID(p);c=p.instance_vars[h];cr$$module$str$c3runtime.is_string(c)?n.set_string(c):n.set_float(c);--K;return}--K}a=t.length;if(p>=a||p<=-a)p%=a;0>p&&(p+=a);p=t[p];t=0;c.is_family&&(t=p.type.family_var_map[c.family_index]);c=p.instance_vars[h+t];cr$$module$str$c3runtime.is_string(c)?n.set_string(c):
n.set_float(c)};b.prototype.eval_int=function(n){n.type=cr$$module$str$c3runtime.exptype.Integer;n.data=this.value};b.prototype.eval_float=function(n){n.type=cr$$module$str$c3runtime.exptype.Float;n.data=this.value};b.prototype.eval_string=function(n){n.type=cr$$module$str$c3runtime.exptype.String;n.data=this.value};b.prototype.eval_unaryminus=function(n){this.first.get(n);n.is_number()&&(n.data=-n.data)};b.prototype.eval_add=function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&
a.is_number()&&(n.data+=a.data,a.is_float()&&n.make_float());--K};b.prototype.eval_subtract=function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&a.is_number()&&(n.data-=a.data,a.is_float()&&n.make_float());--K};b.prototype.eval_multiply=function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&a.is_number()&&(n.data*=a.data,a.is_float()&&n.make_float());--K};b.prototype.eval_divide=function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&a.is_number()&&
(n.data/=a.data,n.make_float());--K};b.prototype.eval_mod=function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&a.is_number()&&(n.data%=a.data,a.is_float()&&n.make_float());--K};b.prototype.eval_power=function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&a.is_number()&&(n.data=Math.pow(n.data,a.data),a.is_float()&&n.make_float());--K};b.prototype.eval_and=function(n){this.first.get(n);var a=l();this.second.get(a);a.is_string()||n.is_string()?this.eval_and_stringconcat(n,
a):this.eval_and_logical(n,a);--K};b.prototype.eval_and_stringconcat=function(n,a){n.is_string()&&a.is_string()?this.eval_and_stringconcat_str_str(n,a):this.eval_and_stringconcat_num(n,a)};b.prototype.eval_and_stringconcat_str_str=function(n,a){n.data+=a.data};b.prototype.eval_and_stringconcat_num=function(n,a){n.is_string()?n.data+=(Math.round(1E10*a.data)/1E10).toString():n.set_string(n.data.toString()+a.data)};b.prototype.eval_and_logical=function(n,a){n.set_int(n.data&&a.data?1:0)};b.prototype.eval_or=
function(n){this.first.get(n);var a=l();this.second.get(a);n.is_number()&&a.is_number()&&(n.data||a.data?n.set_int(1):n.set_int(0));--K};b.prototype.eval_conditional=function(n){this.first.get(n);n.data?this.second.get(n):this.third.get(n)};b.prototype.eval_equal=function(n){this.first.get(n);var a=l();this.second.get(a);n.set_int(n.data===a.data?1:0);--K};b.prototype.eval_notequal=function(n){this.first.get(n);var a=l();this.second.get(a);n.set_int(n.data!==a.data?1:0);--K};b.prototype.eval_less=
function(n){this.first.get(n);var a=l();this.second.get(a);n.set_int(n.data<a.data?1:0);--K};b.prototype.eval_lessequal=function(n){this.first.get(n);var a=l();this.second.get(a);n.set_int(n.data<=a.data?1:0);--K};b.prototype.eval_greater=function(n){this.first.get(n);var a=l();this.second.get(a);n.set_int(n.data>a.data?1:0);--K};b.prototype.eval_greaterequal=function(n){this.first.get(n);var a=l();this.second.get(a);n.set_int(n.data>=a.data?1:0);--K};b.prototype.eval_eventvar_exp=function(n){var a=
this.eventvar.getValue();"number"===typeof a?n.set_float(a):"boolean"===typeof a?n.set_int(a?1:0):n.set_string(a)};cr$$module$str$c3runtime.expNode=b;A.prototype.is_int=function(){return this.type===cr$$module$str$c3runtime.exptype.Integer};A.prototype.is_float=function(){return this.type===cr$$module$str$c3runtime.exptype.Float};A.prototype.is_number=function(){return this.type===cr$$module$str$c3runtime.exptype.Integer||this.type===cr$$module$str$c3runtime.exptype.Float};A.prototype.is_string=function(){return this.type===
cr$$module$str$c3runtime.exptype.String};A.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&(this.data=parseInt(this.data,10)),this.type=cr$$module$str$c3runtime.exptype.Integer)};A.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr$$module$str$c3runtime.exptype.Float)};A.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr$$module$str$c3runtime.exptype.String)};
A.prototype.set_int=function(n){this.type=cr$$module$str$c3runtime.exptype.Integer;this.data=Math.floor(n)};A.prototype.set_float=function(n){this.type=cr$$module$str$c3runtime.exptype.Float;this.data=n};A.prototype.set_string=function(n){this.type=cr$$module$str$c3runtime.exptype.String;this.data=n};A.prototype.set_any=function(n){cr$$module$str$c3runtime.is_number(n)?(this.type=cr$$module$str$c3runtime.exptype.Float,this.data=n):cr$$module$str$c3runtime.is_string(n)?(this.type=cr$$module$str$c3runtime.exptype.String,
this.data=n.toString()):(this.type=cr$$module$str$c3runtime.exptype.Integer,this.data=0)};cr$$module$str$c3runtime.expvalue=A;cr$$module$str$c3runtime.exptype={Integer:0,Float:1,String:2}})();cr$$module$str$c3runtime.system_object=function(b){this.runtime=b;this.waits=[]};
cr$$module$str$c3runtime.system_object.prototype.saveToJSON=function(){var b={},l,v,A;b.waits=[];var L=b.waits;var K=0;for(l=this.waits.length;K<l;K++){var n=this.waits[K];var a={t:n.time,st:n.signaltag,s:n.signalled,ev:n.ev.sid,sm:[],sols:{}};n.ev.actions[n.actindex]&&(a.act=n.ev.actions[n.actindex].sid);var c=0;for(v=n.solModifiers.length;c<v;c++)a.sm.push(n.solModifiers[c].sid);for(A in n.sols)if(n.sols.hasOwnProperty(A)){var h=this.runtime.types_by_index[parseInt(A,10)];var p={sa:n.sols[A].sa,
insts:[]};c=0;for(v=n.sols[A].insts.length;c<v;c++)p.insts.push(n.sols[A].insts[c].uid);a.sols[h.sid.toString()]=p}L.push(a)}return b};
cr$$module$str$c3runtime.system_object.prototype.loadFromJSON=function(b){b=b.waits;var l,v,A,L,K;cr$$module$str$c3runtime.clearArray(this.waits);var n=0;for(l=b.length;n<l;n++){var a=b[n];if(L=this.runtime.blocksBySid[a.ev.toString()]){var c=-1;var h=0;for(v=L.actions.length;h<v;h++)if(L.actions[h].sid===a.act){c=h;break}if(-1!==c){var p={sols:{},solModifiers:[],deleteme:!1};p.time=a.t;p.signaltag=a.st||"";p.signalled=!!a.s;p.ev=L;p.actindex=c;h=0;for(v=a.sm.length;h<v;h++)(L=this.runtime.getObjectTypeBySid(a.sm[h]))&&
p.solModifiers.push(L);for(A in a.sols)if(a.sols.hasOwnProperty(A)&&(L=this.runtime.getObjectTypeBySid(parseInt(A,10)))){c=a.sols[A];var m={sa:c.sa,insts:[]};h=0;for(v=c.insts.length;h<v;h++)(K=this.runtime.getObjectByUID(c.insts[h]))&&m.insts.push(K);p.sols[L.index.toString()]=m}this.waits.push(p)}}}};
(function(){function b(){}function l(d,k){d=d.extra.c2_feo_val;k=k.extra.c2_feo_val;if(cr$$module$str$c3runtime.is_number(d)&&cr$$module$str$c3runtime.is_number(k))return d-k;d=""+d;k=""+k;return d<k?-1:d>k?1:0}function v(d,k){E&&d===z&&k===H||(E=new RegExp(d,k),z=d,H=k);E.lastIndex=0;return E}function A(){}function L(){var d=g.length?g.pop():{sols:{},solModifiers:[]};d.deleteme=!1;return d}function K(){var d=r.length?r.pop():{insts:[]};d.sa=!1;return d}function n(d,k){var C=d[0]-k[0];return 0!==
C?C:d[1]-k[1]}function a(d,k){return d[1]-k[1]}function c(){}function h(d,k,C){if(d!==N||k!==Q||C!==F){var e=v(k,C);x=d.match(e);N=d;Q=k;F=C}}var p=cr$$module$str$c3runtime.system_object.prototype;b.prototype.EveryTick=function(){return!0};b.prototype.OnLayoutStart=function(){return!0};b.prototype.OnLayoutEnd=function(){return!0};b.prototype.Compare=function(d,k,C){return cr$$module$str$c3runtime.do_cmp(d,k,C)};b.prototype.CompareTime=function(d,k){var C=this.runtime.kahanTime.sum;return 0===d?(d=
this.runtime.getCurrentCondition(),!d.extra.CompareTime_executed&&C>=k?d.extra.CompareTime_executed=!0:!1):cr$$module$str$c3runtime.do_cmp(C,d,k)};b.prototype.LayerVisible=function(d){return d?d.visible:!1};b.prototype.LayerEmpty=function(d){return d?!d.instances.length:!1};b.prototype.LayerCmpOpacity=function(d,k,C){return d?cr$$module$str$c3runtime.do_cmp(100*d.opacity,k,C):!1};b.prototype.Repeat=function(d){var k=this.runtime.getCurrentEventStack(),C=k.current_event,e=k.isModifierAfterCnds();k=
this.runtime.pushLoopStack();if(e)for(e=0;e<d&&!k.stopped;e++)this.runtime.pushCopySol(C.solModifiers),k.index=e,C.retrigger(),this.runtime.popSol(C.solModifiers);else for(e=0;e<d&&!k.stopped;e++)k.index=e,C.retrigger();this.runtime.popLoopStack();return!1};b.prototype.While=function(d){var k=this.runtime.getCurrentEventStack();d=k.current_event;var C=k.isModifierAfterCnds();k=this.runtime.pushLoopStack();if(C)for(C=0;!k.stopped;C++)this.runtime.pushCopySol(d.solModifiers),k.index=C,d.retrigger()||
(k.stopped=!0),this.runtime.popSol(d.solModifiers);else for(C=0;!k.stopped;C++)k.index=C,d.retrigger()||(k.stopped=!0);this.runtime.popLoopStack();return!1};b.prototype.For=function(d,k,C){var e=this.runtime.getCurrentEventStack(),u=e.current_event;e=e.isModifierAfterCnds();d=this.runtime.pushLoopStack(d);if(C<k)if(e)for(;k>=C&&!d.stopped;--k)this.runtime.pushCopySol(u.solModifiers),d.index=k,u.retrigger(),this.runtime.popSol(u.solModifiers);else for(;k>=C&&!d.stopped;--k)d.index=k,u.retrigger();
else if(e)for(;k<=C&&!d.stopped;++k)this.runtime.pushCopySol(u.solModifiers),d.index=k,u.retrigger(),this.runtime.popSol(u.solModifiers);else for(;k<=C&&!d.stopped;++k)d.index=k,u.retrigger();this.runtime.popLoopStack();return!1};var m=[],t=-1;b.prototype.ForEach=function(d){var k=d.getCurrentSol();t++;m.length===t&&m.push([]);var C=m[t];cr$$module$str$c3runtime.shallowAssignArray(C,k.getObjects());var e=this.runtime.getCurrentEventStack(),u=e.current_event,G=e.isModifierAfterCnds();e=this.runtime.pushLoopStack();
var I,R,S=d.is_contained;if(G)for(G=0,I=C.length;G<I&&!e.stopped;G++){this.runtime.pushCopySol(u.solModifiers);var V=C[G];k=d.getCurrentSol();k.select_all=!1;cr$$module$str$c3runtime.clearArray(k.instances);k.instances[0]=V;if(S){var T=0;for(R=V.siblings.length;T<R;T++){var Z=V.siblings[T];var aa=Z.type.getCurrentSol();aa.select_all=!1;cr$$module$str$c3runtime.clearArray(aa.instances);aa.instances[0]=Z}}e.index=G;u.retrigger();this.runtime.popSol(u.solModifiers)}else for(k.select_all=!1,cr$$module$str$c3runtime.clearArray(k.instances),
G=0,I=C.length;G<I&&!e.stopped;G++){V=C[G];k.instances[0]=V;if(S)for(T=0,R=V.siblings.length;T<R;T++)Z=V.siblings[T],aa=Z.type.getCurrentSol(),aa.select_all=!1,cr$$module$str$c3runtime.clearArray(aa.instances),aa.instances[0]=Z;e.index=G;u.retrigger()}cr$$module$str$c3runtime.clearArray(C);this.runtime.popLoopStack();t--;return!1};b.prototype.ForEachOrdered=function(d,k,C){k=d.getCurrentSol();t++;m.length===t&&m.push([]);var e=m[t];cr$$module$str$c3runtime.shallowAssignArray(e,k.getObjects());var u=
this.runtime.getCurrentEventStack(),G=u.current_event,I=this.runtime.getCurrentCondition(),R=u.isModifierAfterCnds();u=this.runtime.pushLoopStack();var S;var V=0;for(S=e.length;V<S;V++)e[V].extra.c2_feo_val=I.parameters[1].get(V);e.sort(l);1===C&&e.reverse();C=d.is_contained;if(R)for(V=0,S=e.length;V<S&&!u.stopped;V++){this.runtime.pushCopySol(G.solModifiers);var T=e[V];k=d.getCurrentSol();k.select_all=!1;cr$$module$str$c3runtime.clearArray(k.instances);k.instances[0]=T;if(C)for(I=0,R=T.siblings.length;I<
R;I++){var Z=T.siblings[I];var aa=Z.type.getCurrentSol();aa.select_all=!1;cr$$module$str$c3runtime.clearArray(aa.instances);aa.instances[0]=Z}u.index=V;G.retrigger();this.runtime.popSol(G.solModifiers)}else for(k.select_all=!1,cr$$module$str$c3runtime.clearArray(k.instances),V=0,S=e.length;V<S&&!u.stopped;V++){T=e[V];k.instances[0]=T;if(C)for(I=0,R=T.siblings.length;I<R;I++)Z=T.siblings[I],aa=Z.type.getCurrentSol(),aa.select_all=!1,cr$$module$str$c3runtime.clearArray(aa.instances),aa.instances[0]=
Z;u.index=V;G.retrigger()}cr$$module$str$c3runtime.clearArray(e);this.runtime.popLoopStack();t--;return!1};b.prototype.PickByComparison=function(d,k,C,e){var u,G;if(d){t++;m.length===t&&m.push([]);var I=m[t],R=d.getCurrentSol();cr$$module$str$c3runtime.shallowAssignArray(I,R.getObjects());R.select_all&&cr$$module$str$c3runtime.clearArray(R.else_instances);var S=this.runtime.getCurrentCondition();var V=u=0;for(G=I.length;u<G;u++){var T=I[u];I[V]=T;k=S.parameters[1].get(u);e=S.parameters[3].get(u);
cr$$module$str$c3runtime.do_cmp(k,C,e)?V++:R.else_instances.push(T)}cr$$module$str$c3runtime.truncateArray(I,V);R.select_all=!1;cr$$module$str$c3runtime.shallowAssignArray(R.instances,I);cr$$module$str$c3runtime.clearArray(I);t--;d.applySolToContainer();return!!R.instances.length}};b.prototype.PickByEvaluate=function(d,k){var C,e;if(d){t++;m.length===t&&m.push([]);var u=m[t],G=d.getCurrentSol();cr$$module$str$c3runtime.shallowAssignArray(u,G.getObjects());G.select_all&&cr$$module$str$c3runtime.clearArray(G.else_instances);
var I=this.runtime.getCurrentCondition();var R=C=0;for(e=u.length;C<e;C++){var S=u[C];u[R]=S;(k=I.parameters[1].get(C))?R++:G.else_instances.push(S)}cr$$module$str$c3runtime.truncateArray(u,R);G.select_all=!1;cr$$module$str$c3runtime.shallowAssignArray(G.instances,u);cr$$module$str$c3runtime.clearArray(u);t--;d.applySolToContainer();return!!G.instances.length}};b.prototype.TriggerOnce=function(){var d=this.runtime.getCurrentCondition().extra;"undefined"===typeof d.TriggerOnce_lastTick&&(d.TriggerOnce_lastTick=
-1);var k=d.TriggerOnce_lastTick,C=this.runtime.tickcount;d.TriggerOnce_lastTick=C;return this.runtime.layout_first_tick||k!==C-1};b.prototype.Every=function(d){var k=this.runtime.getCurrentCondition(),C=k.extra.Every_lastTime||0,e=this.runtime.kahanTime.sum;"undefined"===typeof k.extra.Every_seconds&&(k.extra.Every_seconds=d);var u=k.extra.Every_seconds;if(e>=C+u)return k.extra.Every_lastTime=C+u,e>=k.extra.Every_lastTime+.04&&(k.extra.Every_lastTime=e),k.extra.Every_seconds=d,!0;e<C-.1&&(k.extra.Every_lastTime=
e);return!1};b.prototype.PickNth=function(d,k){if(!d)return!1;var C=d.getCurrentSol(),e=C.getObjects();k=cr$$module$str$c3runtime.floor(k);if(0>k||k>=e.length)return!1;C.pick_one(e[k]);d.applySolToContainer();return!0};b.prototype.PickRandom=function(d){if(!d)return!1;var k=d.getCurrentSol(),C=k.getObjects(),e=cr$$module$str$c3runtime.floor(Math.random()*C.length);if(e>=C.length)return!1;k.pick_one(C[e]);d.applySolToContainer();return!0};b.prototype.CompareVar=function(d,k,C){return cr$$module$str$c3runtime.do_cmp(d.getValue(),
k,C)};b.prototype.CompareBoolVar=function(d){return d.getValue()};b.prototype.IsGroupActive=function(d){return(d=this.runtime.groups_by_name[d.toLowerCase()])&&d.group_active};b.prototype.IsPreview=function(){return this.runtime.isPreview};b.prototype.PickAll=function(d){if(!d||!d.instances.length)return!1;d.getCurrentSol().select_all=!0;d.applySolToContainer();return!0};b.prototype.IsMobile=function(){return this.runtime.isMobile};b.prototype.CompareBetween=function(d,k,C){return d>=k&&d<=C};b.prototype.Else=
function(){var d=this.runtime.getCurrentEventStack();return d.else_branch_ran?!1:!d.last_event_true};b.prototype.OnLoadFinished=function(){return!0};b.prototype.OnCanvasSnapshot=function(){return!0};b.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};b.prototype.OnSaveComplete=function(){return!0};b.prototype.OnSaveFailed=function(){return!0};b.prototype.OnLoadComplete=function(){return!0};b.prototype.OnLoadFailed=function(){return!0};b.prototype.ObjectUIDExists=function(d){return!!this.runtime.getObjectByUID(d)};
b.prototype.IsOnPlatform=function(d){var k=this.runtime;switch(d){case 0:return!k.isNodeWebkit&&!k.isCordova&&!k.isWinJS&&!k.isWindowsPhone8&&!k.isBlackberry10&&!k.isAmazonWebApp;case 1:return k.isiOS;case 2:return k.isAndroid;case 3:return k.isWindows8App;case 4:return k.isWindowsPhone8;case 5:return k.isBlackberry10;case 6:return k.isTizen;case 7:return!1;case 8:return k.isCordova;case 9:return k.isArcade;case 10:return k.isNodeWebkit;case 11:return k.isCrosswalk;case 12:return k.isAmazonWebApp;
case 13:return k.isWindows10;default:return!1}};var E=null,z="",H="";b.prototype.RegexTest=function(d,k,C){return v(k,C).test(d)};var B=[];b.prototype.PickOverlappingPoint=function(d,k,C){if(!d)return!1;var e=d.getCurrentSol(),u=e.getObjects(),G=this.runtime.getCurrentEventStack().current_event.orblock,I=this.runtime.getCurrentCondition(),R;e.select_all?(cr$$module$str$c3runtime.shallowAssignArray(B,u),cr$$module$str$c3runtime.clearArray(e.else_instances),e.select_all=!1,cr$$module$str$c3runtime.clearArray(e.instances)):
G?(cr$$module$str$c3runtime.shallowAssignArray(B,e.else_instances),cr$$module$str$c3runtime.clearArray(e.else_instances)):(cr$$module$str$c3runtime.shallowAssignArray(B,u),cr$$module$str$c3runtime.clearArray(e.instances));u=0;for(G=B.length;u<G;++u){var S=B[u];S.update_bbox();(R=cr$$module$str$c3runtime.xor(S.contains_pt(k,C),I.inverted))?e.instances.push(S):e.else_instances.push(S)}d.applySolToContainer();return cr$$module$str$c3runtime.xor(!!e.instances.length,I.inverted)};b.prototype.PickLastCreated=
function(d){if(!d)return!1;var k=this.runtime.createRow,C,e=null,u=d.is_family;for(C=k.length-1;0<=C;--C){var G=k[C];if(u){if(0<=G.type.families.indexOf(d)){e=G;break}}else if(G.type===d){e=G;break}}!e&&d.instances.length&&(e=d.instances[d.instances.length-1]);if(!e)return!1;d.getCurrentSol().pick_one(e);d.applySolToContainer();return!0};b.prototype.IsNaN=function(d){return!!isNaN(d)};b.prototype.AngleWithin=function(d,k,C){return cr$$module$str$c3runtime.angleDiff(cr$$module$str$c3runtime.to_radians(d),
cr$$module$str$c3runtime.to_radians(C))<=cr$$module$str$c3runtime.to_radians(k)};b.prototype.IsClockwiseFrom=function(d,k){return cr$$module$str$c3runtime.angleClockwise(cr$$module$str$c3runtime.to_radians(d),cr$$module$str$c3runtime.to_radians(k))};b.prototype.IsBetweenAngles=function(d,k,C){d=cr$$module$str$c3runtime.to_clamped_radians(d);k=cr$$module$str$c3runtime.to_clamped_radians(k);C=cr$$module$str$c3runtime.to_clamped_radians(C);return cr$$module$str$c3runtime.angleClockwise(C,k)?cr$$module$str$c3runtime.angleClockwise(d,
k)&&!cr$$module$str$c3runtime.angleClockwise(d,C):!(!cr$$module$str$c3runtime.angleClockwise(d,k)&&cr$$module$str$c3runtime.angleClockwise(d,C))};b.prototype.IsValueType=function(d,k){return"number"===typeof d?0===k:1===k};p.cnds=new b;A.prototype.GoToLayout=function(d){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=d)};A.prototype.NextPrevLayout=function(d){if(!this.runtime.isloading&&!this.runtime.changelayout){var k=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);
if(!d||0!==k)if(d||k!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=this.runtime.layouts_by_index[k+(d?-1:1)]}};A.prototype.CreateObject=function(d,k,C,e){if(k&&d&&(k=this.runtime.createInstance(d,k,C,e))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(d.plugin).cnds.OnCreated,k);if(k.is_contained)for(C=0,e=k.siblings.length;C<e;C++){var u=k.siblings[C];this.runtime.trigger(Object.getPrototypeOf(u.type.plugin).cnds.OnCreated,u)}this.runtime.isInOnDestroy--;
d=d.getCurrentSol();d.select_all=!1;cr$$module$str$c3runtime.clearArray(d.instances);d.instances[0]=k;if(k.is_contained)for(C=0,e=k.siblings.length;C<e;C++)u=k.siblings[C],d=u.type.getCurrentSol(),d.select_all=!1,cr$$module$str$c3runtime.clearArray(d.instances),d.instances[0]=u}};A.prototype.CreateObjectByName=function(d,k,C,e){k&&d&&(d=this.runtime.types_lowercase[d.toLowerCase()])&&A.prototype.CreateObject.call(this,d,k,C,e)};A.prototype.SetLayerVisible=function(d,k){d&&d.visible!==k&&(d.visible=
k,this.runtime.redraw=!0)};A.prototype.SetLayerOpacity=function(d,k){d&&(k=cr$$module$str$c3runtime.clamp(k/100,0,1),d.opacity!==k&&(d.opacity=k,this.runtime.redraw=!0))};A.prototype.SetLayerScaleRate=function(d,k){d&&d.zoomRate!==k&&(d.zoomRate=k,this.runtime.redraw=!0)};A.prototype.SetLayerForceOwnTexture=function(d,k){d&&(k=!!k,d.forceOwnTexture!==k&&(d.forceOwnTexture=k,this.runtime.redraw=!0))};A.prototype.SetLayoutScale=function(d){this.runtime.running_layout&&this.runtime.running_layout.scale!==
d&&(this.runtime.running_layout.scale=d,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)};A.prototype.ScrollX=function(d){this.runtime.running_layout.scrollToX(d)};A.prototype.ScrollY=function(d){this.runtime.running_layout.scrollToY(d)};A.prototype.Scroll=function(d,k){this.runtime.running_layout.scrollToX(d);this.runtime.running_layout.scrollToY(k)};A.prototype.ScrollToObject=function(d){if(d=d.getFirstPicked())this.runtime.running_layout.scrollToX(d.x),this.runtime.running_layout.scrollToY(d.y)};
A.prototype.SetVar=function(d,k){0===d.vartype?cr$$module$str$c3runtime.is_number(k)?d.setValue(k):d.setValue(parseFloat(k)):1===d.vartype&&d.setValue(k.toString())};A.prototype.AddVar=function(d,k){0===d.vartype?cr$$module$str$c3runtime.is_number(k)?d.setValue(d.getValue()+k):d.setValue(d.getValue()+parseFloat(k)):1===d.vartype&&d.setValue(d.getValue()+k.toString())};A.prototype.SubVar=function(d,k){0===d.vartype&&(cr$$module$str$c3runtime.is_number(k)?d.setValue(d.getValue()-k):d.setValue(d.getValue()-
parseFloat(k)))};A.prototype.SetBoolVar=function(d,k){d.setValue(0!==k)};A.prototype.ToggleBoolVar=function(d){d.setValue(!d.getValue())};A.prototype.SetGroupActive=function(d,k){if(d=this.runtime.groups_by_name[d.toLowerCase()])switch(k){case 0:d.setGroupActive(!1);break;case 1:d.setGroupActive(!0);break;case 2:d.setGroupActive(!d.group_active)}};A.prototype.SetTimescale=function(d){0>d&&(d=0);this.runtime.timescale=d};A.prototype.SetObjectTimescale=function(d,k){0>k&&(k=0);if(d){d=d.getCurrentSol().getObjects();
var C;var e=0;for(C=d.length;e<C;e++)d[e].my_timescale=k}};A.prototype.RestoreObjectTimescale=function(d){if(!d)return!1;d=d.getCurrentSol().getObjects();var k;var C=0;for(k=d.length;C<k;C++)d[C].my_timescale=-1};var g=[],r=[];A.prototype.Wait=function(d){if(!(0>d)){var k,C=this.runtime.getCurrentEventStack(),e=L();e.time=this.runtime.kahanTime.sum+d;e.signaltag="";e.signalled=!1;e.ev=C.current_event;e.actindex=C.actindex+1;d=0;for(k=this.runtime.types_by_index.length;d<k;d++){var u=this.runtime.types_by_index[d];
var G=u.getCurrentSol();G.select_all&&-1===C.current_event.solModifiers.indexOf(u)||(e.solModifiers.push(u),u=K(),u.sa=G.select_all,cr$$module$str$c3runtime.shallowAssignArray(u.insts,G.instances),e.sols[d.toString()]=u)}this.waits.push(e);return!0}};A.prototype.WaitForSignal=function(d){var k,C=this.runtime.getCurrentEventStack(),e=L();e.time=-1;e.signaltag=d.toLowerCase();e.signalled=!1;e.ev=C.current_event;e.actindex=C.actindex+1;d=0;for(k=this.runtime.types_by_index.length;d<k;d++){var u=this.runtime.types_by_index[d];
var G=u.getCurrentSol();G.select_all&&-1===C.current_event.solModifiers.indexOf(u)||(e.solModifiers.push(u),u=K(),u.sa=G.select_all,cr$$module$str$c3runtime.shallowAssignArray(u.insts,G.instances),e.sols[d.toString()]=u)}this.waits.push(e);return!0};A.prototype.Signal=function(d){d=d.toLowerCase();var k;var C=0;for(k=this.waits.length;C<k;++C){var e=this.waits[C];-1===e.time&&e.signaltag===d&&(e.signalled=!0)}};A.prototype.SetLayerScale=function(d,k){d&&d.scale!==k&&(d.scale=k,this.runtime.redraw=
!0)};A.prototype.ResetGlobals=function(){var d;var k=0;for(d=this.runtime.all_global_vars.length;k<d;k++){var C=this.runtime.all_global_vars[k];C.data=C.initial}};A.prototype.SetLayoutAngle=function(d){d=cr$$module$str$c3runtime.to_radians(d);d=cr$$module$str$c3runtime.clamp_angle(d);this.runtime.running_layout&&this.runtime.running_layout.angle!==d&&(this.runtime.running_layout.angle=d,this.runtime.redraw=!0)};A.prototype.SetLayerAngle=function(d,k){d&&(k=cr$$module$str$c3runtime.to_radians(k),k=
cr$$module$str$c3runtime.clamp_angle(k),d.angle!==k&&(d.angle=k,this.runtime.redraw=!0))};A.prototype.SetLayerParallax=function(d,k,C){if(d&&(d.parallaxX!==k/100||d.parallaxY!==C/100)){d.parallaxX=k/100;d.parallaxY=C/100;if(1!==d.parallaxX||1!==d.parallaxY)for(C=d.instances,d=0,k=C.length;d<k;++d)C[d].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};A.prototype.SetLayerBackground=function(d,k){if(d){var C=cr$$module$str$c3runtime.clamp(Math.floor(255*cr$$module$str$c3runtime.GetRValue(k)),
0,255),e=cr$$module$str$c3runtime.clamp(Math.floor(255*cr$$module$str$c3runtime.GetGValue(k)),0,255);k=cr$$module$str$c3runtime.clamp(Math.floor(255*cr$$module$str$c3runtime.GetBValue(k)),0,255);if(d.background_color[0]!==C||d.background_color[1]!==e||d.background_color[2]!==k)d.background_color[0]=C,d.background_color[1]=e,d.background_color[2]=k,this.runtime.redraw=!0}};A.prototype.SetLayerTransparent=function(d,k){d&&!!k!==!!d.transparent&&(d.transparent=!!k,this.runtime.redraw=!0)};A.prototype.SetLayerBlendMode=
function(d,k){d&&d.blend_mode!==k&&(d.blend_mode=k,d.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(d.blend_mode),this.runtime.gl&&cr$$module$str$c3runtime.setGLBlend(d,d.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};A.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||(this.runtime.getCurrentLoop().stopped=!0)};A.prototype.GoToLayoutByName=function(d){if(!this.runtime.isloading&&!this.runtime.changelayout)for(var k in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(k)&&
cr$$module$str$c3runtime.equals_nocase(k,d)){this.runtime.changelayout=this.runtime.layouts[k];break}};A.prototype.RestartLayout=function(d){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var k;d=0;for(k=this.runtime.allGroups.length;d<k;d++){var C=this.runtime.allGroups[d];C.setGroupActive(C.initially_activated)}}};A.prototype.SnapshotCanvas=function(d,k){this.runtime.doCanvasSnapshot(0===d?"image/png":"image/jpeg",
k/100)};A.prototype.SetCanvasSize=function(d,k){if(!(0>=d||0>=k)){var C=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen)&&0<this.runtime.fullscreen_scaling&&(C=this.runtime.fullscreen_scaling);0===C?this.runtime.setSize(d,k,!0):(this.runtime.original_width=d,this.runtime.original_height=k,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}};A.prototype.SetLayoutEffectEnabled=function(d,
k){this.runtime.running_layout&&this.runtime.glwrap&&(k=this.runtime.running_layout.getEffectByName(k))&&(d=1===d,k.active!=d&&(k.active=d,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};A.prototype.SetLayerEffectEnabled=function(d,k,C){d&&this.runtime.glwrap&&(C=d.getEffectByName(C))&&(k=1===k,C.active!=k&&(C.active=k,d.updateActiveEffects(),this.runtime.redraw=!0))};A.prototype.SetLayoutEffectParam=function(d,k,C){if(this.runtime.running_layout&&this.runtime.glwrap&&
(d=this.runtime.running_layout.getEffectByName(d))){var e=this.runtime.running_layout.effect_params[d.index];k=Math.floor(k);if(!(0>k||k>=e.length)){var u=this.runtime.glwrap.getProgramParameterType(d.shaderindex,k);1===u?C/=100:2===u&&(C=[cr$$module$str$c3runtime.GetRValue(C),cr$$module$str$c3runtime.GetGValue(C),cr$$module$str$c3runtime.GetBValue(C)]);e[k]!==C&&(e[k]=C,d.active&&(this.runtime.redraw=!0))}}};A.prototype.SetLayerEffectParam=function(d,k,C,e){if(d&&this.runtime.glwrap&&(k=d.getEffectByName(k))&&
(d=d.effect_params[k.index],C=Math.floor(C),!(0>C||C>=d.length))){var u=this.runtime.glwrap.getProgramParameterType(k.shaderindex,C);1===u?e/=100:2===u&&(e=[cr$$module$str$c3runtime.GetRValue(e),cr$$module$str$c3runtime.GetGValue(e),cr$$module$str$c3runtime.GetBValue(e)]);d[C]!==e&&(d[C]=e,k.active&&(this.runtime.redraw=!0))}};A.prototype.SaveState=function(d){this.runtime.saveToSlot=d};A.prototype.LoadState=function(d){this.runtime.loadFromSlot=d};A.prototype.LoadStateJSON=function(d){this.runtime.loadFromJson=
d};A.prototype.SetHalfFramerateMode=function(d){this.runtime.halfFramerateMode=0!==d};A.prototype.SetFullscreenQuality=function(d){if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==d,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};A.prototype.ResetPersisted=function(){var d;var k=0;for(d=this.runtime.layouts_by_index.length;k<
d;++k)this.runtime.layouts_by_index[k].persist_data={},this.runtime.layouts_by_index[k].first_visit=!0};A.prototype.RecreateInitialObjects=function(d,k,C,e,u){d&&this.runtime.running_layout.recreateInitialObjects(d,k,C,e,u)};A.prototype.SetPixelRounding=function(d){this.runtime.pixel_rounding=0!==d;this.runtime.redraw=!0};A.prototype.SetMinimumFramerate=function(d){1>d&&(d=1);120<d&&(d=120);this.runtime.minimumFramerate=d};A.prototype.SortZOrderByInstVar=function(d,k){if(d){var C;var e=d.getCurrentSol().getObjects();
var u=[],G=[],I=this.runtime.running_layout,R=d.is_family,S=d.family_index,V=!1;d=0;for(C=e.length;d<C;++d){var T=e[d];if(T.layer){var Z=R?T.instance_vars[k+T.type.family_var_map[S]]:T.instance_vars[k];u.push([T.layer.index,T.get_zindex()]);G.push([T,Z])}}if(u.length){u.sort(n);G.sort(a);d=0;for(C=u.length;d<C;++d)T=G[d][0],k=I.layers[u[d][0]],e=u[d][1],k.instances[e]!==T&&(k.instances[e]=T,T.layer=k,k.setZIndicesStaleFrom(e),V=!0);V&&(this.runtime.redraw=!0)}}};p.acts=new A;c.prototype.int=function(d,
k){cr$$module$str$c3runtime.is_string(k)?(d.set_int(parseInt(k,10)),isNaN(d.data)&&(d.data=0)):d.set_int(k)};c.prototype.float=function(d,k){cr$$module$str$c3runtime.is_string(k)?(d.set_float(parseFloat(k)),isNaN(d.data)&&(d.data=0)):d.set_float(k)};c.prototype.str=function(d,k){cr$$module$str$c3runtime.is_string(k)?d.set_string(k):d.set_string(k.toString())};c.prototype.len=function(d,k){d.set_int(k.length||0)};c.prototype.random=function(d,k,C){void 0===C?d.set_float(Math.random()*k):d.set_float(Math.random()*
(C-k)+k)};c.prototype.sqrt=function(d,k){d.set_float(Math.sqrt(k))};c.prototype.abs=function(d,k){d.set_float(Math.abs(k))};c.prototype.round=function(d,k){d.set_int(Math.round(k))};c.prototype.floor=function(d,k){d.set_int(Math.floor(k))};c.prototype.ceil=function(d,k){d.set_int(Math.ceil(k))};c.prototype.sign=function(d,k){d.set_float(Math.sign(k))};c.prototype.sin=function(d,k){d.set_float(Math.sin(cr$$module$str$c3runtime.to_radians(k)))};c.prototype.cos=function(d,k){d.set_float(Math.cos(cr$$module$str$c3runtime.to_radians(k)))};
c.prototype.tan=function(d,k){d.set_float(Math.tan(cr$$module$str$c3runtime.to_radians(k)))};c.prototype.asin=function(d,k){d.set_float(cr$$module$str$c3runtime.to_degrees(Math.asin(k)))};c.prototype.acos=function(d,k){d.set_float(cr$$module$str$c3runtime.to_degrees(Math.acos(k)))};c.prototype.atan=function(d,k){d.set_float(cr$$module$str$c3runtime.to_degrees(Math.atan(k)))};c.prototype.exp=function(d,k){d.set_float(Math.exp(k))};c.prototype.ln=function(d,k){d.set_float(Math.log(k))};c.prototype.log10=
function(d,k){d.set_float(Math.log(k)/Math.LN10)};c.prototype.max=function(d){var k=arguments[1];"number"!==typeof k&&(k=0);var C;var e=2;for(C=arguments.length;e<C;e++){var u=arguments[e];"number"===typeof u&&k<u&&(k=u)}d.set_float(k)};c.prototype.min=function(d){var k=arguments[1];"number"!==typeof k&&(k=0);var C;var e=2;for(C=arguments.length;e<C;e++){var u=arguments[e];"number"===typeof u&&k>u&&(k=u)}d.set_float(k)};c.prototype.dt=function(d){d.set_float(this.runtime.dt)};c.prototype.timescale=
function(d){d.set_float(this.runtime.timescale)};c.prototype.wallclocktime=function(d){d.set_float((Date.now()-this.runtime.start_time)/1E3)};c.prototype.unixtime=function(d){d.set_float(Date.now())};c.prototype.time=function(d){d.set_float(this.runtime.kahanTime.sum)};c.prototype.tickcount=function(d){d.set_int(this.runtime.tickcount)};c.prototype.objectcount=function(d){d.set_int(this.runtime.objectcount)};c.prototype.fps=function(d){d.set_int(this.runtime.fps)};c.prototype.loopindex=function(d,
k){var C;if(this.runtime.loop_stack.length)if(k){for(C=this.runtime.loop_stack_index;0<=C;--C){var e=this.runtime.loop_stack[C];if(e.name===k){d.set_int(e.index);return}}d.set_int(0)}else e=this.runtime.getCurrentLoop(),d.set_int(e?e.index:-1);else d.set_int(0)};c.prototype.distance=function(d,k,C,e,u){d.set_float(cr$$module$str$c3runtime.distanceTo(k,C,e,u))};c.prototype.angle=function(d,k,C,e,u){d.set_float(cr$$module$str$c3runtime.to_degrees(cr$$module$str$c3runtime.angleTo(k,C,e,u)))};c.prototype.scrollx=
function(d){d.set_float(this.runtime.running_layout.scrollX)};c.prototype.scrolly=function(d){d.set_float(this.runtime.running_layout.scrollY)};c.prototype.newline=function(d){d.set_string("\n")};c.prototype.lerp=function(d,k,C,e){d.set_float(cr$$module$str$c3runtime.lerp(k,C,e))};c.prototype.qarp=function(d,k,C,e,u){d.set_float(cr$$module$str$c3runtime.qarp(k,C,e,u))};c.prototype.cubic=function(d,k,C,e,u,G){d.set_float(cr$$module$str$c3runtime.cubic(k,C,e,u,G))};c.prototype.cosp=function(d,k,C,e){d.set_float(cr$$module$str$c3runtime.cosp(k,
C,e))};c.prototype.windowwidth=function(d){d.set_int(this.runtime.width)};c.prototype.windowheight=function(d){d.set_int(this.runtime.height)};c.prototype.uppercase=function(d,k){d.set_string(cr$$module$str$c3runtime.is_string(k)?k.toUpperCase():"")};c.prototype.lowercase=function(d,k){d.set_string(cr$$module$str$c3runtime.is_string(k)?k.toLowerCase():"")};c.prototype.clamp=function(d,k,C,e){k<C?d.set_float(C):k>e?d.set_float(e):d.set_float(k)};c.prototype.layerscale=function(d,k){(k=this.runtime.getLayer(k))?
d.set_float(k.scale):d.set_float(0)};c.prototype.layeropacity=function(d,k){(k=this.runtime.getLayer(k))?d.set_float(100*k.opacity):d.set_float(0)};c.prototype.layerscalerate=function(d,k){(k=this.runtime.getLayer(k))?d.set_float(k.zoomRate):d.set_float(0)};c.prototype.layerparallaxx=function(d,k){(k=this.runtime.getLayer(k))?d.set_float(100*k.parallaxX):d.set_float(0)};c.prototype.layerparallaxy=function(d,k){(k=this.runtime.getLayer(k))?d.set_float(100*k.parallaxY):d.set_float(0)};c.prototype.layerindex=
function(d,k){(k=this.runtime.getLayer(k))?d.set_int(k.index):d.set_int(-1)};c.prototype.layoutscale=function(d){this.runtime.running_layout?d.set_float(this.runtime.running_layout.scale):d.set_float(0)};c.prototype.layoutangle=function(d){d.set_float(cr$$module$str$c3runtime.to_degrees(this.runtime.running_layout.angle))};c.prototype.layerangle=function(d,k){(k=this.runtime.getLayer(k))?d.set_float(cr$$module$str$c3runtime.to_degrees(k.angle)):d.set_float(0)};c.prototype.layoutwidth=function(d){d.set_int(this.runtime.running_layout.width)};
c.prototype.layoutheight=function(d){d.set_int(this.runtime.running_layout.height)};c.prototype.find=function(d,k,C){cr$$module$str$c3runtime.is_string(k)&&cr$$module$str$c3runtime.is_string(C)?d.set_int(k.search(new RegExp(cr$$module$str$c3runtime.regexp_escape(C),"i"))):d.set_int(-1)};c.prototype.findcase=function(d,k,C){cr$$module$str$c3runtime.is_string(k)&&cr$$module$str$c3runtime.is_string(C)?d.set_int(k.search(new RegExp(cr$$module$str$c3runtime.regexp_escape(C),""))):d.set_int(-1)};c.prototype.left=
function(d,k,C){d.set_string(cr$$module$str$c3runtime.is_string(k)?k.substr(0,C):"")};c.prototype.right=function(d,k,C){d.set_string(cr$$module$str$c3runtime.is_string(k)?k.substr(k.length-C):"")};c.prototype.mid=function(d,k,C,e){d.set_string(cr$$module$str$c3runtime.is_string(k)?k.substr(C,e):"")};c.prototype.tokenat=function(d,k,C,e){cr$$module$str$c3runtime.is_string(k)&&cr$$module$str$c3runtime.is_string(e)?(k=k.split(e),C=cr$$module$str$c3runtime.floor(C),0>C||C>=k.length?d.set_string(""):d.set_string(k[C])):
d.set_string("")};c.prototype.tokencount=function(d,k,C){cr$$module$str$c3runtime.is_string(k)&&k.length?d.set_int(k.split(C).length):d.set_int(0)};c.prototype.replace=function(d,k,C,e){cr$$module$str$c3runtime.is_string(k)&&cr$$module$str$c3runtime.is_string(C)&&cr$$module$str$c3runtime.is_string(e)?d.set_string(k.replace(new RegExp(cr$$module$str$c3runtime.regexp_escape(C),"gi"),e)):d.set_string(cr$$module$str$c3runtime.is_string(k)?k:"")};c.prototype.trim=function(d,k){d.set_string(cr$$module$str$c3runtime.is_string(k)?
k.trim():"")};c.prototype.pi=function(d){d.set_float(cr$$module$str$c3runtime.PI)};c.prototype.layoutname=function(d){this.runtime.running_layout?d.set_string(this.runtime.running_layout.name):d.set_string("")};c.prototype.renderer=function(d){d.set_string(this.runtime.gl?"webgl":"canvas2d")};c.prototype.rendererdetail=function(d){d.set_string(this.runtime.glUnmaskedRenderer)};c.prototype.anglediff=function(d,k,C){d.set_float(cr$$module$str$c3runtime.to_degrees(cr$$module$str$c3runtime.angleDiff(cr$$module$str$c3runtime.to_radians(k),
cr$$module$str$c3runtime.to_radians(C))))};c.prototype.choose=function(d){var k=cr$$module$str$c3runtime.floor(Math.random()*(arguments.length-1));d.set_any(arguments[k+1])};c.prototype.rgb=function(d,k,C,e){d.set_int(cr$$module$str$c3runtime.RGB(k,C,e))};c.prototype.rgbex=function(d,k,C,e){d.set_float(cr$$module$str$c3runtime.RGBEx(k/100,C/100,e/100))};c.prototype.projectversion=function(d){d.set_string(this.runtime.versionstr)};c.prototype.projectname=function(d){d.set_string(this.runtime.name)};
c.prototype.anglelerp=function(d,k,C,e){k=cr$$module$str$c3runtime.to_radians(k);C=cr$$module$str$c3runtime.to_radians(C);var u=cr$$module$str$c3runtime.angleDiff(k,C);cr$$module$str$c3runtime.angleClockwise(C,k)?d.set_float(cr$$module$str$c3runtime.to_clamped_degrees(k+u*e)):d.set_float(cr$$module$str$c3runtime.to_clamped_degrees(k-u*e))};c.prototype.anglerotate=function(d,k,C,e){k=cr$$module$str$c3runtime.to_radians(k);C=cr$$module$str$c3runtime.to_radians(C);e=cr$$module$str$c3runtime.to_radians(e);
d.set_float(cr$$module$str$c3runtime.to_clamped_degrees(cr$$module$str$c3runtime.angleRotate(k,C,e)))};c.prototype.zeropad=function(d,k,C){var e=0>k?"-":"";0>k&&(k=-k);C-=k.toString().length;for(var u=0;u<C;u++)e+="0";d.set_string(e+k.toString())};c.prototype.cpuutilisation=function(d){d.set_float(this.runtime.cpuutilisation/1E3)};c.prototype.gpuutilisation=function(d){d.set_float(this.runtime.gpuLastUtilisation)};c.prototype.viewportleft=function(d,k){k=this.runtime.getLayer(k);d.set_float(k?k.viewLeft:
0)};c.prototype.viewporttop=function(d,k){k=this.runtime.getLayer(k);d.set_float(k?k.viewTop:0)};c.prototype.viewportright=function(d,k){k=this.runtime.getLayer(k);d.set_float(k?k.viewRight:0)};c.prototype.viewportbottom=function(d,k){k=this.runtime.getLayer(k);d.set_float(k?k.viewBottom:0)};c.prototype.loadingprogress=function(d){d.set_float(this.runtime.loadingprogress)};c.prototype.unlerp=function(d,k,C,e){d.set_float(cr$$module$str$c3runtime.unlerp(k,C,e))};c.prototype.canvassnapshot=function(d){d.set_string(this.runtime.snapshotData)};
c.prototype.urlencode=function(d,k){d.set_string(encodeURIComponent(k))};c.prototype.urldecode=function(d,k){d.set_string(decodeURIComponent(k))};c.prototype.canvastolayerx=function(d,k,C,e){k=this.runtime.getLayer(k);d.set_float(k?k.canvasToLayer(C,e,!0):0)};c.prototype.canvastolayery=function(d,k,C,e){k=this.runtime.getLayer(k);d.set_float(k?k.canvasToLayer(C,e,!1):0)};c.prototype.layertocanvasx=function(d,k,C,e){k=this.runtime.getLayer(k);d.set_float(k?k.layerToCanvas(C,e,!0):0)};c.prototype.layertocanvasy=
function(d,k,C,e){k=this.runtime.getLayer(k);d.set_float(k?k.layerToCanvas(C,e,!1):0)};c.prototype.savestatejson=function(d){d.set_string(this.runtime.lastSaveJson)};c.prototype.imagememoryusage=function(d){this.runtime.glwrap?d.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):d.set_float(0)};c.prototype.regexsearch=function(d,k,C,e){C=v(C,e);d.set_int(k?k.search(C):-1)};c.prototype.regexreplace=function(d,k,C,e,u){C=v(C,e);d.set_string(k?k.replace(C,u):"")};var x=[],N="",
Q="",F="";c.prototype.regexmatchcount=function(d,k,C,e){v(C,e);h(k.toString(),C,e);d.set_int(x?x.length:0)};c.prototype.regexmatchat=function(d,k,C,e,u){u=Math.floor(u);v(C,e);h(k.toString(),C,e);!x||0>u||u>=x.length?d.set_string(""):d.set_string(x[u])};c.prototype.infinity=function(d){d.set_float(Infinity)};c.prototype.setbit=function(d,k,C,e){C|=0;d.set_int((k|0)&~(1<<C)|(0!==e?1:0)<<C)};c.prototype.togglebit=function(d,k,C){d.set_int((k|0)^1<<(C|0))};c.prototype.getbit=function(d,k,C){d.set_int((k|
0)&1<<(C|0)?1:0)};c.prototype.originalwindowwidth=function(d){d.set_int(this.runtime.original_width)};c.prototype.originalwindowheight=function(d){d.set_int(this.runtime.original_height)};c.prototype.originalviewportwidth=function(d){d.set_int(this.runtime.original_width)};c.prototype.originalviewportheight=function(d){d.set_int(this.runtime.original_height)};p.exps=new c;p.runWaits=function(){var d,k=this.runtime.getCurrentEventStack();var C=0;for(d=this.waits.length;C<d;C++){var e=this.waits[C];
if(-1===e.time){if(!e.signalled)continue}else if(e.time>this.runtime.kahanTime.sum)continue;k.current_event=e.ev;k.actindex=e.actindex;k.cndindex=0;for(I in e.sols)if(e.sols.hasOwnProperty(I)){var u=this.runtime.types_by_index[parseInt(I,10)].getCurrentSol();var G=e.sols[I];u.select_all=G.sa;cr$$module$str$c3runtime.shallowAssignArray(u.instances,G.insts);u=G;cr$$module$str$c3runtime.clearArray(u.insts);r.push(u)}e.ev.resume_actions_and_subevents();this.runtime.clearSol(e.solModifiers);e.deleteme=
!0}var I=C=0;for(d=this.waits.length;C<d;C++)e=this.waits[C],this.waits[I]=e,e.deleteme?(cr$$module$str$c3runtime.wipe(e.sols),cr$$module$str$c3runtime.clearArray(e.solModifiers),g.push(e)):I++;cr$$module$str$c3runtime.truncateArray(this.waits,I)}})();
(function(){cr$$module$str$c3runtime.add_common_aces=function(l,v){var A=l[1],L=l[3],K=l[4],n=l[5],a=l[6],c=l[7],h=l[8],p=l[10],m=l[11];l=l[12];v.cnds||(v.cnds={});v.acts||(v.acts={});v.exps||(v.exps={});var t=v.cnds,E=v.acts;v=v.exps;L&&(t.CompareX=function(z,H){return cr$$module$str$c3runtime.do_cmp(this.x,z,H)},t.CompareY=function(z,H){return cr$$module$str$c3runtime.do_cmp(this.y,z,H)},t.IsOnScreen=function(){var z=this.layer;this.update_bbox();var H=this.bbox;return!(H.right<z.viewLeft||H.bottom<
z.viewTop||H.left>z.viewRight||H.top>z.viewBottom)},t.IsOutsideLayout=function(){this.update_bbox();var z=this.bbox,H=this.runtime.running_layout;return 0>z.right||0>z.bottom||z.left>H.width||z.top>H.height},t.PickDistance=function(z,H,B){var g=this.getCurrentSol(),r=g.getObjects();if(!r.length)return!1;var x=r[0],N=x,Q=cr$$module$str$c3runtime.distanceTo(x.x,x.y,H,B),F;var d=1;for(F=r.length;d<F;d++){x=r[d];var k=cr$$module$str$c3runtime.distanceTo(x.x,x.y,H,B);if(0===z&&k<Q||1===z&&k>Q)Q=k,N=x}g.pick_one(N);
return!0},E.SetX=function(z){this.x!==z&&(this.x=z,this.set_bbox_changed())},E.SetY=function(z){this.y!==z&&(this.y=z,this.set_bbox_changed())},E.SetPos=function(z,H){if(this.x!==z||this.y!==H)this.x=z,this.y=H,this.set_bbox_changed()},E.SetPosToObject=function(z,H){var B=z.getPairedInstance(this);B&&(B.getImagePoint?(z=B.getImagePoint(H,!0),H=B.getImagePoint(H,!1)):(z=B.x,H=B.y),this.x!==z||this.y!==H)&&(this.x=z,this.y=H,this.set_bbox_changed())},E.MoveForward=function(z){0!==z&&(this.x+=Math.cos(this.angle)*
z,this.y+=Math.sin(this.angle)*z,this.set_bbox_changed())},E.MoveAtAngle=function(z,H){0!==H&&(this.x+=Math.cos(cr$$module$str$c3runtime.to_radians(z))*H,this.y+=Math.sin(cr$$module$str$c3runtime.to_radians(z))*H,this.set_bbox_changed())},v.X=function(z){z.set_float(this.x)},v.Y=function(z){z.set_float(this.y)},v.dt=function(z){z.set_float(this.runtime.getDt(this))});K&&(t.CompareWidth=function(z,H){return cr$$module$str$c3runtime.do_cmp(this.width,z,H)},t.CompareHeight=function(z,H){return cr$$module$str$c3runtime.do_cmp(this.height,
z,H)},E.SetWidth=function(z){this.width!==z&&(this.width=z,this.set_bbox_changed())},E.SetHeight=function(z){this.height!==z&&(this.height=z,this.set_bbox_changed())},E.SetSize=function(z,H){if(this.width!==z||this.height!==H)this.width=z,this.height=H,this.set_bbox_changed()},v.Width=function(z){z.set_float(this.width)},v.Height=function(z){z.set_float(this.height)},v.BBoxLeft=function(z){this.update_bbox();z.set_float(this.bbox.left)},v.BBoxTop=function(z){this.update_bbox();z.set_float(this.bbox.top)},
v.BBoxRight=function(z){this.update_bbox();z.set_float(this.bbox.right)},v.BBoxBottom=function(z){this.update_bbox();z.set_float(this.bbox.bottom)});n&&(t.AngleWithin=function(z,H){return cr$$module$str$c3runtime.angleDiff(this.angle,cr$$module$str$c3runtime.to_radians(H))<=cr$$module$str$c3runtime.to_radians(z)},t.IsClockwiseFrom=function(z){return cr$$module$str$c3runtime.angleClockwise(this.angle,cr$$module$str$c3runtime.to_radians(z))},t.IsBetweenAngles=function(z,H){z=cr$$module$str$c3runtime.to_clamped_radians(z);
H=cr$$module$str$c3runtime.to_clamped_radians(H);var B=cr$$module$str$c3runtime.clamp_angle(this.angle);return cr$$module$str$c3runtime.angleClockwise(H,z)?cr$$module$str$c3runtime.angleClockwise(B,z)&&!cr$$module$str$c3runtime.angleClockwise(B,H):!(!cr$$module$str$c3runtime.angleClockwise(B,z)&&cr$$module$str$c3runtime.angleClockwise(B,H))},E.SetAngle=function(z){z=cr$$module$str$c3runtime.to_radians(cr$$module$str$c3runtime.clamp_angle_degrees(z));isNaN(z)||this.angle===z||(this.angle=z,this.set_bbox_changed())},
E.RotateClockwise=function(z){0===z||isNaN(z)||(this.angle+=cr$$module$str$c3runtime.to_radians(z),this.angle=cr$$module$str$c3runtime.clamp_angle(this.angle),this.set_bbox_changed())},E.RotateCounterclockwise=function(z){0===z||isNaN(z)||(this.angle-=cr$$module$str$c3runtime.to_radians(z),this.angle=cr$$module$str$c3runtime.clamp_angle(this.angle),this.set_bbox_changed())},E.RotateTowardAngle=function(z,H){z=cr$$module$str$c3runtime.angleRotate(this.angle,cr$$module$str$c3runtime.to_radians(H),cr$$module$str$c3runtime.to_radians(z));
isNaN(z)||this.angle===z||(this.angle=z,this.set_bbox_changed())},E.RotateTowardPosition=function(z,H,B){z=cr$$module$str$c3runtime.angleRotate(this.angle,Math.atan2(B-this.y,H-this.x),cr$$module$str$c3runtime.to_radians(z));isNaN(z)||this.angle===z||(this.angle=z,this.set_bbox_changed())},E.SetTowardPosition=function(z,H){z=Math.atan2(H-this.y,z-this.x);isNaN(z)||this.angle===z||(this.angle=z,this.set_bbox_changed())},v.Angle=function(z){z.set_float(cr$$module$str$c3runtime.to_clamped_degrees(this.angle))});
A||(t.CompareInstanceVar=function(z,H,B){return cr$$module$str$c3runtime.do_cmp(this.instance_vars[z],H,B)},t.IsBoolInstanceVarSet=function(z){return this.instance_vars[z]},t.PickInstVarHiLow=function(z,H){var B=this.getCurrentSol(),g=B.getObjects();if(!g.length)return!1;var r=g[0],x=r,N=r.instance_vars[H],Q;var F=1;for(Q=g.length;F<Q;F++){r=g[F];var d=r.instance_vars[H];if(0===z&&d<N||1===z&&d>N)N=d,x=r}B.pick_one(x);return!0},t.PickByUID=function(z){var H;if(this.runtime.getCurrentCondition().inverted){var B=
this.getCurrentSol();if(B.select_all){B.select_all=!1;cr$$module$str$c3runtime.clearArray(B.instances);cr$$module$str$c3runtime.clearArray(B.else_instances);var g=this.instances;var r=0;for(H=g.length;r<H;r++){var x=g[r];x.uid===z?B.else_instances.push(x):B.instances.push(x)}}else{g=r=0;for(H=B.instances.length;r<H;r++)x=B.instances[r],B.instances[g]=x,x.uid===z?B.else_instances.push(x):g++;cr$$module$str$c3runtime.truncateArray(B.instances,g)}this.applySolToContainer();return!!B.instances.length}x=
this.runtime.getObjectByUID(z);if(!x)return!1;B=this.getCurrentSol();if(!B.select_all&&-1===B.instances.indexOf(x))return!1;if(this.is_family)for(z=x.type.families,r=0,H=z.length;r<H;r++){if(z[r]===this)return B.pick_one(x),this.applySolToContainer(),!0}else if(x.type===this)return B.pick_one(x),this.applySolToContainer(),!0;return!1},t.OnCreated=function(){return!0},t.OnDestroyed=function(){return!0},E.SetInstanceVar=function(z,H){var B=this.instance_vars;cr$$module$str$c3runtime.is_number(B[z])?
cr$$module$str$c3runtime.is_number(H)?B[z]=H:B[z]=parseFloat(H):cr$$module$str$c3runtime.is_string(B[z])&&(cr$$module$str$c3runtime.is_string(H)?B[z]=H:B[z]=H.toString())},E.AddInstanceVar=function(z,H){var B=this.instance_vars;cr$$module$str$c3runtime.is_number(B[z])?cr$$module$str$c3runtime.is_number(H)?B[z]+=H:B[z]+=parseFloat(H):cr$$module$str$c3runtime.is_string(B[z])&&(cr$$module$str$c3runtime.is_string(H)?B[z]+=H:B[z]+=H.toString())},E.SubInstanceVar=function(z,H){var B=this.instance_vars;
cr$$module$str$c3runtime.is_number(B[z])&&(cr$$module$str$c3runtime.is_number(H)?B[z]-=H:B[z]-=parseFloat(H))},E.SetBoolInstanceVar=function(z,H){this.instance_vars[z]=H?1:0},E.ToggleBoolInstanceVar=function(z){this.instance_vars[z]=1-this.instance_vars[z]},E.Destroy=function(){this.runtime.DestroyInstance(this)},E.LoadFromJsonString||(E.LoadFromJsonString=function(z){try{var H=JSON.parse(z)}catch(g){return}this.runtime.loadInstanceFromJSON(this,H,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(z=
0,H=this.behavior_insts.length;z<H;++z){var B=this.behavior_insts[z];B.afterLoad&&B.afterLoad()}}),v.Count=function(z){var H=z.object_class.instances.length,B;var g=0;for(B=this.runtime.createRow.length;g<B;g++){var r=this.runtime.createRow[g];z.object_class.is_family?0<=r.type.families.indexOf(z.object_class)&&H++:r.type===z.object_class&&H++}z.set_int(H)},v.PickedCount=function(z){z.set_int(z.object_class.getCurrentSol().getObjects().length)},v.UID=function(z){z.set_int(this.uid)},v.IID=function(z){z.set_int(this.get_iid())},
v.AsJSON||(v.AsJSON=function(z){z.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));a&&(t.IsVisible=function(){return this.visible},E.SetVisible=function(z){z=2===z?!this.visible:0!==z;z!==this.visible&&(this.visible=z,this.runtime.redraw=!0)},t.CompareOpacity=function(z,H){return cr$$module$str$c3runtime.do_cmp(cr$$module$str$c3runtime.round6dp(100*this.opacity),z,H)},E.SetOpacity=function(z){z/=100;0>z?z=0:1<z&&(z=1);z!==this.opacity&&(this.opacity=z,this.runtime.redraw=!0)},
v.Opacity=function(z){z.set_float(cr$$module$str$c3runtime.round6dp(100*this.opacity))});c&&(t.IsOnLayer=function(z){return z?this.layer===z:!1},t.PickTopBottom=function(z){var H=this.getCurrentSol(),B=H.getObjects();if(!B.length)return!1;var g=B[0],r=g,x;var N=1;for(x=B.length;N<x;N++)if(g=B[N],0===z){if(g.layer.index>r.layer.index||g.layer.index===r.layer.index&&g.get_zindex()>r.get_zindex())r=g}else if(g.layer.index<r.layer.index||g.layer.index===r.layer.index&&g.get_zindex()<r.get_zindex())r=
g;H.pick_one(r);return!0},E.MoveToTop=function(){var z=this.layer,H=z.instances;H.length&&H[H.length-1]===this||(z.removeFromInstanceList(this,!1),z.appendToInstanceList(this,!1),this.runtime.redraw=!0)},E.MoveToBottom=function(){var z=this.layer,H=z.instances;H.length&&H[0]===this||(z.removeFromInstanceList(this,!1),z.prependToInstanceList(this,!1),this.runtime.redraw=!0)},E.MoveToLayer=function(z){z&&z!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=z,z.appendToInstanceList(this,
!0),this.runtime.redraw=!0)},E.ZMoveToObject=function(z,H){z=0===z;H&&(H=H.getFirstPicked(this))&&H.uid!==this.uid&&(this.layer.index!==H.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=H.layer,H.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,H,z),this.runtime.redraw=!0)},v.LayerNumber=function(z){z.set_int(this.layer.number)},v.LayerName=function(z){z.set_string(this.layer.name)},v.ZIndex=function(z){z.set_int(this.get_zindex())});h&&(E.SetEffectEnabled=
function(z,H){this.runtime.glwrap&&(H=this.type.getEffectIndexByName(H),0>H||(z=1===z,this.active_effect_flags[H]!==z&&(this.active_effect_flags[H]=z,this.updateActiveEffects(),this.runtime.redraw=!0)))},E.SetEffectParam=function(z,H,B){if(this.runtime.glwrap){var g=this.type.getEffectIndexByName(z);if(!(0>g||(z=this.type.effect_types[g],g=this.effect_params[g],H=Math.floor(H),0>H||H>=g.length))){var r=this.runtime.glwrap.getProgramParameterType(z.shaderindex,H);1===r&&(B/=100);if(2===r){r=cr$$module$str$c3runtime.GetRValue(B);
var x=cr$$module$str$c3runtime.GetGValue(B);B=cr$$module$str$c3runtime.GetBValue(B);H=g[H];if(H[0]===r&&H[1]===x&&H[2]===B)return;H[0]=r;H[1]=x;H[2]=B}else{if(g[H]===B)return;g[H]=B}z.active&&(this.runtime.redraw=!0)}}});p&&(E.SetVisible=function(z){this.visible=0!==z},E.SetCSSStyle=function(z,H){this.elem.style[cr$$module$str$c3runtime.cssToCamelCase(z)]=H});m&&(E.SetFocus=function(){(this.inputElem||this.elem).focus()},E.SetBlur=function(){(this.inputElem||this.elem).blur()});l&&(E.SetEnabled=function(z){(this.inputElem||
this.elem).disabled=0===z})};cr$$module$str$c3runtime.set_bbox_changed=function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=!0;this.runtime.redraw=!0;var l,v=this.bbox_changed_callbacks;var A=0;for(l=v.length;A<l;++A)v[A](this);this.layer.useRenderCells&&this.update_bbox()};cr$$module$str$c3runtime.add_bbox_changed_callback=function(l){l&&this.bbox_changed_callbacks.push(l)};cr$$module$str$c3runtime.update_bbox=function(){if(this.bbox_changed){var l=this.bbox,v=this.bquad;
l.set(this.x,this.y,this.x+this.width,this.y+this.height);l.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);this.angle?(l.offset(-this.x,-this.y),v.set_from_rotated_rect(l,this.angle),v.offset(this.x,this.y),v.bounding_box(l)):v.set_from_rect(l);l.normalize();this.bbox_changed=!1;this.update_render_cell()}};var b=new cr$$module$str$c3runtime.rect(0,0,0,0);cr$$module$str$c3runtime.update_render_cell=function(){if(this.layer.useRenderCells){var l=this.layer.render_grid,v=this.bbox;b.set(l.XToCell(v.left),
l.YToCell(v.top),l.XToCell(v.right),l.YToCell(v.bottom));this.rendercells.equals(b)||(this.rendercells.right<this.rendercells.left?l.update(this,null,b):l.update(this,this.rendercells,b),this.rendercells.copy(b),this.layer.render_list_stale=!0)}};cr$$module$str$c3runtime.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var l=this.type.collision_grid,v=this.bbox;b.set(l.XToCell(v.left),l.YToCell(v.top),l.XToCell(v.right),l.YToCell(v.bottom));this.collcells.equals(b)||
(this.collcells.right<this.collcells.left?l.update(this,null,b):l.update(this,this.collcells,b),this.collcells.copy(b),this.cell_changed=!1)}};cr$$module$str$c3runtime.inst_contains_pt=function(l,v){return this.bbox.contains_pt(l,v)&&this.bquad.contains_pt(l,v)?this.tilemap_exists?this.testPointOverlapTile(l,v):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(l-this.x,v-this.y)):!0:!1};cr$$module$str$c3runtime.inst_get_iid=
function(){this.type.updateIIDs();return this.iid};cr$$module$str$c3runtime.inst_get_zindex=function(){this.layer.updateZIndices();return this.zindex};cr$$module$str$c3runtime.inst_updateActiveEffects=function(){cr$$module$str$c3runtime.clearArray(this.active_effect_types);var l,v=!0;var A=0;for(l=this.active_effect_flags.length;A<l;A++)if(this.active_effect_flags[A]){var L=this.type.effect_types[A];this.active_effect_types.push(L);L.preservesOpaqueness||(v=!1)}this.uses_shaders=!!this.active_effect_types.length;
this.shaders_preserve_opaqueness=v};cr$$module$str$c3runtime.inst_toString=function(){return"Inst"+this.puid};cr$$module$str$c3runtime.type_getFirstPicked=function(l){if(l&&l.is_contained&&l.type!=this){var v;var A=0;for(v=l.siblings.length;A<v;A++){var L=l.siblings[A];if(L.type==this)return L}}l=this.getCurrentSol().getObjects();return l.length?l[0]:null};cr$$module$str$c3runtime.type_getPairedInstance=function(l){var v=this.getCurrentSol().getObjects();return v.length?v[l.get_iid()%v.length]:null};
cr$$module$str$c3runtime.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var l;var v=0;for(l=this.instances.length;v<l;v++)this.instances[v].iid=v;var A=v,L=this.runtime.createRow;v=0;for(l=L.length;v<l;++v)L[v].type===this&&(L[v].iid=A++);this.stale_iids=!1}};cr$$module$str$c3runtime.type_getInstanceByIID=function(l){if(l<this.instances.length)return this.instances[l];l-=this.instances.length;var v=this.runtime.createRow,A;var L=0;for(A=v.length;L<A;++L)if(v[L].type===this){if(0===
l)return v[L];--l}return null};cr$$module$str$c3runtime.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr$$module$str$c3runtime.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr$$module$str$c3runtime.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr$$module$str$c3runtime.clearArray(this.solstack[this.cur_sol].else_instances))};cr$$module$str$c3runtime.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&
this.solstack.push(new cr$$module$str$c3runtime.selection(this));var l=this.solstack[this.cur_sol],v=this.solstack[this.cur_sol-1];v.select_all?l.select_all=!0:(l.select_all=!1,cr$$module$str$c3runtime.shallowAssignArray(l.instances,v.instances));cr$$module$str$c3runtime.clearArray(l.else_instances)};cr$$module$str$c3runtime.type_popSol=function(){this.cur_sol--};cr$$module$str$c3runtime.type_getBehaviorByName=function(l){var v,A,L=0;if(!this.is_family){var K=0;for(v=this.families.length;K<v;K++){var n=
this.families[K];var a=0;for(A=n.behaviors.length;a<A;a++){if(l===n.behaviors[a].name)return this.extra.lastBehIndex=L,n.behaviors[a];L++}}}K=0;for(v=this.behaviors.length;K<v;K++){if(l===this.behaviors[K].name)return this.extra.lastBehIndex=L,this.behaviors[K];L++}return null};cr$$module$str$c3runtime.type_getBehaviorIndexByName=function(l){return this.getBehaviorByName(l)?this.extra.lastBehIndex:-1};cr$$module$str$c3runtime.type_getEffectIndexByName=function(l){var v;var A=0;for(v=this.effect_types.length;A<
v;A++)if(this.effect_types[A].name===l)return A;return-1};cr$$module$str$c3runtime.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var l,v,A;this.updateIIDs();var L=this.getCurrentSol();var K=L.select_all,n=(l=this.runtime.getCurrentEventStack())&&l.current_event&&l.current_event.orblock;l=0;for(v=this.container.length;l<v;l++){var a=this.container[l];if(a!==this){a.updateIIDs();var c=a.getCurrentSol();c.select_all=K;if(!K){cr$$module$str$c3runtime.clearArray(c.instances);
var h=0;for(A=L.instances.length;h<A;++h)c.instances[h]=a.getInstanceByIID(L.instances[h].iid);if(n)for(cr$$module$str$c3runtime.clearArray(c.else_instances),h=0,A=L.else_instances.length;h<A;++h)c.else_instances[h]=a.getInstanceByIID(L.else_instances[h].iid)}}}}};cr$$module$str$c3runtime.type_toString=function(){return"Type"+this.sid};cr$$module$str$c3runtime.do_cmp=function(l,v,A){if("undefined"===typeof l||"undefined"===typeof A)return!1;switch(v){case 0:return l===A;case 1:return l!==A;case 2:return l<
A;case 3:return l<=A;case 4:return l>A;case 5:return l>=A;default:return!1}}})();cr$$module$str$c3runtime.shaders={};cr$$module$str$c3runtime.plugins_.Text=function(b){this.runtime=b};
(function(){function b(){return p.length?p.pop():{}}function l(m){var t;var E=0;for(t=m.length;E<t;E++)p.push(m[E]);cr$$module$str$c3runtime.clearArray(m)}function v(m){return m.length&&" "===m.charAt(m.length-1)?m.substring(0,m.length-1):m}function A(){}function L(){}function K(){}var n=cr$$module$str$c3runtime.plugins_.Text.prototype;n.onCreate=function(){n.acts.SetWidth=function(m){this.width!==m&&(this.width=m,this.text_changed=!0,this.set_bbox_changed())}};n.Type=function(m){this.plugin=m;this.runtime=
m.runtime};var a=n.Type.prototype;a.onCreate=function(){};a.onLostWebGLContext=function(){if(!this.is_family){var m;var t=0;for(m=this.instances.length;t<m;t++){var E=this.instances[t];E.mycanvas=null;E.myctx=null;E.mytex=null}}};n.Instance=function(m){this.type=m;this.runtime=m.runtime;this.recycled?cr$$module$str$c3runtime.clearArray(this.lines):this.lines=[];this.text_changed=!0};a=n.Instance.prototype;var c={};a.onCreate=function(){this.text=this.properties[0];this.facename=this.properties[2];
this.ptSize=this.properties[3];this.line_height_offset=this.properties[4];this.isBold=this.properties[5];this.isItalic=this.properties[6];var m=this.properties[7];this.color="rgb("+Math.floor(255*m[0])+","+Math.floor(255*m[1])+","+Math.floor(255*m[2])+")";this.halign=this.properties[8];this.valign=this.properties[9];this.wrapbyword=0===this.properties[10];this.visible=this.properties[11];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.fontstyle=this.font="";this.textHeight=
this.textWidth=this.pxHeight=0;this.updateFont();this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr$$module$str$c3runtime.rect(0,0,1,1);this.runtime.glwrap&&this.runtime.tickMe(this)};a.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,
tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};a.loadFromJSON=function(m){this.text=m.t;this.font=m.f;this.color=m.c;this.halign=m.ha;this.valign=m.va;this.wrapbyword=m.wr;this.line_height_offset=m.lho;this.facename=m.fn;this.fontstyle=m.fs;this.ptSize=m.ps;this.pxHeight=m.pxh;this.textWidth=m.tw;this.textHeight=m.th;this.last_render_tick=m.lrt;this.isBold=0!==this.fontstyle.indexOf("bold");this.isItalic=0!==this.fontstyle.indexOf("italic");this.text_changed=!0;this.lastwrapwidth=
this.lastwidth=this.width;this.lastheight=this.height};a.tick=function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var m=this.layer;this.update_bbox();var t=this.bbox;if(t.right<m.viewLeft||t.bottom<m.viewTop||t.left>m.viewRight||t.top>m.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};a.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);
this.mytex=null};a.updateFont=function(){this.pxHeight=Math.ceil(this.ptSize/72*96)+4;var m=[];this.isBold&&m.push("bold");this.isItalic&&m.push("italic");this.fontstyle=m.join(" ");this.font=this.fontstyle+" "+this.ptSize.toString()+"pt '"+this.facename+"'";this.text_changed=!0;this.runtime.redraw=!0};a.draw=function(m,t){m.font=this.font;m.textBaseline="top";m.fillStyle=this.color;m.globalAlpha=t?1:this.opacity;if(t){var E=this.layer.getScale();m.save();m.scale(E,E)}if(this.text_changed||this.width!==
this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,m,this.width,this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();E=t?0:this.bquad.tlx;var z=t?0:this.bquad.tly;this.runtime.pixel_rounding&&(E=E+.5|0,z=z+.5|0);0===this.angle||t||(m.save(),m.translate(E,z),m.rotate(this.angle),z=E=0);var H=z+this.height,B=this.pxHeight;B+=this.line_height_offset;var g;1===this.valign?z+=Math.max(this.height/2-this.lines.length*B/2,0):2===this.valign&&(z+=Math.max(this.height-
this.lines.length*B-2,0));for(g=0;g<this.lines.length;g++){var r=E;1===this.halign?r=E+(this.width-this.lines[g].width)/2:2===this.halign&&(r=E+(this.width-this.lines[g].width));m.fillText(this.lines[g].text,r,z);z+=B;if(z>=H-B)break}(0!==this.angle||t)&&m.restore();this.last_render_tick=this.runtime.tickcount};a.drawGL=function(m){if(!(1>this.width||1>this.height)){var t=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var E=this.layer.getScale(),z=this.layer.getAngle(),H=this.rcTex,
B=E*this.width,g=E*this.height,r=Math.ceil(B),x=Math.ceil(g),N=this.runtime.draw_width/2,Q=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=r,this.mycanvas.height=x,this.lastwidth=r,this.lastheight=x,t=!0,this.myctx=this.mycanvas.getContext("2d"));if(r!==this.lastwidth||x!==this.lastheight)this.mycanvas.width=r,this.mycanvas.height=x,this.mytex&&(m.deleteTexture(this.mytex),this.mytex=null),t=!0;t&&(this.myctx.clearRect(0,0,r,x),this.draw(this.myctx,
!0),this.mytex||(this.mytex=m.createEmptyTexture(r,x,this.runtime.linearSampling,this.runtime.isMobile)),m.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile));this.lastwidth=r;this.lastheight=x;m.setTexture(this.mytex);m.setOpacity(this.opacity);m.resetModelView();m.translate(-N,-Q);m.updateModelView();var F=this.bquad;t=this.layer.layerToCanvas(F.tlx,F.tly,!0,!0);N=this.layer.layerToCanvas(F.tlx,F.tly,!1,!0);Q=this.layer.layerToCanvas(F.trx,F.try_,!0,!0);var d=this.layer.layerToCanvas(F.trx,
F.try_,!1,!0),k=this.layer.layerToCanvas(F.brx,F.bry,!0,!0),C=this.layer.layerToCanvas(F.brx,F.bry,!1,!0),e=this.layer.layerToCanvas(F.blx,F.bly,!0,!0);F=this.layer.layerToCanvas(F.blx,F.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===z){var u=(t+.5|0)-t,G=(N+.5|0)-N;t+=u;N+=G;Q+=u;d+=G;k+=u;C+=G;e+=u;F+=G}0===this.angle&&0===z?(Q=t+r,d=N,k=Q,C=N+x,e=t,F=C,H.right=1,H.bottom=1):(H.right=B/r,H.bottom=g/x);m.quadTex(t,N,Q,d,k,C,e,F,H);m.resetModelView();m.scale(E,E);m.rotateZ(-this.layer.getAngle());
m.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);m.updateModelView();this.last_render_tick=this.runtime.tickcount}};var h=[];n.TokeniseWords=function(m){cr$$module$str$c3runtime.clearArray(h);for(var t="",E,z=0;z<m.length;)if(E=m.charAt(z),"\n"===E)t.length&&(h.push(t),t=""),h.push("\n"),++z;else if(" "===E||"\t"===E||"-"===E){do t+=m.charAt(z),z++;while(z<m.length&&(" "===m.charAt(z)||"\t"===m.charAt(z)));h.push(t);t=""}else z<m.length&&(t+=
E,z++);t.length&&h.push(t)};var p=[];n.WordWrap=function(m,t,E,z,H){if(m&&m.length)if(2>=z)l(t);else{if(100>=m.length&&-1===m.indexOf("\n")){var B=E.measureText(m).width;if(B<=z){l(t);t.push(b());t[0].text=m;t[0].width=B;return}}this.WrapText(m,t,E,z,H)}else l(t)};n.WrapText=function(m,t,E,z,H){H&&(this.TokeniseWords(m),m=h);var B="",g,r=0;for(g=0;g<m.length;g++)if("\n"===m[g]){r>=t.length&&t.push(b());B=v(B);var x=t[r];x.text=B;x.width=E.measureText(B).width;r++;B=""}else{var N=B;B+=m[g];x=E.measureText(v(B)).width;
x>=z&&(r>=t.length&&t.push(b()),N=v(N),x=t[r],x.text=N,x.width=E.measureText(N).width,r++,B=m[g],H||" "!==B||(B=""))}B.length&&(r>=t.length&&t.push(b()),B=v(B),x=t[r],x.text=B,x.width=E.measureText(B).width,r++);for(g=r;g<t.length;g++)p.push(t[g]);t.length=r};A.prototype.CompareText=function(m,t){return t?this.text==m:cr$$module$str$c3runtime.equals_nocase(this.text,m)};n.cnds=new A;L.prototype.SetText=function(m){cr$$module$str$c3runtime.is_number(m)&&1E9>m&&(m=Math.round(1E10*m)/1E10);m=m.toString();
this.text!==m&&(this.text=m,this.text_changed=!0,this.runtime.redraw=!0)};L.prototype.AppendText=function(m){cr$$module$str$c3runtime.is_number(m)&&(m=Math.round(1E10*m)/1E10);if(m=m.toString())this.text+=m,this.text_changed=!0,this.runtime.redraw=!0};L.prototype.SetFontFace=function(m,t){var E=!1,z=!1;switch(t){case 1:E=!0;break;case 2:z=!0;break;case 3:z=E=!0}if(m!==this.facename||this.isBold!==E||this.isItalic!==z)this.facename=m,this.isBold=E,this.isItalic=z,this.updateFont()};L.prototype.SetFontSize=
function(m){this.ptSize!==m&&(this.ptSize=m,this.updateFont())};L.prototype.SetFontColor=function(m){var t=cr$$module$str$c3runtime.clamp(Math.floor(255*cr$$module$str$c3runtime.GetRValue(m)),0,255),E=cr$$module$str$c3runtime.clamp(Math.floor(255*cr$$module$str$c3runtime.GetGValue(m)),0,255);m=cr$$module$str$c3runtime.clamp(Math.floor(255*cr$$module$str$c3runtime.GetBValue(m)),0,255);t="rgb("+t+","+E+","+m+")";t!==this.color&&(this.color=t,this.need_text_redraw=!0,this.runtime.redraw=!0)};L.prototype.SetWebFont=
function(m,t){var E=this,z=function(){E.runtime.redraw=!0;E.text_changed=!0};if(c.hasOwnProperty(t)){if(m="'"+m+"'",this.facename!==m)for(this.facename=m,this.updateFont(),m=1;10>m;m++)setTimeout(z,100*m),setTimeout(z,1E3*m)}else{var H=document.createElement("link");H.href=t;H.rel="stylesheet";H.type="text/css";H.onload=z;document.getElementsByTagName("head")[0].appendChild(H);c[t]=!0;this.facename="'"+m+"'";this.updateFont();for(m=1;10>m;m++)setTimeout(z,100*m),setTimeout(z,1E3*m)}};L.prototype.SetEffect=
function(m){this.blend_mode=m;this.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(m);cr$$module$str$c3runtime.setGLBlend(this,m,this.runtime.gl);this.runtime.redraw=!0};n.acts=new L;K.prototype.Text=function(m){m.set_string(this.text)};K.prototype.FaceName=function(m){m.set_string(this.facename)};K.prototype.FaceSize=function(m){m.set_int(this.ptSize)};K.prototype.TextWidth=function(m){var t=0,E;var z=0;for(E=this.lines.length;z<E;z++){var H=this.lines[z].width;t<H&&(t=H)}m.set_int(t)};
K.prototype.TextHeight=function(m){m.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};n.exps=new K})();cr$$module$str$c3runtime.plugins_.AJAX=function(b){this.runtime=b};
(function(){function b(){}function l(){}function v(){}var A=!1,L=null,K=null,n="",a=cr$$module$str$c3runtime.plugins_.AJAX.prototype;a.Type=function(m){this.plugin=m;this.runtime=m.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(m){this.type=m;this.runtime=m.runtime;this.curTag=this.lastData="";this.progress=0;this.timeout=-1;if(A=this.runtime.isNWjs)L=require("path"),K=require("fs"),n=L.dirname((window.process||nw.process).execPath)+"\\"};var c=a.Instance.prototype;c.onCreate=
function(){};c.saveToJSON=function(){return{lastData:this.lastData}};c.loadFromJSON=function(m){this.lastData=m.lastData;this.curTag="";this.progress=0};var h={},p="";c.doRequest=function(m,t,E,z){var H=this,B=null,g=function(){H.curTag=m;H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyError,H);H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnError,H)},r=function(){if(A){var Q=n+t;K.existsSync(Q)?K.readFile(Q,{encoding:"utf8"},function(F,d){F?
g():(H.curTag=m,H.lastData=d.replace(/\r\n/g,"\n"),H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyComplete,H),H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnComplete,H))}):g()}else g()},x=function(Q){Q.lengthComputable&&(H.progress=Q.loaded/Q.total,H.curTag=m,H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnProgress,H))};try{B=this.runtime.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;B.onreadystatechange=
function(){4===B.readyState&&(H.curTag=m,H.lastData=B.responseText?B.responseText.replace(/\r\n/g,"\n"):"",400<=B.status?(H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyError,H),H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnError,H)):A&&!H.lastData.length||!A&&0===B.status&&!H.lastData.length||(H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyComplete,H),H.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnComplete,
H)))};this.runtime.isWindowsPhone8||(B.onerror=r,B.ontimeout=r,B.onabort=r,B.onprogress=x);B.open(E,t);!this.runtime.isWindowsPhone8&&0<=this.timeout&&"undefined"!==typeof B.timeout&&(B.timeout=this.timeout);B.responseType="text";z&&B.setRequestHeader&&!h.hasOwnProperty("Content-Type")&&B.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(B.setRequestHeader){for(var N in h)if(h.hasOwnProperty(N))try{B.setRequestHeader(N,h[N])}catch(Q){}h={}}if(p&&B.overrideMimeType){try{B.overrideMimeType(p)}catch(Q){}p=
""}z?B.send(z):B.send()}catch(Q){r()}};b.prototype.OnComplete=function(m){return cr$$module$str$c3runtime.equals_nocase(m,this.curTag)};b.prototype.OnAnyComplete=function(m){return!0};b.prototype.OnError=function(m){return cr$$module$str$c3runtime.equals_nocase(m,this.curTag)};b.prototype.OnAnyError=function(m){return!0};b.prototype.OnProgress=function(m){return cr$$module$str$c3runtime.equals_nocase(m,this.curTag)};a.cnds=new b;l.prototype.Request=function(m,t){var E=this;this.runtime.isWKWebView&&
!this.runtime.isAbsoluteUrl(t)?this.runtime.fetchLocalFileViaCordovaAsText(t,function(z){E.curTag=m;E.lastData=z.replace(/\r\n/g,"\n");E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyComplete,E);E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnComplete,E)},function(z){E.curTag=m;E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyError,E);E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnError,E)}):
this.runtime.isPreview&&!this.runtime.isAbsoluteUrl(t)?this.doRequest(m,this.runtime.getLocalFileUrl(t),"GET"):this.doRequest(m,t,"GET")};l.prototype.RequestFile=function(m,t){var E=this;this.runtime.isWKWebView?this.runtime.fetchLocalFileViaCordovaAsText(t,function(z){E.curTag=m;E.lastData=z.replace(/\r\n/g,"\n");E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyComplete,E);E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnComplete,E)},function(z){E.curTag=
m;E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnAnyError,E);E.runtime.trigger(cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnError,E)}):this.doRequest(m,this.runtime.getLocalFileUrl(t),"GET")};l.prototype.Post=function(m,t,E,z){this.doRequest(m,t,z,E)};l.prototype.SetTimeout=function(m){this.timeout=1E3*m};l.prototype.SetHeader=function(m,t){h[m]=t};l.prototype.OverrideMIMEType=function(m){p=m};a.acts=new l;v.prototype.LastData=function(m){m.set_string(this.lastData)};
v.prototype.Progress=function(m){m.set_float(this.progress)};v.prototype.Tag=function(m){m.set_string(this.curTag)};a.exps=new v})();cr$$module$str$c3runtime.plugins_.Arr=function(b){this.runtime=b};
(function(){function b(){return c.length?c.pop():[]}function l(h){var p;var m=0;for(p=h.length;m<p;m++)Array.isArray(h[m])&&l(h[m]);cr$$module$str$c3runtime.clearArray(h);c.push(h)}function v(){}function A(){}function L(h,p){if(cr$$module$str$c3runtime.is_number(h)&&cr$$module$str$c3runtime.is_number(p))return h-p;h=""+h;p=""+p;return h<p?-1:h>p?1:0}function K(){}var n=cr$$module$str$c3runtime.plugins_.Arr.prototype;n.Type=function(h){this.plugin=h;this.runtime=h.runtime};n.Type.prototype.onCreate=
function(){};n.Instance=function(h){this.type=h;this.runtime=h.runtime};var a=n.Instance.prototype,c=[];Array.isArray||(Array.isArray=function(h){return"[object Array]"===Object.prototype.toString.call(h)});a.onCreate=function(){this.cx=this.properties[0];this.cy=this.properties[1];this.cz=this.properties[2];this.recycled||(this.arr=b());var h=this.arr;h.length=this.cx;var p,m,t;for(p=0;p<this.cx;p++)for(h[p]||(h[p]=b()),h[p].length=this.cy,m=0;m<this.cy;m++)for(h[p][m]||(h[p][m]=b()),h[p][m].length=
this.cz,t=0;t<this.cz;t++)h[p][m][t]=0;this.forX=[];this.forY=[];this.forZ=[];this.forDepth=-1};a.onDestroy=function(){var h;for(h=0;h<this.cx;h++)l(this.arr[h]);cr$$module$str$c3runtime.clearArray(this.arr)};a.at=function(h,p,m){h=Math.floor(h);p=Math.floor(p);m=Math.floor(m);return isNaN(h)||0>h||h>this.cx-1||isNaN(p)||0>p||p>this.cy-1||isNaN(m)||0>m||m>this.cz-1?0:this.arr[h][p][m]};a.set=function(h,p,m,t){h=Math.floor(h);p=Math.floor(p);m=Math.floor(m);isNaN(h)||0>h||h>this.cx-1||isNaN(p)||0>
p||p>this.cy-1||isNaN(m)||0>m||m>this.cz-1||(this.arr[h][p][m]=t)};a.getAsJSON=function(){return JSON.stringify({c2array:!0,size:[this.cx,this.cy,this.cz],data:this.arr})};a.saveToJSON=function(){return{size:[this.cx,this.cy,this.cz],data:this.arr}};a.loadFromJSON=function(h){var p=h.size;this.cx=p[0];this.cy=p[1];this.cz=p[2];this.arr=h.data};a.setSize=function(h,p,m){0>h&&(h=0);0>p&&(p=0);0>m&&(m=0);if(this.cx!==h||this.cy!==p||this.cz!==m){this.cx=h;this.cy=p;this.cz=m;var t,E,z=this.arr;z.length=
h;for(h=0;h<this.cx;h++)for(cr$$module$str$c3runtime.is_undefined(z[h])&&(z[h]=b()),z[h].length=p,t=0;t<this.cy;t++)for(cr$$module$str$c3runtime.is_undefined(z[h][t])&&(z[h][t]=b()),z[h][t].length=m,E=0;E<this.cz;E++)cr$$module$str$c3runtime.is_undefined(z[h][t][E])&&(z[h][t][E]=0)}};a.getForX=function(){return 0<=this.forDepth&&this.forDepth<this.forX.length?this.forX[this.forDepth]:0};a.getForY=function(){return 0<=this.forDepth&&this.forDepth<this.forY.length?this.forY[this.forDepth]:0};a.getForZ=
function(){return 0<=this.forDepth&&this.forDepth<this.forZ.length?this.forZ[this.forDepth]:0};v.prototype.CompareX=function(h,p,m){return cr$$module$str$c3runtime.do_cmp(this.at(h,0,0),p,m)};v.prototype.CompareXY=function(h,p,m,t){return cr$$module$str$c3runtime.do_cmp(this.at(h,p,0),m,t)};v.prototype.CompareXYZ=function(h,p,m,t,E){return cr$$module$str$c3runtime.do_cmp(this.at(h,p,m),t,E)};a.doForEachTrigger=function(h){this.runtime.pushCopySol(h.solModifiers);h.retrigger();this.runtime.popSol(h.solModifiers)};
v.prototype.ArrForEach=function(h){var p=this.runtime.getCurrentEventStack().current_event;this.forDepth++;var m=this.forDepth;m===this.forX.length?(this.forX.push(0),this.forY.push(0),this.forZ.push(0)):(this.forX[m]=0,this.forY[m]=0,this.forZ[m]=0);switch(h){case 0:for(this.forX[m]=0;this.forX[m]<this.cx;this.forX[m]++)for(this.forY[m]=0;this.forY[m]<this.cy;this.forY[m]++)for(this.forZ[m]=0;this.forZ[m]<this.cz;this.forZ[m]++)this.doForEachTrigger(p);break;case 1:for(this.forX[m]=0;this.forX[m]<
this.cx;this.forX[m]++)for(this.forY[m]=0;this.forY[m]<this.cy;this.forY[m]++)this.doForEachTrigger(p);break;case 2:for(this.forX[m]=0;this.forX[m]<this.cx;this.forX[m]++)this.doForEachTrigger(p)}this.forDepth--;return!1};v.prototype.CompareCurrent=function(h,p){return cr$$module$str$c3runtime.do_cmp(this.at(this.getForX(),this.getForY(),this.getForZ()),h,p)};v.prototype.Contains=function(h){var p,m,t;for(p=0;p<this.cx;p++)for(m=0;m<this.cy;m++)for(t=0;t<this.cz;t++)if(this.arr[p][m][t]===h)return!0;
return!1};v.prototype.IsEmpty=function(){return 0===this.cx||0===this.cy||0===this.cz};v.prototype.CompareSize=function(h,p,m){var t=0;switch(h){case 0:t=this.cx;break;case 1:t=this.cy;break;case 2:t=this.cz}return cr$$module$str$c3runtime.do_cmp(t,p,m)};n.cnds=new v;A.prototype.Clear=function(h){var p,m,t;for(p=0;p<this.cx;p++)for(m=0;m<this.cy;m++)for(t=0;t<this.cz;t++)this.arr[p][m][t]=h};A.prototype.SetSize=function(h,p,m){this.setSize(h,p,m)};A.prototype.SetX=function(h,p){this.set(h,0,0,p)};
A.prototype.SetXY=function(h,p,m){this.set(h,p,0,m)};A.prototype.SetXYZ=function(h,p,m,t){this.set(h,p,m,t)};A.prototype.Push=function(h,p,m){var t=0,E=0,z=this.arr;switch(m){case 0:0===h?(t=z.length,z.push(b())):(t=0,z.unshift(b()));for(z[t].length=this.cy;E<this.cy;E++)for(z[t][E]=b(),z[t][E].length=this.cz,m=0;m<this.cz;m++)z[t][E][m]=p;this.cx++;break;case 1:for(;t<this.cx;t++)for(0===h?(E=z[t].length,z[t].push(b())):(E=0,z[t].unshift(b())),z[t][E].length=this.cz,m=0;m<this.cz;m++)z[t][E][m]=
p;this.cy++;break;case 2:for(;t<this.cx;t++)for(E=0;E<this.cy;E++)0===h?z[t][E].push(p):z[t][E].unshift(p);this.cz++}};A.prototype.Pop=function(h,p){var m=0,t=this.arr;switch(p){case 0:if(0===this.cx)break;0===h?l(t.pop()):l(t.shift());this.cx--;break;case 1:if(0===this.cy)break;for(;m<this.cx;m++)0===h?l(t[m].pop()):l(t[m].shift());this.cy--;break;case 2:if(0!==this.cz){for(;m<this.cx;m++)for(p=0;p<this.cy;p++)0===h?t[m][p].pop():t[m][p].shift();this.cz--}}};A.prototype.Reverse=function(h){var p=
0,m=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(h){case 0:m.reverse();break;case 1:for(;p<this.cx;p++)m[p].reverse();break;case 2:for(;p<this.cx;p++)for(h=0;h<this.cy;h++)m[p][h].reverse()}};A.prototype.Sort=function(h){var p=0,m=0,t=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(h){case 0:t.sort(function(E,z){return L(E[0][0],z[0][0])});break;case 1:for(;p<this.cx;p++)t[p].sort(function(E,z){return L(E[0],z[0])});break;case 2:for(;p<this.cx;p++)for(m=0;m<this.cy;m++)t[p][m].sort(L)}};
A.prototype.Delete=function(h,p){var m=0;h=Math.floor(h);var t=this.arr;if(!(0>h))switch(p){case 0:if(h>=this.cx)break;l(t[h]);t.splice(h,1);this.cx--;break;case 1:if(h>=this.cy)break;for(;m<this.cx;m++)l(t[m][h]),t[m].splice(h,1);this.cy--;break;case 2:if(!(h>=this.cz)){for(;m<this.cx;m++)for(p=0;p<this.cy;p++)t[m][p].splice(h,1);this.cz--}}};A.prototype.Insert=function(h,p,m){var t=0,E=0;p=Math.floor(p);var z=this.arr;if(!(0>p))switch(m){case 0:if(p>this.cx)break;t=p;z.splice(t,0,b());for(z[t].length=
this.cy;E<this.cy;E++)for(z[t][E]=b(),z[t][E].length=this.cz,m=0;m<this.cz;m++)z[t][E][m]=h;this.cx++;break;case 1:if(p>this.cy)break;for(;t<this.cx;t++)for(E=p,z[t].splice(E,0,b()),z[t][E].length=this.cz,m=0;m<this.cz;m++)z[t][E][m]=h;this.cy++;break;case 2:if(!(p>this.cz)){for(;t<this.cx;t++)for(E=0;E<this.cy;E++)z[t][E].splice(p,0,h);this.cz++}}};A.prototype.JSONLoad=function(h){try{var p=JSON.parse(h)}catch(m){return}p.c2array&&(h=p.size,this.cx=h[0],this.cy=h[1],this.cz=h[2],this.arr=p.data)};
A.prototype.JSONDownload=function(h){var p=document.createElement("a");if("undefined"===typeof p.download)h="data:text/html,"+encodeURIComponent("<p><a download='"+h+"' href=\"data:application/json,"+encodeURIComponent(this.getAsJSON())+'">Download link</a></p>'),window.open(h);else{var m=document.getElementsByTagName("body")[0];p.textContent=h;p.href="data:application/json,"+encodeURIComponent(this.getAsJSON());p.download=h;m.appendChild(p);p.click();m.removeChild(p)}};n.acts=new A;K.prototype.At=
function(h,p,m,t){h.set_any(this.at(p,m||0,t||0))};K.prototype.Width=function(h){h.set_int(this.cx)};K.prototype.Height=function(h){h.set_int(this.cy)};K.prototype.Depth=function(h){h.set_int(this.cz)};K.prototype.CurX=function(h){h.set_int(this.getForX())};K.prototype.CurY=function(h){h.set_int(this.getForY())};K.prototype.CurZ=function(h){h.set_int(this.getForZ())};K.prototype.CurValue=function(h){h.set_any(this.at(this.getForX(),this.getForY(),this.getForZ()))};K.prototype.Front=function(h){h.set_any(this.at(0,
0,0))};K.prototype.Back=function(h){h.set_any(this.at(this.cx-1,0,0))};K.prototype.IndexOf=function(h,p){for(var m=0;m<this.cx;m++)if(this.arr[m][0][0]===p){h.set_int(m);return}h.set_int(-1)};K.prototype.LastIndexOf=function(h,p){for(var m=this.cx-1;0<=m;m--)if(this.arr[m][0][0]===p){h.set_int(m);return}h.set_int(-1)};K.prototype.AsJSON=function(h){h.set_string(this.getAsJSON())};n.exps=new K})();cr$$module$str$c3runtime.plugins_.Function=function(b){this.runtime=b};
(function(){function b(){this.name="";this.retVal=0;this.params=[]}function l(){c++;c===a.length&&a.push(new b);return a[c]}function v(){return 0>c?null:a[c]}function A(){}function L(){}function K(){}var n=cr$$module$str$c3runtime.plugins_.Function.prototype;n.Type=function(h){this.plugin=h;this.runtime=h.runtime};n.Type.prototype.onCreate=function(){};n.Instance=function(h){this.type=h;this.runtime=h.runtime};var a=[],c=-1;n.Instance.prototype.onCreate=function(){var h=this;window.c2_callFunction=
function(p,m){var t,E=l();E.name=p.toLowerCase();E.retVal=0;if(m)for(E.params.length=m.length,p=0,t=m.length;p<t;++p){var z=m[p];E.params[p]="number"===typeof z||"string"===typeof z?z:"boolean"===typeof z?z?1:0:0}else cr$$module$str$c3runtime.clearArray(E.params);h.runtime.trigger(cr$$module$str$c3runtime.plugins_.Function.prototype.cnds.OnFunction,h,E.name);c--;return E.retVal}};A.prototype.OnFunction=function(h){var p=v();return p?cr$$module$str$c3runtime.equals_nocase(h,p.name):!1};A.prototype.CompareParam=
function(h,p,m){var t=v();if(!t)return!1;h=cr$$module$str$c3runtime.floor(h);var E=0;0<=h&&h<t.params.length&&(E=t.params[h]);return cr$$module$str$c3runtime.do_cmp(E,p,m)};n.cnds=new A;L.prototype.CallFunction=function(h,p){var m=l();m.name=h.toLowerCase();m.retVal=0;cr$$module$str$c3runtime.shallowAssignArray(m.params,p);this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Function.prototype.cnds.OnFunction,this,m.name);c--};L.prototype.SetReturnValue=function(h){var p=v();p&&(p.retVal=h)};L.prototype.CallExpression=
function(h){};n.acts=new L;K.prototype.ReturnValue=function(h){if(a.length){var p=c+1;p>=a.length&&(p=a.length-1);p=a[p]}else p=null;p?h.set_any(p.retVal):h.set_int(0)};K.prototype.ParamCount=function(h){var p=v();p?h.set_int(p.params.length):h.set_int(0)};K.prototype.Param=function(h,p){p=cr$$module$str$c3runtime.floor(p);var m=v();m?0<=p&&p<m.params.length?h.set_any(m.params[p]):h.set_int(0):h.set_int(0)};K.prototype.Call=function(h,p){var m=l();m.name=p.toLowerCase();m.retVal=0;cr$$module$str$c3runtime.clearArray(m.params);
var t;var E=2;for(t=arguments.length;E<t;E++)m.params.push(arguments[E]);this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Function.prototype.cnds.OnFunction,this,m.name);c--;h.set_any(m.retVal)};n.exps=new K})();cr$$module$str$c3runtime.plugins_.Touch=function(b){this.runtime=b};
(function(){function b(g){h=g.x;p=g.y;m=g.z}function l(g,r,x,N){var Q=t.length?t.pop():new v;Q.init(g,r,x,N);return Q}function v(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function A(g){return g.sourceCapabilities&&g.sourceCapabilities.firesTouchEvents||g.originalEvent&&g.originalEvent.sourceCapabilities&&g.originalEvent.sourceCapabilities.firesTouchEvents}function L(){}function K(){}
function n(){}var a=cr$$module$str$c3runtime.plugins_.Touch.prototype;a.Type=function(g){this.plugin=g;this.runtime=g.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(g){this.type=g;this.runtime=g.runtime;this.touches=[];this.mouseDown=!1};var c=a.Instance.prototype;c.findTouch=function(g){var r;var x=0;for(r=this.touches.length;x<r;x++)if(this.touches[x].id===g)return x;return-1};var h=0,p=0,m=0,t=[];v.prototype.init=function(g,r,x,N){var Q=cr$$module$str$c3runtime.performance_now();
this.starttime=this.lasttime=this.time=Q;this.startx=g;this.starty=r;this.x=g;this.y=r;this.lastx=g;this.lasty=r;this.pressure=this.height=this.width=0;this.id=x;this.startindex=N;this.tooFarForHold=this.triggeredHold=!1};v.prototype.update=function(g,r,x,N,Q,F){this.lasttime=this.time;this.time=g;this.lastx=this.x;this.lasty=this.y;this.x=r;this.y=x;this.width=N;this.height=Q;this.pressure=F;!this.tooFarForHold&&15<=cr$$module$str$c3runtime.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=
!0)};v.prototype.maybeTriggerHold=function(g,r){!this.triggeredHold&&500<=cr$$module$str$c3runtime.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr$$module$str$c3runtime.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,g.trigger_index=this.startindex,g.trigger_id=this.id,g.getTouchIndex=r,g.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnHoldGesture,g),g.curTouchX=this.x,g.curTouchY=this.y,g.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnHoldGestureObject,
g),g.getTouchIndex=0)};var E=-1E3,z=-1E3,H=-1E4;v.prototype.maybeTriggerTap=function(g,r){if(!this.triggeredHold){var x=cr$$module$str$c3runtime.performance_now();333>=x-this.starttime&&!this.tooFarForHold&&15>cr$$module$str$c3runtime.distanceTo(this.startx,this.starty,this.x,this.y)&&(g.trigger_index=this.startindex,g.trigger_id=this.id,g.getTouchIndex=r,666>=x-H&&25>cr$$module$str$c3runtime.distanceTo(E,z,this.x,this.y)?(g.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,
g),g.curTouchX=this.x,g.curTouchY=this.y,g.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,g),z=E=-1E3,H=-1E4):(g.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTapGesture,g),g.curTouchX=this.x,g.curTouchY=this.y,g.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTapGestureObject,g),E=this.x,z=this.y,H=x),g.getTouchIndex=0)}};c.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||
!window.c2isWindows8);this.getTouchIndex=this.trigger_permission=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=this.properties[0];var g=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,r=document,x=this;"undefined"!==typeof PointerEvent?(g.addEventListener("pointerdown",function(k){x.onPointerStart(k)},!1),g.addEventListener("pointermove",
function(k){x.onPointerMove(k)},!1),r.addEventListener("pointerup",function(k){x.onPointerEnd(k,!1)},!1),r.addEventListener("pointercancel",function(k){x.onPointerEnd(k,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(k){k.preventDefault()},!1),document.addEventListener("MSGestureHold",function(k){k.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(k){k.preventDefault()},!1),document.addEventListener("gesturehold",function(k){k.preventDefault()},
!1))):window.navigator.msPointerEnabled?(g.addEventListener("MSPointerDown",function(k){x.onPointerStart(k)},!1),g.addEventListener("MSPointerMove",function(k){x.onPointerMove(k)},!1),r.addEventListener("MSPointerUp",function(k){x.onPointerEnd(k,!1)},!1),r.addEventListener("MSPointerCancel",function(k){x.onPointerEnd(k,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(k){k.preventDefault()},!1),document.addEventListener("MSGestureHold",function(k){k.preventDefault()},
!1))):(g.addEventListener("touchstart",function(k){x.onTouchStart(k)},!1),g.addEventListener("touchmove",function(k){x.onTouchMove(k)},!1),r.addEventListener("touchend",function(k){x.onTouchEnd(k,!1)},!1),r.addEventListener("touchcancel",function(k){x.onTouchEnd(k,!0)},!1));if(this.isWindows8){var N=function(k){k=k.reading;x.acc_x=k.accelerationX;x.acc_y=k.accelerationY;x.acc_z=k.accelerationZ},Q=function(k){k=k.reading;x.orient_alpha=k.yawDegrees;x.orient_beta=k.pitchDegrees;x.orient_gamma=k.rollDegrees},
F=Windows.Devices.Sensors.Accelerometer.getDefault();F&&(F.reportInterval=Math.max(F.minimumReportInterval,16),F.addEventListener("readingchanged",N));var d=Windows.Devices.Sensors.Inclinometer.getDefault();d&&(d.reportInterval=Math.max(d.minimumReportInterval,16),d.addEventListener("readingchanged",Q));document.addEventListener("visibilitychange",function(k){document.hidden||document.msHidden?(F&&F.removeEventListener("readingchanged",N),d&&d.removeEventListener("readingchanged",Q)):(F&&F.addEventListener("readingchanged",
N),d&&d.addEventListener("readingchanged",Q))},!1)}else window.addEventListener("deviceorientation",function(k){x.orient_alpha=k.alpha||0;x.orient_beta=k.beta||0;x.orient_gamma=k.gamma||0},!1),window.addEventListener("devicemotion",function(k){k.accelerationIncludingGravity&&(x.acc_g_x=k.accelerationIncludingGravity.x||0,x.acc_g_y=k.accelerationIncludingGravity.y||0,x.acc_g_z=k.accelerationIncludingGravity.z||0);k.acceleration&&(x.acc_x=k.acceleration.x||0,x.acc_y=k.acceleration.y||0,x.acc_z=k.acceleration.z||
0)},!1);this.useMouseInput&&(document.addEventListener("mousemove",function(k){x.onMouseMove(k)}),document.addEventListener("mousedown",function(k){x.onMouseDown(k)}),document.addEventListener("mouseup",function(k){x.onMouseUp(k)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(b,null,{frequency:40});this.runtime.tick2Me(this)};c.onPointerMove=function(g){if(g.pointerType!==g.MSPOINTER_TYPE_MOUSE&&
"mouse"!==g.pointerType){g.preventDefault&&g.preventDefault();var r=this.findTouch(g.pointerId),x=cr$$module$str$c3runtime.performance_now();0<=r&&(r=this.touches[r],2>x-r.time||r.update(x,g.pageX-this.runtime.canvas.offsetLeft,g.pageY-this.runtime.canvas.offsetTop,g.width||0,g.height||0,g.pressure||0))}};c.onPointerStart=function(g){if(g.pointerType!==g.MSPOINTER_TYPE_MOUSE&&"mouse"!==g.pointerType&&-1===this.findTouch(g.pointerId)){g.preventDefault&&cr$$module$str$c3runtime.isCanvasInputEvent(g)&&
g.preventDefault();var r=g.pageX-this.runtime.canvas.offsetLeft,x=g.pageY-this.runtime.canvas.offsetTop;cr$$module$str$c3runtime.performance_now();this.trigger_index=this.touches.length;this.trigger_id=g.pointerId;this.touches.push(l(r,x,g.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=
r;this.curTouchY=x;this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};c.onPointerEnd=function(g,r){g.pointerType!==g.MSPOINTER_TYPE_MOUSE&&"mouse"!==g.pointerType&&(g.preventDefault&&cr$$module$str$c3runtime.isCanvasInputEvent(g)&&g.preventDefault(),g=this.findTouch(g.pointerId),this.trigger_index=0<=g?this.touches[g].startindex:-1,this.trigger_id=0<=g?this.touches[g].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnNthTouchEnd,
this),this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=g&&(r||this.touches[g].maybeTriggerTap(this,g),100>t.length&&t.push(this.touches[g]),this.touches.splice(g,1)),this.runtime.isInUserInputEvent=!1)};c.onTouchMove=function(g){g.preventDefault&&g.preventDefault();var r=cr$$module$str$c3runtime.performance_now(),x;var N=0;for(x=g.changedTouches.length;N<x;N++){var Q=g.changedTouches[N];var F=this.findTouch(Q.identifier);if(0<=F){var d=this.runtime.canvas.offsetLeft,
k=this.runtime.canvas.offsetTop;F=this.touches[F];2>r-F.time||F.update(r,Q.pageX-d,Q.pageY-k,2*(Q.radiusX||Q.webkitRadiusX||Q.mozRadiusX||Q.msRadiusX||0),2*(Q.radiusY||Q.webkitRadiusY||Q.mozRadiusY||Q.msRadiusY||0),Q.force||Q.webkitForce||Q.mozForce||Q.msForce||0)}}};c.onTouchStart=function(g){g.preventDefault&&cr$$module$str$c3runtime.isCanvasInputEvent(g)&&g.preventDefault();var r=this.runtime.canvas.offsetLeft,x=this.runtime.canvas.offsetTop;cr$$module$str$c3runtime.performance_now();this.runtime.isInUserInputEvent=
!0;var N;var Q=0;for(N=g.changedTouches.length;Q<N;Q++){var F=g.changedTouches[Q];var d=this.findTouch(F.identifier);if(-1===d){d=F.pageX-r;var k=F.pageY-x;this.trigger_index=this.touches.length;this.trigger_id=F.identifier;this.touches.push(l(d,k,F.identifier,this.trigger_index));this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=d;this.curTouchY=
k;this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};c.onTouchEnd=function(g,r){g.preventDefault&&cr$$module$str$c3runtime.isCanvasInputEvent(g)&&g.preventDefault();this.runtime.isInUserInputEvent=!0;var x;var N=0;for(x=g.changedTouches.length;N<x;N++){var Q=g.changedTouches[N];Q=this.findTouch(Q.identifier);0<=Q&&(this.trigger_index=this.touches[Q].startindex,this.trigger_id=this.touches[Q].id,this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnNthTouchEnd,
this),this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchEnd,this),r||this.touches[Q].maybeTriggerTap(this,Q),100>t.length&&t.push(this.touches[Q]),this.touches.splice(Q,1))}this.runtime.isInUserInputEvent=!1};c.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==m?90*m:this.orient_alpha};c.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==p?90*p:this.orient_beta};c.getGamma=function(){return this.runtime.isCordova&&
0===this.orient_gamma&&0!==h?90*h:this.orient_gamma};c.onMouseDown=function(g){A(g)||(this.onTouchStart({changedTouches:[{pageX:g.pageX,pageY:g.pageY,identifier:0}]}),this.mouseDown=!0)};c.onMouseMove=function(g){if(this.mouseDown&&!A(g))this.onTouchMove({changedTouches:[{pageX:g.pageX,pageY:g.pageY,identifier:0}]})};c.onMouseUp=function(g){g.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&g.preventDefault();this.runtime.had_a_click=!0;A(g)||(this.onTouchEnd({changedTouches:[{pageX:g.pageX,
pageY:g.pageY,identifier:0}]}),this.mouseDown=!1)};c.isClientPosOverCanvas=function(g,r){return 0<=g&&0<=r&&g<this.runtime.width&&r<this.runtime.height};c.tick2=function(){var g,r=cr$$module$str$c3runtime.performance_now();var x=0;for(g=this.touches.length;x<g;++x){var N=this.touches[x];N.time<=r-50&&(N.lasttime=r);N.maybeTriggerHold(this,x)}};L.prototype.OnTouchStart=function(){return!0};L.prototype.OnTouchEnd=function(){return!0};L.prototype.IsInTouch=function(){return this.touches.length};L.prototype.OnTouchObject=
function(g){return g&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(g,this.curTouchX,this.curTouchY,!1):!1};var B=[];L.prototype.IsTouchingObject=function(g){if(!g)return!1;var r=g.getCurrentSol(),x=r.getObjects(),N,Q;var F=0;for(N=x.length;F<N;F++){var d=x[F];d.update_bbox();var k=0;for(Q=this.touches.length;k<Q;k++){var C=this.touches[k];if(this.isClientPosOverCanvas(C.x,C.y)){var e=d.layer.canvasToLayer(C.x,C.y,!0);C=d.layer.canvasToLayer(C.x,
C.y,!1);if(d.contains_pt(e,C)){B.push(d);break}}}}return B.length?(r.select_all=!1,cr$$module$str$c3runtime.shallowAssignArray(r.instances,B),g.applySolToContainer(),cr$$module$str$c3runtime.clearArray(B),!0):!1};L.prototype.CompareTouchSpeed=function(g,r,x){g=Math.floor(g);if(0>g||g>=this.touches.length)return!1;var N=this.touches[g];g=cr$$module$str$c3runtime.distanceTo(N.x,N.y,N.lastx,N.lasty);N=(N.time-N.lasttime)/1E3;var Q=0;0<N&&(Q=g/N);return cr$$module$str$c3runtime.do_cmp(Q,r,x)};L.prototype.OrientationSupported=
function(){return"undefined"!==typeof window.DeviceOrientationEvent};L.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};L.prototype.CompareOrientation=function(g,r,x){g=0===g?this.getAlpha():1===g?this.getBeta():this.getGamma();return cr$$module$str$c3runtime.do_cmp(g,r,x)};L.prototype.CompareAcceleration=function(g,r,x){var N=0;0===g?N=this.acc_g_x:1===g?N=this.acc_g_y:2===g?N=this.acc_g_z:3===g?N=this.acc_x:4===g?N=this.acc_y:5===g&&(N=this.acc_z);return cr$$module$str$c3runtime.do_cmp(N,
r,x)};L.prototype.OnNthTouchStart=function(g){g=Math.floor(g);return g===this.trigger_index};L.prototype.OnNthTouchEnd=function(g){g=Math.floor(g);return g===this.trigger_index};L.prototype.HasNthTouch=function(g){g=Math.floor(g);return this.touches.length>=g+1};L.prototype.OnHoldGesture=function(){return!0};L.prototype.OnTapGesture=function(){return!0};L.prototype.OnDoubleTapGesture=function(){return!0};L.prototype.OnHoldGestureObject=function(g){return g&&this.isClientPosOverCanvas(this.curTouchX,
this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(g,this.curTouchX,this.curTouchY,!1):!1};L.prototype.OnTapGestureObject=function(g){return g&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(g,this.curTouchX,this.curTouchY,!1):!1};L.prototype.OnDoubleTapGestureObject=function(g){return g&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(g,this.curTouchX,this.curTouchY,!1):!1};L.prototype.OnPermissionGranted=
function(g){return this.trigger_permission===g};L.prototype.OnPermissionDenied=function(g){return this.trigger_permission===g};a.cnds=new L;K.prototype.RequestPermission=function(g){var r=this,x=Promise.resolve(!0);0===g?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(x=window.DeviceOrientationEvent.requestPermission().then(function(N){return"granted"===N})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(x=window.DeviceMotionEvent.requestPermission().then(function(N){return"granted"===
N}));x.then(function(N){r.trigger_permission=g;N?r.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnPermissionGranted,r):r.runtime.trigger(cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnPermissionDenied,r)})};a.acts=new K;n.prototype.TouchCount=function(g){g.set_int(this.touches.length)};n.prototype.X=function(g,r){var x=this.getTouchIndex;if(0>x||x>=this.touches.length)g.set_float(0);else if(cr$$module$str$c3runtime.is_undefined(r)){r=this.runtime.getLayerByNumber(0);
var N=r.scale;var Q=r.zoomRate;var F=r.parallaxX;var d=r.angle;r.scale=1;r.zoomRate=1;r.parallaxX=1;r.angle=0;g.set_float(r.canvasToLayer(this.touches[x].x,this.touches[x].y,!0));r.scale=N;r.zoomRate=Q;r.parallaxX=F;r.angle=d}else(r=cr$$module$str$c3runtime.is_number(r)?this.runtime.getLayerByNumber(r):this.runtime.getLayerByName(r))?g.set_float(r.canvasToLayer(this.touches[x].x,this.touches[x].y,!0)):g.set_float(0)};n.prototype.XAt=function(g,r,x){r=Math.floor(r);if(0>r||r>=this.touches.length)g.set_float(0);
else if(cr$$module$str$c3runtime.is_undefined(x)){x=this.runtime.getLayerByNumber(0);var N=x.scale;var Q=x.zoomRate;var F=x.parallaxX;var d=x.angle;x.scale=1;x.zoomRate=1;x.parallaxX=1;x.angle=0;g.set_float(x.canvasToLayer(this.touches[r].x,this.touches[r].y,!0));x.scale=N;x.zoomRate=Q;x.parallaxX=F;x.angle=d}else(x=cr$$module$str$c3runtime.is_number(x)?this.runtime.getLayerByNumber(x):this.runtime.getLayerByName(x))?g.set_float(x.canvasToLayer(this.touches[r].x,this.touches[r].y,!0)):g.set_float(0)};
n.prototype.XForID=function(g,r,x){r=this.findTouch(r);if(0>r)g.set_float(0);else if(r=this.touches[r],cr$$module$str$c3runtime.is_undefined(x)){x=this.runtime.getLayerByNumber(0);var N=x.scale;var Q=x.zoomRate;var F=x.parallaxX;var d=x.angle;x.scale=1;x.zoomRate=1;x.parallaxX=1;x.angle=0;g.set_float(x.canvasToLayer(r.x,r.y,!0));x.scale=N;x.zoomRate=Q;x.parallaxX=F;x.angle=d}else(x=cr$$module$str$c3runtime.is_number(x)?this.runtime.getLayerByNumber(x):this.runtime.getLayerByName(x))?g.set_float(x.canvasToLayer(r.x,
r.y,!0)):g.set_float(0)};n.prototype.Y=function(g,r){var x=this.getTouchIndex;if(0>x||x>=this.touches.length)g.set_float(0);else if(cr$$module$str$c3runtime.is_undefined(r)){r=this.runtime.getLayerByNumber(0);var N=r.scale;var Q=r.zoomRate;var F=r.parallaxY;var d=r.angle;r.scale=1;r.zoomRate=1;r.parallaxY=1;r.angle=0;g.set_float(r.canvasToLayer(this.touches[x].x,this.touches[x].y,!1));r.scale=N;r.zoomRate=Q;r.parallaxY=F;r.angle=d}else(r=cr$$module$str$c3runtime.is_number(r)?this.runtime.getLayerByNumber(r):
this.runtime.getLayerByName(r))?g.set_float(r.canvasToLayer(this.touches[x].x,this.touches[x].y,!1)):g.set_float(0)};n.prototype.YAt=function(g,r,x){r=Math.floor(r);if(0>r||r>=this.touches.length)g.set_float(0);else if(cr$$module$str$c3runtime.is_undefined(x)){x=this.runtime.getLayerByNumber(0);var N=x.scale;var Q=x.zoomRate;var F=x.parallaxY;var d=x.angle;x.scale=1;x.zoomRate=1;x.parallaxY=1;x.angle=0;g.set_float(x.canvasToLayer(this.touches[r].x,this.touches[r].y,!1));x.scale=N;x.zoomRate=Q;x.parallaxY=
F;x.angle=d}else(x=cr$$module$str$c3runtime.is_number(x)?this.runtime.getLayerByNumber(x):this.runtime.getLayerByName(x))?g.set_float(x.canvasToLayer(this.touches[r].x,this.touches[r].y,!1)):g.set_float(0)};n.prototype.YForID=function(g,r,x){r=this.findTouch(r);if(0>r)g.set_float(0);else if(r=this.touches[r],cr$$module$str$c3runtime.is_undefined(x)){x=this.runtime.getLayerByNumber(0);var N=x.scale;var Q=x.zoomRate;var F=x.parallaxY;var d=x.angle;x.scale=1;x.zoomRate=1;x.parallaxY=1;x.angle=0;g.set_float(x.canvasToLayer(r.x,
r.y,!1));x.scale=N;x.zoomRate=Q;x.parallaxY=F;x.angle=d}else(x=cr$$module$str$c3runtime.is_number(x)?this.runtime.getLayerByNumber(x):this.runtime.getLayerByName(x))?g.set_float(x.canvasToLayer(r.x,r.y,!1)):g.set_float(0)};n.prototype.AbsoluteX=function(g){this.touches.length?g.set_float(this.touches[0].x):g.set_float(0)};n.prototype.AbsoluteXAt=function(g,r){r=Math.floor(r);0>r||r>=this.touches.length?g.set_float(0):g.set_float(this.touches[r].x)};n.prototype.AbsoluteXForID=function(g,r){r=this.findTouch(r);
0>r?g.set_float(0):g.set_float(this.touches[r].x)};n.prototype.AbsoluteY=function(g){this.touches.length?g.set_float(this.touches[0].y):g.set_float(0)};n.prototype.AbsoluteYAt=function(g,r){r=Math.floor(r);0>r||r>=this.touches.length?g.set_float(0):g.set_float(this.touches[r].y)};n.prototype.AbsoluteYForID=function(g,r){r=this.findTouch(r);0>r?g.set_float(0):g.set_float(this.touches[r].y)};n.prototype.SpeedAt=function(g,r){r=Math.floor(r);if(0>r||r>=this.touches.length)g.set_float(0);else{var x=this.touches[r];
r=cr$$module$str$c3runtime.distanceTo(x.x,x.y,x.lastx,x.lasty);x=(x.time-x.lasttime)/1E3;0>=x?g.set_float(0):g.set_float(r/x)}};n.prototype.SpeedForID=function(g,r){r=this.findTouch(r);if(0>r)g.set_float(0);else{var x=this.touches[r];r=cr$$module$str$c3runtime.distanceTo(x.x,x.y,x.lastx,x.lasty);x=(x.time-x.lasttime)/1E3;0>=x?g.set_float(0):g.set_float(r/x)}};n.prototype.AngleAt=function(g,r){r=Math.floor(r);0>r||r>=this.touches.length?g.set_float(0):(r=this.touches[r],g.set_float(cr$$module$str$c3runtime.to_degrees(cr$$module$str$c3runtime.angleTo(r.lastx,
r.lasty,r.x,r.y))))};n.prototype.AngleForID=function(g,r){r=this.findTouch(r);0>r?g.set_float(0):(r=this.touches[r],g.set_float(cr$$module$str$c3runtime.to_degrees(cr$$module$str$c3runtime.angleTo(r.lastx,r.lasty,r.x,r.y))))};n.prototype.Alpha=function(g){g.set_float(this.getAlpha())};n.prototype.Beta=function(g){g.set_float(this.getBeta())};n.prototype.Gamma=function(g){g.set_float(this.getGamma())};n.prototype.AccelerationXWithG=function(g){g.set_float(this.acc_g_x)};n.prototype.AccelerationYWithG=
function(g){g.set_float(this.acc_g_y)};n.prototype.AccelerationZWithG=function(g){g.set_float(this.acc_g_z)};n.prototype.AccelerationX=function(g){g.set_float(this.acc_x)};n.prototype.AccelerationY=function(g){g.set_float(this.acc_y)};n.prototype.AccelerationZ=function(g){g.set_float(this.acc_z)};n.prototype.TouchIndex=function(g){g.set_int(this.trigger_index)};n.prototype.TouchID=function(g){g.set_float(this.trigger_id)};n.prototype.WidthForID=function(g,r){r=this.findTouch(r);0>r?g.set_float(0):
g.set_float(this.touches[r].width)};n.prototype.HeightForID=function(g,r){r=this.findTouch(r);0>r?g.set_float(0):g.set_float(this.touches[r].height)};n.prototype.PressureForID=function(g,r){r=this.findTouch(r);0>r?g.set_float(0):g.set_float(this.touches[r].pressure)};a.exps=new n})();cr$$module$str$c3runtime.plugins_.WebStorage=function(b){this.runtime=b};
(function(){function b(){}function l(){}function v(){}var A=cr$$module$str$c3runtime.plugins_.WebStorage.prototype;A.Type=function(c){this.plugin=c;this.runtime=c.runtime};A.Type.prototype.onCreate=function(){};A.Instance=function(c){this.type=c;this.runtime=c.runtime};var L=A.Instance.prototype,K="",n="undefined"!==typeof window.is_scirra_arcade;n&&(K="arcade"+window.scirra_arcade_id);var a=!1;try{localStorage.getItem("test"),a=!0}catch(c){a=!1}L.onCreate=function(){a||cr$$module$str$c3runtime.logexport("[Construct 2] Webstorage plugin: local storage is not supported on this platform.")};
b.prototype.LocalStorageEnabled=function(){return a};b.prototype.SessionStorageEnabled=function(){return a};b.prototype.LocalStorageExists=function(c){return a?null!=localStorage.getItem(K+c):!1};b.prototype.SessionStorageExists=function(c){return a?null!=sessionStorage.getItem(K+c):!1};b.prototype.OnQuotaExceeded=function(){return!0};b.prototype.CompareKeyText=function(c,h,p){if(!a)return!1;c=localStorage.getItem(K+c)||"";return p?c==h:cr$$module$str$c3runtime.equals_nocase(c,h)};b.prototype.CompareKeyNumber=
function(c,h,p){if(!a)return!1;c=localStorage.getItem(K+c)||"";return cr$$module$str$c3runtime.do_cmp(parseFloat(c),h,p)};A.cnds=new b;l.prototype.StoreLocal=function(c,h){if(a)try{localStorage.setItem(K+c,h)}catch(p){this.runtime.trigger(cr$$module$str$c3runtime.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded,this)}};l.prototype.StoreSession=function(c,h){if(a)try{sessionStorage.setItem(K+c,h)}catch(p){this.runtime.trigger(cr$$module$str$c3runtime.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded,
this)}};l.prototype.RemoveLocal=function(c){a&&localStorage.removeItem(K+c)};l.prototype.RemoveSession=function(c){a&&sessionStorage.removeItem(K+c)};l.prototype.ClearLocal=function(){a&&(n||localStorage.clear())};l.prototype.ClearSession=function(){a&&(n||sessionStorage.clear())};l.prototype.JSONLoad=function(c,h){if(a){try{var p=JSON.parse(c)}catch(t){return}if(p.c2dictionary){c=p.data;0!==h||n||localStorage.clear();for(var m in c)if(c.hasOwnProperty(m))try{localStorage.setItem(K+m,c[m])}catch(t){this.runtime.trigger(cr$$module$str$c3runtime.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded,
this);break}}}};A.acts=new l;v.prototype.LocalValue=function(c,h){a?c.set_string(localStorage.getItem(K+h)||""):c.set_string("")};v.prototype.SessionValue=function(c,h){a?c.set_string(sessionStorage.getItem(K+h)||""):c.set_string("")};v.prototype.LocalCount=function(c){a?c.set_int(n?0:localStorage.length):c.set_int(0)};v.prototype.SessionCount=function(c){a?c.set_int(n?0:sessionStorage.length):c.set_int(0)};v.prototype.LocalAt=function(c,h){n||!a?c.set_string(""):c.set_string(localStorage.getItem(localStorage.key(h))||
"")};v.prototype.SessionAt=function(c,h){n||!a?c.set_string(""):c.set_string(sessionStorage.getItem(sessionStorage.key(h))||"")};v.prototype.LocalKeyAt=function(c,h){n||!a?c.set_string(""):c.set_string(localStorage.key(h)||"")};v.prototype.SessionKeyAt=function(c,h){n||!a?c.set_string(""):c.set_string(sessionStorage.key(h)||"")};v.prototype.AsJSON=function(c){if(a){var h={},p;var m=0;for(p=localStorage.length;m<p;m++){var t=localStorage.key(m);n?t.substr(0,K.length)===K&&(h[t.substr(K.length)]=localStorage.getItem(t)):
h[t]=localStorage.getItem(t)}c.set_string(JSON.stringify({c2dictionary:!0,data:h}))}else c.set_string("")};A.exps=new v})();cr$$module$str$c3runtime.plugins_.TiledBg=function(b){this.runtime=b};
(function(){function b(){}function l(){}function v(){}var A=cr$$module$str$c3runtime.plugins_.TiledBg.prototype;A.Type=function(K){this.plugin=K;this.runtime=K.runtime};var L=A.Type.prototype;L.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,
this.texture_file)),this.webGL_texture=this.pattern=null)};L.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};L.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat));var K;var n=0;for(K=this.instances.length;n<K;n++)this.instances[n].webGL_texture=this.webGL_texture}};L.loadTextures=function(){this.is_family||
this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};L.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};L.preloadCanvas2D=function(K){K.drawImage(this.texture_img,0,0)};A.Instance=function(K){this.type=K;this.runtime=K.runtime};L=A.Instance.prototype;L.onCreate=function(){this.visible=
this.properties[0];this.rcTex=new cr$$module$str$c3runtime.rect(0,0,0,0);this.has_own_texture=!1;this.texture_img=this.type.texture_img;this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)};L.afterLoad=function(){this.has_own_texture=!1;this.texture_img=this.type.texture_img};L.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&
this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};L.draw=function(K){K.globalAlpha=this.opacity;K.save();K.fillStyle=this.pattern;var n=this.x,a=this.y;this.runtime.pixel_rounding&&(n=Math.round(n),a=Math.round(a));var c=-(this.hotspotX*this.width),h=-(this.hotspotY*this.height),p=c%this.texture_img.width,m=h%this.texture_img.height;0>p&&(p+=this.texture_img.width);0>m&&(m+=this.texture_img.height);K.translate(n,a);K.rotate(this.angle);K.translate(p,
m);K.fillRect(c-p,h-m,this.width,this.height);K.restore()};L.drawGL_earlyZPass=function(K){this.drawGL(K)};L.drawGL=function(K){K.setTexture(this.webGL_texture);K.setOpacity(this.opacity);var n=this.rcTex;n.right=this.width/this.texture_img.width;n.bottom=this.height/this.texture_img.height;var a=this.bquad;if(this.runtime.pixel_rounding){var c=Math.round(this.x)-this.x,h=Math.round(this.y)-this.y;K.quadTex(a.tlx+c,a.tly+h,a.trx+c,a.try_+h,a.brx+c,a.bry+h,a.blx+c,a.bly+h,n)}else K.quadTex(a.tlx,a.tly,
a.trx,a.try_,a.brx,a.bry,a.blx,a.bly,n)};b.prototype.OnURLLoaded=function(){return!0};A.cnds=new b;l.prototype.SetEffect=function(K){this.blend_mode=K;this.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(K);cr$$module$str$c3runtime.setGLBlend(this,K,this.runtime.gl);this.runtime.redraw=!0};l.prototype.LoadURL=function(K,n){var a=new Image,c=this;a.onload=function(){c.texture_img=a;c.runtime.glwrap?(c.has_own_texture&&c.webGL_texture&&c.runtime.glwrap.deleteTexture(c.webGL_texture),c.webGL_texture=
c.runtime.glwrap.loadTexture(a,!0,c.runtime.linearSampling)):c.pattern=c.runtime.ctx.createPattern(a,"repeat");c.has_own_texture=!0;c.runtime.redraw=!0;c.runtime.trigger(cr$$module$str$c3runtime.plugins_.TiledBg.prototype.cnds.OnURLLoaded,c)};"data:"!==K.substr(0,5)&&0===n&&(a.crossOrigin="anonymous");this.runtime.setImageSrc(a,K)};A.acts=new l;v.prototype.ImageWidth=function(K){K.set_float(this.texture_img.width)};v.prototype.ImageHeight=function(K){K.set_float(this.texture_img.height)};A.exps=new v})();
cr$$module$str$c3runtime.plugins_.Sprite=function(b){this.runtime=b};
(function(){function b(){if(0===this.datauri.length){var F=document.createElement("canvas");F.width=this.width;F.height=this.height;var d=F.getContext("2d");this.spritesheeted?d.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):d.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=F.toDataURL("image/png")}return this.datauri}function l(){}function v(F){F[0]=0;F[1]=0;F[2]=0;z.push(F)}function A(F,d){return F<d?""+F+","+d:""+d+","+F}function L(F,
d,k,C){d=d.uid;k=k.uid;var e=A(d,k);if(F.hasOwnProperty(e))F[e][2]=C;else{var u=z.length?z.pop():[0,0,0];u[0]=d;u[1]=k;u[2]=C;F[e]=u}}function K(F,d,k){d=A(d.uid,k.uid);F.hasOwnProperty(d)&&(v(F[d]),delete F[d])}function n(F,d,k){d=A(d.uid,k.uid);if(F.hasOwnProperty(d))return H=F[d][2],!0;H=-2;return!1}function a(F,d,k){if(!F)return!1;var C=0!==d||0!==k,e=!1,u=this.runtime.getCurrentCondition(),G=u.type;u=u.inverted;var I=F.getCurrentSol();var R=this.runtime.getCurrentEventStack().current_event.orblock;
I.select_all?(this.update_bbox(),Q.copy(this.bbox),Q.offset(d,k),this.runtime.getCollisionCandidates(this.layer,F,Q,N),I=N):I=R?this.runtime.isCurrentConditionFirst()&&!I.else_instances.length&&I.instances.length?I.instances:I.else_instances:I.instances;g=F;x=G!==F&&!u;if(C){var S=this.x;var V=this.y;this.x+=d;this.y+=k;this.set_bbox_changed()}d=0;for(k=I.length;d<k;d++)if(R=I[d],this.runtime.testOverlap(this,R)){e=!0;if(u)break;G!==F&&r.add(R)}C&&(this.x=S,this.y=V,this.set_bbox_changed());cr$$module$str$c3runtime.clearArray(N);
return e}function c(){}function h(){}var p=cr$$module$str$c3runtime.plugins_.Sprite.prototype;p.Type=function(F){this.plugin=F;this.runtime=F.runtime};var m=p.Type.prototype;m.onCreate=function(){if(!this.is_family){var F,d;this.all_frames=[];this.has_loaded_textures=!1;var k=0;for(F=this.animations.length;k<F;k++){var C=this.animations[k];var e={};e.name=C[0];e.speed=C[1];e.loop=C[2];e.repeatcount=C[3];e.repeatto=C[4];e.pingpong=C[5];e.sid=C[6];e.frames=[];var u=0;for(d=C[7].length;u<d;u++){var G=
C[7][u];var I={};I.texture_file=G[0];I.texture_filesize=G[1];I.offx=G[2];I.offy=G[3];I.width=G[4];I.height=G[5];I.duration=G[6];I.hotspotX=G[7];I.hotspotY=G[8];I.image_points=G[9];I.poly_pts=G[10];I.pixelformat=G[11];I.spritesheeted=0!==I.width;I.datauri="";I.getDataUri=b;var R={left:0,top:0,right:1,bottom:1};I.sheetTex=R;I.webGL_texture=null;(R=this.runtime.findWaitingTexture(G[0]))?I.texture_img=R:(I.texture_img=new Image,I.texture_img.cr_src=G[0],I.texture_img.cr_filesize=G[1],I.texture_img.c2webGL_texture=
null,this.runtime.waitForImageLoad(I.texture_img,G[0]));cr$$module$str$c3runtime.seal(I);e.frames.push(I);this.all_frames.push(I)}cr$$module$str$c3runtime.seal(e);this.animations[k]=e}}};m.updateAllCurrentTexture=function(){var F;var d=0;for(F=this.instances.length;d<F;d++){var k=this.instances[d];k.curWebGLTexture=k.curFrame.webGL_texture}};m.onLostWebGLContext=function(){if(!this.is_family){var F;var d=0;for(F=this.all_frames.length;d<F;++d){var k=this.all_frames[d];k.texture_img.c2webGL_texture=
null;k.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};m.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){var F;var d=0;for(F=this.all_frames.length;d<F;++d){var k=this.all_frames[d];k.webGL_texture=this.runtime.glwrap.loadTexture(k.texture_img,!1,this.runtime.linearSampling,k.pixelformat)}this.updateAllCurrentTexture()}};m.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var F;var d=0;for(F=this.all_frames.length;d<
F;++d){var k=this.all_frames[d];k.webGL_texture=this.runtime.glwrap.loadTexture(k.texture_img,!1,this.runtime.linearSampling,k.pixelformat)}this.has_loaded_textures=!0}};m.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var F;var d=0;for(F=this.all_frames.length;d<F;++d){var k=this.all_frames[d];this.runtime.glwrap.deleteTexture(k.webGL_texture);k.webGL_texture=null}this.has_loaded_textures=!1}};var t=[];m.preloadCanvas2D=function(F){var d;cr$$module$str$c3runtime.clearArray(t);
var k=0;for(d=this.all_frames.length;k<d;++k){var C=this.all_frames[k].texture_img;-1===t.indexOf(C)&&(F.drawImage(C,0,0),t.push(C))}};p.Instance=function(F){this.type=F;this.runtime=F.runtime;F=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(F):this.collision_poly=new cr$$module$str$c3runtime.CollisionPoly(F)};var E=p.Instance.prototype;E.onCreate=function(){this.visible=this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=this.properties[3];
this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var F=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(F.poly_pts);this.hotspotX=F.hotspotX;this.hotspotY=F.hotspotY;this.animForwards=0<=this.cur_animation.speed;this.cur_anim_speed=Math.abs(this.cur_animation.speed);this.cur_anim_repeatto=
this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||0===this.cur_anim_speed||(this.runtime.tickMe(this),this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr$$module$str$c3runtime.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var d,k;F=0;for(d=this.type.animations.length;F<
d;F++){var C=this.type.animations[F];var e=0;for(k=C.frames.length;e<k;e++){var u=C.frames[e];0===u.width&&(u.width=u.texture_img.width,u.height=u.texture_img.height);if(u.spritesheeted){var G=u.texture_img;var I=u.sheetTex;I.left=u.offx/G.width;I.top=u.offy/G.height;I.right=(u.offx+u.width)/G.width;I.bottom=(u.offy+u.height)/G.height;0===u.offx&&0===u.offy&&u.width===G.width&&u.height===G.height&&(u.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=
this.curFrame.webGL_texture};E.saveToJSON=function(){var F={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum,rt:this.cur_anim_repeatto};this.animPlaying||(F.ap=this.animPlaying);this.animForwards||(F.af=this.animForwards);return F};E.loadFromJSON=function(F){var d=this.getAnimationBySid(F.a);d&&(this.cur_animation=d);this.cur_frame=F.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&
(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=F.cas;this.frameStart=F.fs;this.animRepeats=F.ar;this.animTimer.reset();this.animTimer.sum=F.at;this.animPlaying=F.hasOwnProperty("ap")?F.ap:!0;this.animForwards=F.hasOwnProperty("af")?F.af:!0;F.hasOwnProperty("rt")?this.cur_anim_repeatto=F.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);
this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};E.animationFinish=function(F){this.cur_frame=F?0:this.cur_animation.frames.length-1;this.animPlaying=!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};E.getNowTime=function(){return this.animTimer.sum};
E.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&this.doChangeAnimFrame();var F=this.getNowTime(),d=this.cur_animation,k=d.frames[this.cur_frame],C=k.duration/this.cur_anim_speed;this.animPlaying&&F>=this.frameStart+C&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=C,this.cur_frame>=d.frames.length&&(d.pingpong?(this.animForwards=!1,this.cur_frame=d.frames.length-2):d.loop?this.cur_frame=
this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=d.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame&&(d.pingpong?(this.cur_frame=1,this.animForwards=!0,d.loop||(this.animRepeats++,this.animRepeats>=d.repeatcount&&this.animationFinish(!0))):d.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=d.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=
d.frames.length&&(this.cur_frame=d.frames.length-1),F>this.frameStart+d.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=F),F=d.frames[this.cur_frame],this.OnFrameChanged(k,F),this.runtime.redraw=!0)};E.getAnimationByName=function(F){var d;var k=0;for(d=this.type.animations.length;k<d;k++){var C=this.type.animations[k];if(cr$$module$str$c3runtime.equals_nocase(C.name,F))return C}return null};E.getAnimationBySid=function(F){var d;var k=0;for(d=this.type.animations.length;k<d;k++){var C=
this.type.animations[k];if(C.sid===F)return C}return null};E.doChangeAnim=function(){var F=this.cur_animation.frames[this.cur_frame],d=this.getAnimationByName(this.changeAnimName);this.changeAnimName="";!d||cr$$module$str$c3runtime.equals_nocase(d.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=d,this.animForwards=0<=d.speed,this.cur_anim_speed=Math.abs(d.speed),this.cur_anim_repeatto=d.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&
(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.OnFrameChanged(F,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0)};E.doChangeAnimFrame=function(){var F=this.cur_animation.frames[this.cur_frame],d=this.cur_frame;this.cur_frame=cr$$module$str$c3runtime.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=
this.cur_animation.frames.length-1);d!==this.cur_frame&&(this.OnFrameChanged(F,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};E.OnFrameChanged=function(F,d){var k=F.width,C=F.height,e=d.width,u=d.height;k!=e&&(this.width*=e/k);C!=u&&(this.height*=u/C);this.hotspotX=d.hotspotX;this.hotspotY=d.hotspotY;this.collision_poly.set_pts(d.poly_pts);this.set_bbox_changed();this.curFrame=d;this.curWebGLTexture=d.webGL_texture;k=0;
for(C=this.behavior_insts.length;k<C;k++)if(e=this.behavior_insts[k],e.onSpriteFrameChanged)e.onSpriteFrameChanged(F,d);this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};E.draw=function(F){F.globalAlpha=this.opacity;var d=this.curFrame,k=d.spritesheeted,C=d.texture_img,e=this.x,u=this.y,G=this.width,I=this.height;if(0===this.angle&&0<=G&&0<=I)e-=this.hotspotX*G,u-=this.hotspotY*I,this.runtime.pixel_rounding&&(e=Math.round(e),u=Math.round(u)),k?F.drawImage(C,
d.offx,d.offy,d.width,d.height,e,u,G,I):F.drawImage(C,e,u,G,I);else{this.runtime.pixel_rounding&&(e=Math.round(e),u=Math.round(u));F.save();var R=0<G?1:-1,S=0<I?1:-1;F.translate(e,u);1===R&&1===S||F.scale(R,S);F.rotate(this.angle*R*S);e=-(this.hotspotX*cr$$module$str$c3runtime.abs(G));u=-(this.hotspotY*cr$$module$str$c3runtime.abs(I));k?F.drawImage(C,d.offx,d.offy,d.width,d.height,e,u,cr$$module$str$c3runtime.abs(G),cr$$module$str$c3runtime.abs(I)):F.drawImage(C,e,u,cr$$module$str$c3runtime.abs(G),
cr$$module$str$c3runtime.abs(I));F.restore()}};E.drawGL_earlyZPass=function(F){this.drawGL(F)};E.drawGL=function(F){F.setTexture(this.curWebGLTexture);F.setOpacity(this.opacity);var d=this.curFrame,k=this.bquad;if(this.runtime.pixel_rounding){var C=Math.round(this.x)-this.x,e=Math.round(this.y)-this.y;d.spritesheeted?F.quadTex(k.tlx+C,k.tly+e,k.trx+C,k.try_+e,k.brx+C,k.bry+e,k.blx+C,k.bly+e,d.sheetTex):F.quad(k.tlx+C,k.tly+e,k.trx+C,k.try_+e,k.brx+C,k.bry+e,k.blx+C,k.bly+e)}else d.spritesheeted?F.quadTex(k.tlx,
k.tly,k.trx,k.try_,k.brx,k.bry,k.blx,k.bly,d.sheetTex):F.quad(k.tlx,k.tly,k.trx,k.try_,k.brx,k.bry,k.blx,k.bly)};E.getImagePointIndexByName=function(F){var d=this.curFrame,k;var C=0;for(k=d.image_points.length;C<k;C++)if(cr$$module$str$c3runtime.equals_nocase(F,d.image_points[C][0]))return C;return-1};E.getImagePoint=function(F,d){var k=this.curFrame,C=k.image_points;var e=cr$$module$str$c3runtime.is_string(F)?this.getImagePointIndexByName(F):F-1;e=cr$$module$str$c3runtime.floor(e);if(0>e||e>=C.length)return d?
this.x:this.y;F=(C[e][1]-k.hotspotX)*this.width;C=C[e][2];C=(C-k.hotspotY)*this.height;k=Math.cos(this.angle);e=Math.sin(this.angle);var u=F*k-C*e;C=C*k+F*e;F=u+this.x;C+=this.y;return d?F:C};var z=[],H=-2,B=[];l.prototype.OnCollision=function(F){if(!F)return!1;var d=this.runtime,k=d.getCurrentCondition(),C=k.type,e=null;k.extra.collmemory?e=k.extra.collmemory:(e={},k.extra.collmemory=e);k.extra.spriteCreatedDestroyCallback||(k.extra.spriteCreatedDestroyCallback=!0,d.addDestroyCallback(function(D){var w=
k.extra.collmemory;D=D.uid;var J;for(J in w)if(w.hasOwnProperty(J)){var M=w[J];if(M[0]===D||M[1]===D)v(w[J]),delete w[J]}}));var u=C.getCurrentSol(),G=F.getCurrentSol();u=u.getObjects();var I,R,S=this.runtime.tickcount,V=S-1,T=d.getCurrentEventStack().current_event;for(I=0;I<u.length;I++){var Z=u[I];if(G.select_all){Z.update_bbox();this.runtime.getCollisionCandidates(Z.layer,F,Z.bbox,B);var aa=B;this.runtime.addRegisteredCollisionCandidates(Z,F,aa)}else aa=G.getObjects();for(R=0;R<aa.length;R++){var f=
aa[R];if(d.testOverlap(Z,f)||d.checkRegisteredCollision(Z,f)){var q=n(e,Z,f);q=!q||H<V;L(e,Z,f,S);if(q){d.pushCopySol(T.solModifiers);q=C.getCurrentSol();var y=F.getCurrentSol();q.select_all=!1;y.select_all=!1;C===F?(q.instances.length=2,q.instances[0]=Z,q.instances[1]=f,C.applySolToContainer()):(q.instances.length=1,y.instances.length=1,q.instances[0]=Z,y.instances[0]=f,C.applySolToContainer(),F.applySolToContainer());T.retrigger();d.popSol(T.solModifiers)}}else K(e,Z,f)}cr$$module$str$c3runtime.clearArray(B)}return!1};
var g=null,r=new cr$$module$str$c3runtime.ObjectSet,x=!1,N=[],Q=new cr$$module$str$c3runtime.rect(0,0,0,0);m.finish=function(F){if(x){if(F){var d=this.runtime.getCurrentEventStack().current_event.orblock;F=g.getCurrentSol();var k=r.valuesRef(),C;if(F.select_all){F.select_all=!1;cr$$module$str$c3runtime.clearArray(F.instances);var e=0;for(C=k.length;e<C;++e)F.instances[e]=k[e];if(d)for(cr$$module$str$c3runtime.clearArray(F.else_instances),e=0,C=g.instances.length;e<C;++e)k=g.instances[e],r.contains(k)||
F.else_instances.push(k)}else if(d)for(d=F.instances.length,e=0,C=k.length;e<C;++e)F.instances[d+e]=k[e],cr$$module$str$c3runtime.arrayFindRemove(F.else_instances,k[e]);else cr$$module$str$c3runtime.shallowAssignArray(F.instances,k);g.applySolToContainer()}r.clear();x=!1}};l.prototype.IsOverlapping=function(F){return a.call(this,F,0,0)};l.prototype.IsOverlappingOffset=function(F,d,k){return a.call(this,F,d,k)};l.prototype.IsAnimPlaying=function(F){return this.changeAnimName.length?cr$$module$str$c3runtime.equals_nocase(this.changeAnimName,
F):cr$$module$str$c3runtime.equals_nocase(this.cur_animation.name,F)};l.prototype.CompareFrame=function(F,d){return cr$$module$str$c3runtime.do_cmp(this.cur_frame,F,d)};l.prototype.CompareAnimSpeed=function(F,d){return cr$$module$str$c3runtime.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,F,d)};l.prototype.OnAnimFinished=function(F){return cr$$module$str$c3runtime.equals_nocase(this.animTriggerName,F)};l.prototype.OnAnyAnimFinished=function(){return!0};l.prototype.OnFrameChanged=
function(){return!0};l.prototype.IsMirrored=function(){return 0>this.width};l.prototype.IsFlipped=function(){return 0>this.height};l.prototype.OnURLLoaded=function(){return!0};l.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled};p.cnds=new l;c.prototype.Spawn=function(F,d,k){if(F&&d&&(d=this.runtime.createInstance(F,d,this.getImagePoint(k,!0),this.getImagePoint(k,!1)))){"undefined"!==typeof d.angle&&(d.angle=this.angle,d.set_bbox_changed());this.runtime.isInOnDestroy++;var C;this.runtime.trigger(Object.getPrototypeOf(F.plugin).cnds.OnCreated,
d);if(d.is_contained){var e=0;for(C=d.siblings.length;e<C;e++){var u=d.siblings[e];this.runtime.trigger(Object.getPrototypeOf(u.type.plugin).cnds.OnCreated,u)}}this.runtime.isInOnDestroy--;e=this.runtime.getCurrentAction();k=!1;if(cr$$module$str$c3runtime.is_undefined(e.extra.Spawn_LastExec)||e.extra.Spawn_LastExec<this.runtime.execcount)k=!0,e.extra.Spawn_LastExec=this.runtime.execcount;if(F!=this.type&&(F=F.getCurrentSol(),F.select_all=!1,k?(cr$$module$str$c3runtime.clearArray(F.instances),F.instances[0]=
d):F.instances.push(d),d.is_contained))for(e=0,C=d.siblings.length;e<C;e++)u=d.siblings[e],F=u.type.getCurrentSol(),F.select_all=!1,k?(cr$$module$str$c3runtime.clearArray(F.instances),F.instances[0]=u):F.instances.push(u)}};c.prototype.SetEffect=function(F){this.blend_mode=F;this.compositeOp=cr$$module$str$c3runtime.effectToCompositeOp(F);cr$$module$str$c3runtime.setGLBlend(this,F,this.runtime.gl);this.runtime.redraw=!0};c.prototype.StopAnim=function(){this.animPlaying=!1};c.prototype.StartAnim=function(F){this.animPlaying=
!0;this.frameStart=this.getNowTime();1===F&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};c.prototype.SetAnim=function(F,d){this.changeAnimName=F;this.changeAnimFrom=d;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};c.prototype.SetAnimFrame=function(F){this.changeAnimFrame=F;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||
this.doChangeAnimFrame()};c.prototype.SetAnimSpeed=function(F){this.cur_anim_speed=cr$$module$str$c3runtime.abs(F);this.animForwards=0<=F;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};c.prototype.SetAnimRepeatToFrame=function(F){F=Math.floor(F);0>F&&(F=0);F>=this.cur_animation.frames.length&&(F=this.cur_animation.frames.length-1);this.cur_anim_repeatto=F};c.prototype.SetMirrored=function(F){F=cr$$module$str$c3runtime.abs(this.width)*(0===F?-1:1);this.width!==F&&(this.width=F,this.set_bbox_changed())};
c.prototype.SetFlipped=function(F){F=cr$$module$str$c3runtime.abs(this.height)*(0===F?-1:1);this.height!==F&&(this.height=F,this.set_bbox_changed())};c.prototype.SetScale=function(F){var d=this.curFrame,k=d.width*F*(0>this.width?-1:1);F=d.height*F*(0>this.height?-1:1);if(this.width!==k||this.height!==F)this.width=k,this.height=F,this.set_bbox_changed()};c.prototype.LoadURL=function(F,d,k){var C=new Image,e=this,u=this.curFrame;C.onload=function(){u.texture_img.src===C.src?e.runtime.glwrap&&e.curFrame===
u&&(e.curWebGLTexture=u.webGL_texture):(u.texture_img=C,u.offx=0,u.offy=0,u.width=C.width,u.height=C.height,u.spritesheeted=!1,u.datauri="",u.pixelformat=0,e.runtime.glwrap&&(u.webGL_texture&&e.runtime.glwrap.deleteTexture(u.webGL_texture),u.webGL_texture=e.runtime.glwrap.loadTexture(C,!1,e.runtime.linearSampling),e.curFrame===u&&(e.curWebGLTexture=u.webGL_texture),e.type.updateAllCurrentTexture()));0===d&&(e.width=C.width,e.height=C.height,e.set_bbox_changed());e.runtime.redraw=!0;e.runtime.trigger(cr$$module$str$c3runtime.plugins_.Sprite.prototype.cnds.OnURLLoaded,
e)};"data:"!==F.substr(0,5)&&0===k&&(C.crossOrigin="anonymous");this.runtime.setImageSrc(C,F)};c.prototype.SetCollisions=function(F){this.collisionsEnabled!==(0!==F)&&((this.collisionsEnabled=0!==F)?this.set_bbox_changed():(this.collcells.right>=this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};p.acts=new c;h.prototype.AnimationFrame=function(F){F.set_int(this.cur_frame)};h.prototype.AnimationFrameCount=function(F){F.set_int(this.cur_animation.frames.length)};
h.prototype.AnimationName=function(F){F.set_string(this.cur_animation.name)};h.prototype.AnimationSpeed=function(F){F.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};h.prototype.ImagePointX=function(F,d){F.set_float(this.getImagePoint(d,!0))};h.prototype.ImagePointY=function(F,d){F.set_float(this.getImagePoint(d,!1))};h.prototype.ImagePointCount=function(F){F.set_int(this.curFrame.image_points.length)};h.prototype.ImageWidth=function(F){F.set_float(this.curFrame.width)};h.prototype.ImageHeight=
function(F){F.set_float(this.curFrame.height)};p.exps=new h})();cr$$module$str$c3runtime.plugins_.TextBox=function(b){this.runtime=b};
(function(){function b(){}function l(){}function v(){}var A=cr$$module$str$c3runtime.plugins_.TextBox.prototype;A.Type=function(n){this.plugin=n;this.runtime=n.runtime};A.Type.prototype.onCreate=function(){};A.Instance=function(n){this.type=n;this.runtime=n.runtime};var L=A.Instance.prototype,K="text password email number tel url textarea search".split(" ");-1<navigator.userAgent.indexOf("MSIE 9")&&(K[2]="text",K[3]="text",K[4]="text",K[5]="text",K[7]="text");L.onCreate=function(){6===this.properties[7]?
(this.elem=document.createElement("textarea"),this.elem.style.resize="none"):(this.elem=document.createElement("input"),this.elem.type=K[this.properties[7]]);this.elem.id=this.properties[9];document.body.appendChild(this.elem);this.elem.autocomplete="off";this.elem.value=this.properties[0];this.elem.placeholder=this.properties[1];this.elem.title=this.properties[2];this.elem.disabled=!this.properties[4];this.elem.readOnly=this.properties[5];this.elem.spellcheck=this.properties[6];this.autoFontSize=
this.properties[8];this.element_hidden=!1;this.properties[3]||(this.elem.style.display="none",this.visible=!1,this.element_hidden=!0);var n=function(a){return function(){a.runtime.trigger(cr$$module$str$c3runtime.plugins_.TextBox.prototype.cnds.OnTextChanged,a)}}(this);this.elem.oninput=n;-1!==navigator.userAgent.indexOf("MSIE")&&(this.elem.oncut=n);this.elem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr$$module$str$c3runtime.plugins_.TextBox.prototype.cnds.OnClicked,
a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.ondblclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr$$module$str$c3runtime.plugins_.TextBox.prototype.cnds.OnDoubleClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchend",function(a){a.stopPropagation()},
!1);this.elem.addEventListener("mousedown",function(a){a.stopPropagation()});this.elem.addEventListener("mouseup",function(a){a.stopPropagation()});this.elem.addEventListener("keydown",function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.elem.addEventListener("keyup",function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)};L.saveToJSON=
function(){return{text:this.elem.value,placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,spellcheck:!!this.elem.spellcheck}};L.loadFromJSON=function(n){this.elem.value=n.text;this.elem.placeholder=n.placeholder;this.elem.title=n.tooltip;this.elem.disabled=n.disabled;this.elem.readOnly=n.readonly;this.elem.spellcheck=n.spellcheck};L.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);this.elem=null};L.tick=function(){this.updatePosition()};
L.updatePosition=function(n){var a=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),h=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),p=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),m=this.runtime.width/this.runtime.devicePixelRatio,t=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=h||0>=p||a>=m||c>=t?(this.element_hidden||(this.elem.style.display="none"),this.element_hidden=!0):(1>
a&&(a=1),1>c&&(c=1),h>=m&&(h=m-1),p>=t&&(p=t-1),m=window.innerWidth,t=window.innerHeight,n||this.lastLeft!==a||this.lastTop!==c||this.lastRight!==h||this.lastBottom!==p||this.lastWinWidth!==m||this.lastWinHeight!==t?(this.lastLeft=a,this.lastTop=c,this.lastRight=h,this.lastBottom=p,this.lastWinWidth=m,this.lastWinHeight=t,this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1),n=Math.round(a)+this.runtime.canvas.offsetLeft,m=Math.round(c)+this.runtime.canvas.offsetTop,this.elem.style.position=
"absolute",this.elem.style.left=n+"px",this.elem.style.top=m+"px",this.elem.style.width=Math.round(h-a)+"px",this.elem.style.height=Math.round(p-c)+"px",this.autoFontSize&&(this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1))};L.draw=function(n){};L.drawGL=function(n){};b.prototype.CompareText=function(n,a){return 0===a?cr$$module$str$c3runtime.equals_nocase(this.elem.value,n):this.elem.value===
n};b.prototype.OnTextChanged=function(){return!0};b.prototype.OnClicked=function(){return!0};b.prototype.OnDoubleClicked=function(){return!0};A.cnds=new b;l.prototype.SetText=function(n){this.elem.value=n.toString()};l.prototype.SetPlaceholder=function(n){this.elem.placeholder=n};l.prototype.SetTooltip=function(n){this.elem.title=n};l.prototype.SetReadOnly=function(n){this.elem.readOnly=0===n};l.prototype.ScrollToBottom=function(){this.elem.scrollTop=this.elem.scrollHeight};A.acts=new l;v.prototype.Text=
function(n){n.set_string(this.elem.value)};A.exps=new v})();cr$$module$str$c3runtime.plugins_.Browser=function(b){this.runtime=b};
(function(){function b(){c&&h&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(B){p.onSWMessage(B)})}function l(){if(!t&&navigator.getBattery){var B=navigator.getBattery();t=!0;B&&B.then(function(g){m=g})}}function v(){}function A(){}function L(B){console&&console.warn&&console.warn("Fullscreen request failed: ",B);z.setSize(window.innerWidth,window.innerHeight)}function K(){}var n=cr$$module$str$c3runtime.plugins_.Browser.prototype;n.Type=function(B){this.plugin=B;
this.runtime=B.runtime};var a=n.Type.prototype;a.onCreate=function(){};var c=!1,h=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C3_RegisterSW&&navigator.serviceWorker){var B=document.createElement("script");B.onload=function(){c=!0;b()};B.src="offlineclient.js";document.head.appendChild(B)}});var p=null;a.onAppBegin=function(){h=!0;b()};n.Instance=function(B){this.type=B;this.runtime=B.runtime};a=n.Instance.prototype;a.onCreate=function(){var B=this;window.addEventListener("resize",
function(){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnResize,B)});p=this;"undefined"!==typeof navigator.onLine&&(window.addEventListener("online",function(){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnOnline,B)}),window.addEventListener("offline",function(){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnOffline,B)}));document.addEventListener("backbutton",function(){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnBackButton,
B)});document.addEventListener("menubutton",function(){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnMenuButton,B)});document.addEventListener("searchbutton",function(){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnSearchButton,B)});document.addEventListener("tizenhwkey",function(g){switch(g.keyName){case "back":var r=B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnBackButton,B);!r&&window.tizen&&window.tizen.application.getCurrentApplication().exit();
break;case "menu":(r=B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnMenuButton,B))||g.preventDefault()}});this.runtime.isWindows10&&"undefined"!==typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(g){B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnBackButton,B)&&(g.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(g){return!!B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnBackButton,
B)});this.runtime.addSuspendCallback(function(g){g?B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnPageHidden,B):B.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnPageVisible,B)});this.is_arcade="undefined"!==typeof window.is_scirra_arcade};a.onSWMessage=function(B){B=B.data.type;"downloading-update"===B?this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===B||"update-pending"===B?
this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnUpdateReady,this):"offline-ready"===B&&this.runtime.trigger(cr$$module$str$c3runtime.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var m=null,t=!1;v.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:!1};v.prototype.IsOnline=function(){return navigator?navigator.onLine:!1};v.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1};v.prototype.OnOnline=function(){return!0};
v.prototype.OnOffline=function(){return!0};v.prototype.IsDownloadingUpdate=function(){return!1};v.prototype.PageVisible=function(){return!this.runtime.isSuspended};v.prototype.OnPageVisible=function(){return!0};v.prototype.OnPageHidden=function(){return!0};v.prototype.OnResize=function(){return!0};v.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen)};v.prototype.OnBackButton=function(){return!0};v.prototype.OnMenuButton=function(){return!0};
v.prototype.OnSearchButton=function(){return!0};v.prototype.IsMetered=function(){var B=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return B?!!B.metered:!1};v.prototype.IsCharging=function(){var B=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(B)return!!B.charging;l();return m?!!m.charging:!0};v.prototype.IsPortraitLandscape=function(B){return(window.innerWidth<=window.innerHeight?0:1)===B};v.prototype.SupportsFullscreen=function(){if(this.runtime.isNWjs)return!0;
var B=this.runtime.canvas;return!!(B.requestFullscreen||B.mozRequestFullScreen||B.msRequestFullscreen||B.webkitRequestFullScreen)};v.prototype.OnUpdateFound=function(){return!0};v.prototype.OnUpdateReady=function(){return!0};v.prototype.OnOfflineReady=function(){return!0};n.cnds=new v;A.prototype.Alert=function(B){alert(B.toString())};A.prototype.Close=function(){window.tizen?window.tizen.application.getCurrentApplication().exit():navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&
navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||window.close()};A.prototype.Focus=function(){this.runtime.isNWjs?nw.Window.get().focus():this.is_arcade||window.focus()};A.prototype.Blur=function(){this.runtime.isNWjs?nw.Window.get().blur():this.is_arcade||window.blur()};A.prototype.GoBack=function(){navigator.app&&navigator.app.backHistory?navigator.app.backHistory():!this.is_arcade&&window.back&&window.back()};A.prototype.GoForward=function(){!this.is_arcade&&window.forward&&
window.forward()};A.prototype.GoHome=function(){!this.is_arcade&&window.home&&window.home()};A.prototype.GoToURL=function(B,g){this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(B)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(B,{openExternal:!0}):this.runtime.isCordova?window.open(B,"_system"):this.runtime.isPreview?window.open(B,"_blank"):this.is_arcade||(2!==g||this.is_arcade?1!==g||this.is_arcade?window.location=B:window.parent.location=B:window.top.location=
B)};A.prototype.GoToURLWindow=function(B,g){this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(B)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(B,{openExternal:!0}):this.runtime.isCordova?window.open(B,"_system"):this.is_arcade||window.open(B,g)};A.prototype.Reload=function(){this.is_arcade||window.location.reload()};var E=!0,z=null;A.prototype.RequestFullScreen=function(B,g){2<=B&&(B+=1);6===B&&(B=2);document.mozFullScreen||document.webkitIsFullScreen||
document.msFullscreenElement||document.fullScreen||document.fullScreenElement||(this.runtime.fullscreen_scaling=2<=B?B:0,B={navigationUI:"auto"},1===g?B.navigationUI="hide":2===g&&(B.navigationUI="show"),g=document.documentElement,E&&(E=!1,z=this.runtime,g.addEventListener("mozfullscreenerror",L),g.addEventListener("webkitfullscreenerror",L),g.addEventListener("MSFullscreenError",L),g.addEventListener("fullscreenerror",L)),g.requestFullscreen?g.requestFullscreen(B):g.mozRequestFullScreen?g.mozRequestFullScreen(B):
g.msRequestFullscreen?g.msRequestFullscreen(B):g.webkitRequestFullScreen&&("undefined"!==typeof Element&&"undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?g.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):g.webkitRequestFullScreen()))};A.prototype.CancelFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()};
A.prototype.Vibrate=function(B){try{var g=B.split(","),r;var x=0;for(r=g.length;x<r;x++)g[x]=parseInt(g[x],10);navigator.vibrate?navigator.vibrate(g):navigator.mozVibrate?navigator.mozVibrate(g):navigator.webkitVibrate?navigator.webkitVibrate(g):navigator.msVibrate&&navigator.msVibrate(g)}catch(N){}};A.prototype.InvokeDownload=function(B,g){if(g){var r=document.createElement("a");if("undefined"===typeof r.download)window.open(B);else{var x=document.getElementsByTagName("body")[0];r.textContent=g;
r.href=B;r.download=g;x.appendChild(r);B=new MouseEvent("click");r.dispatchEvent(B);x.removeChild(r)}}};A.prototype.InvokeDownloadString=function(B,g,r){if(r){var x="data:"+g+","+encodeURIComponent(B);B=document.createElement("a");"undefined"===typeof B.download?window.open(x):(g=document.getElementsByTagName("body")[0],B.textContent=r,B.href=x,B.download=r,g.appendChild(B),r=new MouseEvent("click"),B.dispatchEvent(r),g.removeChild(B))}};A.prototype.ConsoleLog=function(B,g){"undefined"!==typeof console&&
(0===B&&console.log&&console.log(g.toString()),1===B&&console.warn&&console.warn(g.toString()),2===B&&console.error&&console.error(g.toString()))};A.prototype.ConsoleGroup=function(B){console&&console.group&&console.group(B)};A.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()};A.prototype.ExecJs=function(B){try{eval&&eval(B)}catch(g){console&&console.error&&console.error("Error executing Javascript: ",g)}};var H="portrait landscape portrait-primary portrait-secondary landscape-primary landscape-secondary".split(" ");
A.prototype.LockOrientation=function(B){B=Math.floor(B);0>B||B>=H.length||(this.runtime.autoLockOrientation=!1,B=H[B],screen.orientation&&screen.orientation.lock?screen.orientation.lock(B):screen.lockOrientation?screen.lockOrientation(B):screen.webkitLockOrientation?screen.webkitLockOrientation(B):screen.mozLockOrientation?screen.mozLockOrientation(B):screen.msLockOrientation&&screen.msLockOrientation(B))};A.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1;screen.orientation&&
screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()};n.acts=new A;K.prototype.URL=function(B){B.set_string(window.location.toString())};K.prototype.Protocol=function(B){B.set_string(window.location.protocol)};K.prototype.Domain=function(B){B.set_string(window.location.hostname)};
K.prototype.PathName=function(B){B.set_string(window.location.pathname)};K.prototype.Hash=function(B){B.set_string(window.location.hash)};K.prototype.Referrer=function(B){B.set_string(document.referrer)};K.prototype.Title=function(B){B.set_string(document.title)};K.prototype.Name=function(B){B.set_string(navigator.appName)};K.prototype.Version=function(B){B.set_string(navigator.appVersion)};K.prototype.Language=function(B){navigator&&navigator.language?B.set_string(navigator.language):B.set_string("")};
K.prototype.Platform=function(B){B.set_string(navigator.platform)};K.prototype.Product=function(B){navigator&&navigator.product?B.set_string(navigator.product):B.set_string("")};K.prototype.Vendor=function(B){navigator&&navigator.vendor?B.set_string(navigator.vendor):B.set_string("")};K.prototype.UserAgent=function(B){B.set_string(navigator.userAgent)};K.prototype.QueryString=function(B){B.set_string(window.location.search)};K.prototype.QueryParam=function(B,g){(g=RegExp("[?&]"+g+"=([^&]*)").exec(window.location.search))?
B.set_string(decodeURIComponent(g[1].replace(/\+/g," "))):B.set_string("")};K.prototype.Bandwidth=function(B){var g=navigator.connection||navigator.mozConnection||navigator.webkitConnection;g?"undefined"!==typeof g.bandwidth?B.set_float(g.bandwidth):"undefined"!==typeof g.downlinkMax?B.set_float(g.downlinkMax):B.set_float(Number.POSITIVE_INFINITY):B.set_float(Number.POSITIVE_INFINITY)};K.prototype.ConnectionType=function(B){var g=navigator.connection||navigator.mozConnection||navigator.webkitConnection;
g?B.set_string(g.type||"unknown"):B.set_string("unknown")};K.prototype.BatteryLevel=function(B){var g=navigator.battery||navigator.mozBattery||navigator.webkitBattery;g?B.set_float(g.level):(l(),m?B.set_float(m.level):B.set_float(1))};K.prototype.BatteryTimeLeft=function(B){var g=navigator.battery||navigator.mozBattery||navigator.webkitBattery;g?B.set_float(g.dischargingTime):(l(),m?B.set_float(m.dischargingTime):B.set_float(Number.POSITIVE_INFINITY))};K.prototype.ExecJS=function(B,g){if(eval){var r=
0;try{r=eval(g)}catch(x){console&&console.error&&console.error("Error executing Javascript: ",x)}"number"===typeof r?B.set_any(r):"string"===typeof r?B.set_any(r):"boolean"===typeof r?B.set_any(r?1:0):B.set_any(0)}else B.set_any(0)};K.prototype.ScreenWidth=function(B){B.set_int(screen.width)};K.prototype.ScreenHeight=function(B){B.set_int(screen.height)};K.prototype.DevicePixelRatio=function(B){B.set_float(this.runtime.devicePixelRatio)};K.prototype.WindowInnerWidth=function(B){B.set_int(window.innerWidth)};
K.prototype.WindowInnerHeight=function(B){B.set_int(window.innerHeight)};K.prototype.WindowOuterWidth=function(B){B.set_int(window.outerWidth)};K.prototype.WindowOuterHeight=function(B){B.set_int(window.outerHeight)};n.exps=new K})();
cr$$module$str$c3runtime.getObjectRefTable=function(){return[cr$$module$str$c3runtime.plugins_.Text,cr$$module$str$c3runtime.plugins_.AJAX,cr$$module$str$c3runtime.plugins_.Arr,cr$$module$str$c3runtime.plugins_.Function,cr$$module$str$c3runtime.plugins_.Touch,cr$$module$str$c3runtime.plugins_.WebStorage,cr$$module$str$c3runtime.plugins_.TiledBg,cr$$module$str$c3runtime.plugins_.Sprite,cr$$module$str$c3runtime.plugins_.TextBox,cr$$module$str$c3runtime.plugins_.Browser,cr$$module$str$c3runtime.system_object.prototype.cnds.OnLayoutStart,
cr$$module$str$c3runtime.system_object.prototype.acts.ResetGlobals,cr$$module$str$c3runtime.plugins_.AJAX.prototype.acts.Request,cr$$module$str$c3runtime.plugins_.Text.prototype.acts.SetText,cr$$module$str$c3runtime.plugins_.Function.prototype.acts.CallFunction,cr$$module$str$c3runtime.plugins_.AJAX.prototype.cnds.OnComplete,cr$$module$str$c3runtime.plugins_.Function.prototype.cnds.OnFunction,cr$$module$str$c3runtime.system_object.prototype.acts.AddVar,cr$$module$str$c3runtime.system_object.prototype.cnds.CompareVar,
cr$$module$str$c3runtime.system_object.prototype.exps.trim,cr$$module$str$c3runtime.system_object.prototype.exps.tokenat,cr$$module$str$c3runtime.plugins_.Arr.prototype.exps.At,cr$$module$str$c3runtime.system_object.prototype.acts.SetVar,cr$$module$str$c3runtime.system_object.prototype.cnds.Else,cr$$module$str$c3runtime.system_object.prototype.cnds.For,cr$$module$str$c3runtime.plugins_.Arr.prototype.acts.SetX,cr$$module$str$c3runtime.plugins_.AJAX.prototype.exps.LastData,cr$$module$str$c3runtime.plugins_.Touch.prototype.cnds.OnTouchObject,
cr$$module$str$c3runtime.plugins_.Text.prototype.exps.Text,cr$$module$str$c3runtime.plugins_.Function.prototype.exps.Param,cr$$module$str$c3runtime.plugins_.Text.prototype.acts.SetVisible,cr$$module$str$c3runtime.system_object.prototype.acts.Wait,cr$$module$str$c3runtime.system_object.prototype.cnds.Every,cr$$module$str$c3runtime.system_object.prototype.acts.SubVar,cr$$module$str$c3runtime.plugins_.WebStorage.prototype.exps.LocalValue,cr$$module$str$c3runtime.plugins_.WebStorage.prototype.acts.StoreLocal,
cr$$module$str$c3runtime.system_object.prototype.acts.GoToLayout,cr$$module$str$c3runtime.system_object.prototype.exps.random,cr$$module$str$c3runtime.system_object.prototype.cnds.While,cr$$module$str$c3runtime.system_object.prototype.cnds.Compare,cr$$module$str$c3runtime.plugins_.Arr.prototype.cnds.ArrForEach,cr$$module$str$c3runtime.plugins_.Arr.prototype.exps.CurX,cr$$module$str$c3runtime.plugins_.WebStorage.prototype.cnds.LocalStorageExists,cr$$module$str$c3runtime.system_object.prototype.exps.zeropad,
cr$$module$str$c3runtime.plugins_.TextBox.prototype.cnds.OnTextChanged,cr$$module$str$c3runtime.plugins_.TextBox.prototype.acts.SetEnabled,cr$$module$str$c3runtime.system_object.prototype.cnds.RegexTest,cr$$module$str$c3runtime.plugins_.TextBox.prototype.exps.Text,cr$$module$str$c3runtime.plugins_.Sprite.prototype.acts.SetVisible,cr$$module$str$c3runtime.plugins_.Sprite.prototype.acts.SetPos,cr$$module$str$c3runtime.system_object.prototype.exps.len,cr$$module$str$c3runtime.plugins_.TextBox.prototype.acts.SetText,
cr$$module$str$c3runtime.system_object.prototype.exps.left,cr$$module$str$c3runtime.system_object.prototype.exps.urlencode,cr$$module$str$c3runtime.system_object.prototype.exps.floor,cr$$module$str$c3runtime.system_object.prototype.exps.mid,cr$$module$str$c3runtime.system_object.prototype.exps.int,cr$$module$str$c3runtime.plugins_.AJAX.prototype.acts.Post,cr$$module$str$c3runtime.plugins_.Sprite.prototype.acts.Destroy]};
self.C3_JsPropNameTable=[{QuestionText:0},{AnswerChoice1:0},{AnswerChoice2:0},{AnswerChoice3:0},{AnswerChoice4:0},{AJAX:0},{QuestionsArray:0},{Function:0},{Touch:0},{FeedbackText:0},{ScoreText:0},{TitleText:0},{PlayButton:0},{WebStorage:0},{QuitButton:0},{RestartButton:0},{TimerText:0},{Used_Array:0},{TiledBackground:0},{HomeButton:0},{AboutText:0},{AboutButton:0},{Sprite11:0},{play_again:0},{Sprite18:0},{Sprite12:0},{NameInput:0},{EmailInput:0},{PhoneInput:0},{NameText:0},{EmailText:0},{Text2:0},
{Confirmation:0},{Display:0},{Discore:0},{final:0},{replay:0},{home:0},{Top_10:0},{submit_button:0},{order_id:0},{Logo:0},{terms:0},{Text3:0},{Browser:0},{Combo:0},{GuessGet:0},{Jersey_Quiz_D:0},{App_BG_M:0},{count:0},{Is_Answered:0},{Point:0},{random_number:0},{questions_asked:0},{current_answer:0},{questions_file_name:0},{point_bonus:0},{timer:0},{number_of_questions:0},{Game_Name:0},{SECONDSPERTICK:0},{s:0},{web_app_url:0},{stop:0},{value0:0},{value1:0},{value2:0},{sum:0},{string0:0},{string1:0},
{string2:0}];var module$str$c3runtime={};var module$str$__c3root__={};
